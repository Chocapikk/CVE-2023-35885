<?php
 namespace App\Database; use App\Database\Connection as DatabaseConnection; use App\Entity\DatabaseServer as DatabaseServerEntity; use App\Entity\DatabaseUser as DatabaseUserEntity; use App\Entity\Database as DatabaseEntity; use App\System\CommandExecutor; use App\System\Command\DeleteDirectoryCommand; class Manager { private DatabaseConnection $databaseConnection; private DatabaseServerEntity $databaseServerEntity; public function __construct(DatabaseServerEntity $databaseServerEntity) { $this->databaseServerEntity = $databaseServerEntity; $this->databaseConnection = new DatabaseConnection($databaseServerEntity); } public function createDatabase(DatabaseEntity $databaseEntity) : void { $this->databaseConnection->createDatabase($databaseEntity); } public function deleteDatabase(DatabaseEntity $databaseEntity, $withUsers = true) : void { goto E1bd3; fb079: c6d67: goto a5639; e30c0: foreach ($databaseUsers as $databaseUser) { $this->databaseConnection->deleteUser($databaseUser); Cd9b2: } goto A7562; E1bd3: $this->databaseConnection->deleteDatabase($databaseEntity); goto e7149; e7149: if (!(true === $withUsers)) { goto c6d67; } goto F2379; A7562: Cb2aa: goto fb079; a5639: $this->deleteDatabaseBackups($databaseEntity); goto Afd3e; F2379: $databaseUsers = $databaseEntity->getUsers(); goto e30c0; Afd3e: } public function createUser(DatabaseUserEntity $databaseUserEntity) : void { $this->databaseConnection->createUser($databaseUserEntity); } public function deleteUser(DatabaseUserEntity $databaseUserEntity) : void { $this->databaseConnection->deleteUser($databaseUserEntity); } private function deleteDatabaseBackups(DatabaseEntity $databaseEntity) { goto a4f3a; Bed54: $deleteDatabaseBackupDirectoryCommand = new DeleteDirectoryCommand(); goto b69d1; b69d1: $deleteDatabaseBackupDirectoryCommand->setDirectory($databaseBackupDirectory); goto F828e; F828e: $commandExecutor = new CommandExecutor(); goto Bc01d; cf5ec: $databaseBackupDirectory = sprintf("\57\x68\x6f\x6d\145\57\x25\163\57\142\141\143\x6b\165\x70\x73\57\x64\141\164\x61\142\141\163\x65\163\57\45\163\x2f", $siteUser, $databaseName); goto Bed54; a4f3a: $siteEntity = $databaseEntity->getSite(); goto F5ee5; D7d38: $databaseName = $databaseEntity->getName(); goto cf5ec; F5ee5: $siteUser = $siteEntity->getUser(); goto D7d38; Bc01d: $commandExecutor->execute($deleteDatabaseBackupDirectoryCommand); goto b3b21; b3b21: } }
