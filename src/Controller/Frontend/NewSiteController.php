<?php
 namespace App\Controller\Frontend; use Symfony\Component\HttpFoundation\Request; use Symfony\Component\HttpFoundation\Response; use Symfony\Component\Form\Form; use Symfony\Component\Form\Extension\Core\Type\SubmitType; use Symfony\Contracts\Translation\TranslatorInterface; use Symfony\Component\Validator\Validator\ValidatorInterface; use Symfony\Component\Validator\ConstraintViolationList; use App\Controller\Controller; use App\Event\EventQueue; use App\Service\Logger; use App\Entity\Site as SiteEntity; use App\Entity\Certificate as CertificateEntity; use App\Entity\NodejsSettings as NodejsSettingsEntity; use App\Entity\PhpSettings as PhpSettingsEntity; use App\Entity\PythonSettings as PythonSettingsEntity; use App\Entity\Database as DatabaseEntity; use App\Entity\DatabaseUser as DatabaseUserEntity; use App\Entity\DatabaseServer as DatabaseServerEntity; use App\Entity\User as UserEntity; use App\Entity\Manager\ConfigManager; use App\Entity\Manager\SiteManager as SiteEntityManager; use App\Entity\Manager\CertificateManager as CertificateEntityManager; use App\Entity\Manager\DatabaseManager as DatabaseEntityManager; use App\Entity\Manager\DatabaseUserManager as DatabaseUserEntityManager; use App\Entity\Manager\DatabaseServerManager as DatabaseServerEntityManager; use App\Entity\Manager\VhostTemplateManager as VhostTemplateEntityManager; use App\Database\Connection as DatabaseConnection; use App\Database\Manager as DatabaseManager; use App\Site\Nginx\Vhost\StaticTemplate as StaticVhostTemplate; use App\Site\Nginx\Vhost\PhpTemplate as PhpVhostTemplate; use App\Site\Nginx\Vhost\PythonTemplate as PythonVhostTemplate; use App\Site\Nginx\Vhost\ReverseProxyTemplate as ReverseProxyVhostTemplate; use App\Site\Nginx\Vhost\Processor\RedirectDomain as RedirectDomainProcessor; use App\Site\Nginx\Vhost\Processor\RedirectServerName as RedirectServerNameProcessor; use App\Site\Nginx\Vhost\Processor\ServerName as ServerNameProcessor; use App\Site\Parser\DomainName as DomainNameParser; use App\Site\Ssl\Generator\RsaKeyGenerator; use App\Site\Creator\NodejsSite as NodejsSiteCreator; use App\Site\Creator\StaticSite as StaticSiteCreator; use App\Site\Creator\PhpSite as PhpSiteCreator; use App\Site\Creator\PythonSite as PythonSiteCreator; use App\Site\Creator\ReverseProxySite as ReverseProxySiteCreator; use App\Site\Ssl\DistinguishedName; use App\Site\Ssl\Generator\CsrGenerator; use App\Site\Ssl\Util\Openssl; use App\Site\NodejsSite; use App\Site\StaticSite; use App\Site\PhpSite; use App\Site\PythonSite; use App\Site\ReverseProxySite; use App\Util\PasswordGenerator; use App\Site\Application\WordPressInstaller; use App\Service\Crypto; class NewSiteController extends Controller { private const WORDPRESS_VHOST_TEMPLATE_NAME = "\x57\157\162\x64\120\x72\145\163\x73"; private const NODEJS_VHOST_TEMPLATE_NAME = "\116\x6f\144\x65\x6a\163"; private const STATIC_SITE_VHOST_TEMPLATE_NAME = "\x53\x74\x61\164\151\143"; private const PYTHON_VHOST_TEMPLATE_NAME = "\120\171\x74\x68\157\x6e"; private const REVERSE_PROXY_VHOST_TEMPLATE_NAME = "\x52\x65\x76\145\x72\x73\145\120\162\157\170\x79"; private const VARNISH_CACHE_SERVER = "\x31\62\x37\56\60\x2e\x30\56\x31\x3a\66\60\x38\61"; private const PASSWORD_LENGTH = 20; private ConfigManager $configManager; private SiteEntityManager $siteEntityManager; private CertificateEntityManager $certificateEntityManager; private DatabaseEntityManager $databaseEntityManager; private DatabaseUserEntityManager $databaseUserEntityManager; private DatabaseServerEntityManager $databaseServerEntityManager; private DomainNameParser $domainNameParser; private VhostTemplateEntityManager $vhostTemplateEntityManager; private ValidatorInterface $validator; private array $wordPressDefaultConfigValues = ["\106\x53\x5f\x4d\x45\124\110\x4f\x44" => ["\166\141\154\x75\145" => "\144\151\162\145\143\x74", "\x72\141\x77" => false], "\127\120\137\x44\x45\x42\x55\x47\x5f\x44\111\123\120\114\101\x59" => ["\166\x61\154\x75\x65" => "\146\141\154\163\145", "\x72\x61\167" => true], "\x57\120\x5f\115\105\x4d\117\x52\x59\137\x4c\x49\x4d\x49\x54" => ["\166\x61\154\165\145" => "\62\65\x36\115", "\162\141\x77" => false], "\x57\120\137\115\101\x58\x5f\x4d\105\x4d\117\x52\131\137\114\x49\115\111\124" => ["\166\141\154\x75\x65" => "\x35\61\x32\x4d", "\162\x61\x77" => false], "\x57\x50\137\x44\x45\x42\125\107\137\114\x4f\107" => ["\166\141\x6c\x75\x65" => "\x74\x72\165\x65", "\162\141\167" => true], "\103\117\x4e\x43\101\x54\105\x4e\x41\x54\105\x5f\123\x43\122\111\x50\x54\x53" => ["\x76\141\154\x75\x65" => "\146\141\x6c\163\145", "\x72\x61\167" => true], "\101\125\x54\117\x53\101\126\105\x5f\x49\x4e\x54\105\122\126\101\114" => ["\x76\141\154\x75\145" => 600, "\162\141\167" => true], "\x57\x50\137\x50\117\123\x54\x5f\x52\105\126\111\x53\111\117\x4e\123" => ["\166\141\154\x75\x65" => 5, "\162\141\167" => true], "\x45\115\120\124\x59\137\x54\x52\x41\x53\110\x5f\104\x41\131\x53" => ["\x76\141\154\165\x65" => 21, "\162\x61\x77" => true]]; private array $wordPressMultiSiteConfigValues = ["\x57\120\x5f\x41\114\114\117\x57\137\x4d\x55\114\124\x49\x53\111\x54\x45" => ["\x76\x61\x6c\165\x65" => "\164\162\x75\145", "\x72\x61\167" => true], "\115\125\x4c\x54\x49\123\x49\124\105" => ["\x76\141\x6c\165\145" => "\x74\x72\x75\x65", "\162\141\x77" => true], "\x53\125\x42\x44\x4f\x4d\x41\x49\116\x5f\x49\116\x53\x54\101\114\114" => ["\x76\x61\x6c\165\145" => "\x66\141\154\163\x65", "\162\141\167" => true], "\x44\x4f\x4d\x41\111\x4e\x5f\x43\125\122\x52\x45\116\124\x5f\123\x49\124\x45" => ["\x76\141\154\165\x65" => '', "\x72\x61\x77" => false], "\x50\101\x54\110\137\x43\125\122\x52\105\x4e\124\x5f\123\x49\124\x45" => ["\x76\141\x6c\165\x65" => "\57", "\x72\x61\x77" => false], "\123\111\x54\105\x5f\111\x44\137\103\125\122\x52\x45\116\124\137\123\111\124\x45" => ["\166\141\154\165\x65" => 1, "\x72\141\x77" => true], "\x42\x4c\117\x47\137\x49\104\x5f\x43\125\x52\122\105\x4e\124\137\123\111\124\105" => ["\x76\141\x6c\x75\145" => 1, "\162\141\167" => true]]; public function __construct(ConfigManager $configManager, SiteEntityManager $siteEntityManager, CertificateEntityManager $certificateEntityManager, DatabaseEntityManager $databaseEntityManager, DatabaseUserEntityManager $databaseUserEntityManager, DatabaseServerEntityManager $databaseServerEntityManager, VhostTemplateEntityManager $vhostTemplateEntityManager, DomainNameParser $domainNameParser, ValidatorInterface $validator, TranslatorInterface $translator, Logger $logger) { goto B998b; cb921: $this->validator = $validator; goto ebeb4; Bf570: $this->domainNameParser = $domainNameParser; goto cb921; b1349: $this->databaseUserEntityManager = $databaseUserEntityManager; goto a76b8; b9122: $this->vhostTemplateEntityManager = $vhostTemplateEntityManager; goto Bf570; B508a: $this->certificateEntityManager = $certificateEntityManager; goto f6036; B998b: $this->configManager = $configManager; goto Acc94; Acc94: $this->siteEntityManager = $siteEntityManager; goto B508a; ebeb4: parent::__construct($translator, $logger); goto Fcebb; f6036: $this->databaseEntityManager = $databaseEntityManager; goto b1349; a76b8: $this->databaseServerEntityManager = $databaseServerEntityManager; goto b9122; Fcebb: } public function index(Request $request) : Response { goto D1124; cfd34: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\163\x69\x74\x65\x73")); goto C6089; C6089: goto fee1f; goto a9549; e8a20: $user = $this->getUser(); goto d2ef0; b1ef8: return $response; goto Da0f7; c8f87: if (true === $hasPermissions) { goto c0b9c; } goto cfd34; a9549: c0b9c: goto e8a20; e0d90: fee1f: goto b1ef8; d2ef0: $response = $this->render("\106\162\157\156\164\145\x6e\x64\57\123\151\x74\x65\57\x4e\145\x77\x2f\151\x6e\x64\145\x78\x2e\x68\164\x6d\x6c\x2e\x74\x77\x69\x67", ["\x75\163\x65\x72" => $user]); goto e0d90; D1124: $hasPermissions = $this->hasPermissions(); goto c8f87; Da0f7: } public function newPythonSite(Request $request) : Response { goto D467d; fc30c: if (!(true === $form->isSubmitted())) { goto D6f3a; } goto c2d54; c2d54: $response = $this->handleCreatePythonSiteForm($request, $form); goto ffd16; a0326: ed36f: goto c97d3; Daabf: c833b: goto Efd5a; bcab2: return $response; goto d6679; E9e8e: $response = $this->render("\106\162\x6f\156\164\x65\x6e\144\x2f\123\x69\x74\145\x2f\116\145\167\x2f\160\171\164\x68\x6f\156\56\x68\x74\x6d\x6c\x2e\x74\167\151\147", ["\x75\163\x65\162" => $user, "\x66\157\162\155" => $form->createView(), "\146\x6f\x72\x6d\105\x72\162\157\162\x73" => $this->formErrors]); goto a0326; fab94: $form = $this->createPythonSiteForm($pythonSettings); goto Bcc24; f4edb: if (true === $hasPermissions) { goto c833b; } goto ddb34; D467d: $hasPermissions = $this->hasPermissions(); goto f4edb; d6679: ed816: goto f2421; f2421: D6f3a: goto De9b6; bc752: $pythonSettings = new PythonSettingsEntity(); goto fab94; ddb34: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\163\x69\164\145\x73")); goto bbef1; c97d3: return $response; goto Dd4c2; Bcc24: if (!(true === $request->isMethod("\x50\x4f\x53\x54"))) { goto c084d; } goto F390d; F390d: $form->handleRequest($request); goto fc30c; bbef1: goto ed36f; goto Daabf; Efd5a: $user = $this->getUser(); goto bc752; ffd16: if (!(false === is_null($response))) { goto ed816; } goto bcab2; De9b6: c084d: goto E9e8e; Dd4c2: } private function createPythonSiteForm(PythonSettingsEntity $pythonSettings) : Form { goto acf43; acf43: $form = $this->createForm("\x41\160\x70\x5c\x46\157\x72\155\x5c\x53\x69\164\145\116\x65\167\x50\171\164\x68\157\156\x54\171\x70\x65", $pythonSettings, ["\141\143\164\x69\157\156" => $this->generateUrl("\143\154\160\137\x73\x69\164\145\x5f\160\x79\164\150\x6f\x6e\137\x6e\x65\x77"), "\x6d\145\x74\x68\157\x64" => "\x50\x4f\x53\x54", "\141\x74\164\162" => ["\x69\144" => "\156\145\x77\x2d\160\x79\164\x68\157\156\55\x73\151\x74\x65\55\146\x6f\x72\x6d"]]); goto E46ec; E46ec: $form->add("\x73\165\142\155\x69\x74", SubmitType::class, ["\141\x74\x74\x72" => ["\x63\154\141\163\163" => "\x62\164\156\x20\x62\164\x6e\55\154\147\40\142\164\156\55\142\154\x75\145"], "\x6c\141\142\x65\x6c" => "\103\x72\145\x61\164\145"]); goto aef21; aef21: return $form; goto A999c; A999c: } private function handleCreatePythonSiteForm(Request $request, Form $form) { goto ddba9; Cb1be: try { goto E48f5; E544b: goto C852d; goto Bc777; e4a00: if (false === is_null($vhostTemplateEntity)) { goto E7987; } goto A6a19; a4b11: $siteUserPassword = $form->get("\163\x69\x74\x65\x55\x73\145\x72\120\141\x73\x73\x77\x6f\162\144")->getData(); goto b0561; F9477: $this->createPythonSite($domainName, $pythonVersion, $port, $siteUser, $siteUserPassword); goto E9752; A1fef: $vhostTemplateEntity = $this->getVhostTemplateEntity($vhostTemplateName); goto e4a00; E48f5: $session = $request->getSession(); goto C014f; C014f: $domainName = $form->get("\144\157\x6d\141\x69\x6e\116\x61\155\x65")->getData(); goto C4410; E6d1f: $user = $this->getUser(); goto F9477; a9137: $response = $this->redirect($this->generateUrl("\x63\154\160\x5f\163\x69\164\145\163")); goto c9053; adb26: $port = $form->get("\x70\x6f\x72\164")->getData(); goto F3a6d; c9053: return $response; goto ad4b0; Bc777: E7987: goto E6d1f; a848c: $session->getFlashBag()->set("\x73\165\143\143\x65\163\163", $this->translator->trans("\x53\151\x74\x65\x20\x68\141\163\x20\142\145\145\156\x20\x63\162\x65\141\164\x65\144\56")); goto a9137; b0561: $vhostTemplateName = self::PYTHON_VHOST_TEMPLATE_NAME; goto A1fef; F304a: EventQueue::addEvent(EventQueue::EVENT_SITE_PYTHON_CREATE, $user, $eventData, $request); goto a848c; A6a19: throw new \Exception(sprintf("\x56\x68\157\x73\164\40\x74\145\155\160\154\x61\164\x65\x20\x22\45\x73\42\x20\156\157\164\40\146\x6f\x75\156\144\56", $vhostTemplateName)); goto E544b; F3a6d: $siteUser = $form->get("\163\x69\x74\x65\125\x73\x65\x72")->getData(); goto a4b11; E9752: $eventData = ["\x73\151\x74\145" => $domainName, "\163\151\164\x65\x55\163\145\x72" => $siteUser, "\160\x79\x74\x68\157\156\x56\145\162\x73\151\x6f\x6e" => $pythonVersion, "\160\x6f\x72\164" => $port]; goto F304a; ad4b0: C852d: goto E8f3a; C4410: $pythonVersion = $form->get("\x70\171\x74\x68\x6f\156\126\x65\162\163\x69\x6f\156")->getData(); goto adb26; E8f3a: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\147\x65\x72", $this->translator->trans("\x41\156\40\x65\162\162\x6f\x72\40\150\141\163\x20\157\x63\x63\x75\x72\x72\x65\144\54\x20\145\x72\x72\x6f\x72\x20\x6d\x65\163\163\x61\x67\145\72\40\x25\145\162\x72\x6f\x72\115\145\x73\x73\x61\x67\145\45", ["\x25\x65\162\162\157\x72\x4d\145\163\163\141\x67\x65\45" => $e->getMessage()])); } goto Baaf3; d4aec: $this->formErrors = $this->getErrorMessages($form); goto B9ea4; Baaf3: B6dfd: goto d179e; Dea87: Ec4c0: goto Cb1be; ddba9: if (true === $form->isValid()) { goto Ec4c0; } goto d4aec; B9ea4: goto B6dfd; goto Dea87; d179e: } public function newReverseProxy(Request $request) : Response { goto e870d; ce8be: $response = $this->render("\x46\162\x6f\156\x74\145\156\x64\57\x53\151\164\x65\x2f\x4e\145\167\57\162\x65\x76\145\x72\x73\x65\x2d\160\162\157\x78\171\x2e\150\x74\155\x6c\x2e\164\x77\151\147", ["\x75\x73\x65\x72" => $user, "\146\157\162\155" => $form->createView(), "\146\x6f\x72\155\105\x72\x72\157\x72\x73" => $this->formErrors]); goto dda95; dda95: e299d: goto F0055; C12c8: return $response; goto b2fab; fe3c6: a4a5c: goto Ad6fc; f771c: if (!(false === is_null($response))) { goto f74f1; } goto C12c8; cad12: if (!(true === $form->isSubmitted())) { goto F06bc; } goto c148d; F0055: return $response; goto B54a9; a32cd: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\151\164\145\x73")); goto Ebc16; cf8f0: $form = $this->createReverseProxyForm(); goto a1c49; F0846: F06bc: goto bb34b; bb34b: c3da4: goto ce8be; a1c49: if (!(true === $request->isMethod("\120\x4f\x53\124"))) { goto c3da4; } goto E38a3; Ebc16: goto e299d; goto fe3c6; E38a3: $form->handleRequest($request); goto cad12; f48e9: if (true === $hasPermissions) { goto a4a5c; } goto a32cd; b2fab: f74f1: goto F0846; c148d: $response = $this->handleReverseProxyForm($request, $form); goto f771c; e870d: $hasPermissions = $this->hasPermissions(); goto f48e9; Ad6fc: $user = $this->getUser(); goto cf8f0; B54a9: } private function createReverseProxyForm() : Form { goto d2a42; C0035: $form->add("\163\x75\x62\155\151\164", SubmitType::class, ["\141\x74\164\162" => ["\143\x6c\x61\163\x73" => "\x62\x74\x6e\x20\x62\164\x6e\x2d\x6c\x67\40\142\x74\156\x2d\x62\154\165\x65"], "\154\141\x62\x65\x6c" => "\103\x72\145\x61\164\145"]); goto F1687; d2a42: $form = $this->createForm("\101\x70\x70\x5c\106\x6f\162\155\134\x53\x69\x74\x65\x4e\x65\167\x52\x65\x76\x65\162\163\145\x50\162\157\x78\x79\124\171\x70\x65", [], ["\141\x63\x74\x69\x6f\156" => $this->generateUrl("\x63\x6c\x70\137\163\x69\164\x65\x5f\162\145\166\x65\x72\163\145\x5f\160\x72\x6f\x78\x79\x5f\156\145\x77"), "\x6d\x65\x74\x68\157\x64" => "\120\x4f\123\124", "\141\x74\x74\162" => ["\151\x64" => "\156\145\x77\55\x72\145\166\145\162\x73\x65\x2d\x70\x72\157\x78\x79\55\x66\157\x72\155"]]); goto C0035; F1687: return $form; goto cd815; cd815: } private function handleReverseProxyForm(Request $request, Form $form) { goto D3436; ed97a: d620c: goto B10cf; a2048: try { goto D13c4; b4068: $vhostTemplateEntity = $this->getVhostTemplateEntity($vhostTemplateName); goto af268; e0a39: goto cf58c; goto C7e31; e01b3: $reverseProxyUrl = $form->get("\x72\145\166\x65\162\163\145\x50\162\x6f\x78\x79\x55\x72\154")->getData(); goto B93cf; Faf69: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\163\x69\164\145\163")); goto D31ca; Bb3cb: $siteUserPassword = $form->get("\x73\x69\164\x65\x55\x73\x65\x72\x50\x61\x73\x73\167\x6f\162\144")->getData(); goto e01b3; Ba693: $siteUser = $form->get("\163\x69\164\145\x55\x73\145\162")->getData(); goto Bb3cb; E1eff: $session->getFlashBag()->set("\x73\165\x63\x63\x65\163\163", $this->translator->trans("\122\145\x76\x65\x72\x73\x65\40\120\x72\157\x78\171\x20\150\141\x73\x20\x62\x65\x65\x6e\x20\143\x72\145\141\x74\x65\144\56")); goto Faf69; C36f9: throw new \Exception(sprintf("\126\150\157\163\x74\x20\x74\145\x6d\160\154\141\164\145\x20\x22\45\163\42\40\156\x6f\164\40\x66\157\x75\156\144\56", $vhostTemplateName)); goto e0a39; D81c2: $eventData = ["\x73\151\x74\x65" => $domainName, "\163\151\164\145\x55\x73\145\x72" => $siteUser, "\x72\145\x76\145\162\x73\x65\120\x72\157\170\171\125\162\x6c" => $reverseProxyUrl]; goto f6126; ef7b4: $domainName = $form->get("\144\157\155\x61\x69\156\x4e\x61\x6d\145")->getData(); goto Ba693; C7e31: Fd50f: goto b3140; Cad23: cf58c: goto Ef3b5; af268: if (false === is_null($vhostTemplateEntity)) { goto Fd50f; } goto C36f9; F9046: $this->createReverseProxySite($domainName, $reverseProxyUrl, $siteUser, $siteUserPassword); goto D81c2; D13c4: $session = $request->getSession(); goto ef7b4; D31ca: return $response; goto Cad23; f6126: EventQueue::addEvent(EventQueue::EVENT_SITE_REVERSE_PROXY_CREATE, $user, $eventData, $request); goto E1eff; b3140: $user = $this->getUser(); goto F9046; B93cf: $vhostTemplateName = self::REVERSE_PROXY_VHOST_TEMPLATE_NAME; goto b4068; Ef3b5: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\156\147\x65\x72", $this->translator->trans("\x41\x6e\40\145\x72\x72\x6f\162\40\x68\141\163\x20\x6f\x63\143\x75\162\162\x65\144\x2c\40\145\x72\162\157\162\x20\155\145\x73\163\x61\x67\x65\x3a\40\45\x65\162\x72\x6f\162\115\145\163\x73\x61\147\145\45", ["\45\x65\162\x72\157\162\x4d\x65\163\x73\141\x67\145\x25" => $e->getMessage()])); } goto ed97a; D3436: if (true === $form->isValid()) { goto aedce; } goto Cdf00; C122c: goto d620c; goto c5501; c5501: aedce: goto a2048; Cdf00: $this->formErrors = $this->getErrorMessages($form); goto C122c; B10cf: } public function newNodejsSite(Request $request) : Response { goto e2710; c2711: $form->handleRequest($request); goto D7280; Cfc6d: $response = $this->render("\106\x72\157\156\x74\145\x6e\x64\x2f\123\x69\x74\145\57\x4e\x65\167\57\x6e\x6f\144\145\152\x73\x2e\150\164\155\x6c\x2e\164\x77\151\147", ["\x75\x73\145\x72" => $user, "\x66\x6f\162\x6d" => $form->createView(), "\x66\157\162\x6d\105\x72\162\x6f\x72\x73" => $this->formErrors]); goto eea03; A17a2: if (!(false === is_null($response))) { goto c73aa; } goto db347; fbe76: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\x73\151\164\145\x73")); goto E2050; bc42a: d35b9: goto d8271; d8271: Aa08e: goto Cfc6d; f7e18: if (true === $hasPermissions) { goto F37dc; } goto fbe76; db347: return $response; goto C74f7; D7ffd: $response = $this->handleCreateNodejsSiteForm($request, $form); goto A17a2; e2710: $hasPermissions = $this->hasPermissions(); goto f7e18; C74f7: c73aa: goto bc42a; E2050: goto b2c44; goto D69b8; c5f3d: if (!(true === $request->isMethod("\120\x4f\x53\124"))) { goto Aa08e; } goto c2711; D69b8: F37dc: goto eb899; D3a48: $nodejsSettings = new NodejsSettingsEntity(); goto B7b4f; B7b4f: $form = $this->createNodejsSiteForm($nodejsSettings); goto c5f3d; eb899: $user = $this->getUser(); goto D3a48; eea03: b2c44: goto A577c; A577c: return $response; goto f17ab; D7280: if (!(true === $form->isSubmitted())) { goto d35b9; } goto D7ffd; f17ab: } private function createNodejsSiteForm(NodejsSettingsEntity $nodejsSettings) : Form { goto E1de7; E1de7: $form = $this->createForm("\101\x70\x70\x5c\106\157\x72\x6d\134\x53\x69\164\145\116\x65\167\116\x6f\x64\x65\x6a\x73\124\x79\x70\145", $nodejsSettings, ["\x61\143\x74\x69\157\x6e" => $this->generateUrl("\x63\154\x70\137\x73\x69\164\x65\x5f\156\157\x64\145\152\x73\137\x6e\x65\167"), "\x6d\145\164\150\x6f\x64" => "\x50\x4f\x53\124", "\x61\x74\x74\162" => ["\x69\144" => "\x6e\145\167\55\156\157\x64\x65\152\163\x2d\163\151\164\x65\x2d\x66\x6f\x72\x6d"]]); goto F5162; F5162: $form->add("\163\x75\142\155\151\164", SubmitType::class, ["\x61\164\x74\x72" => ["\143\154\141\x73\163" => "\142\x74\x6e\x20\142\164\156\x2d\154\x67\40\x62\164\x6e\55\142\154\165\x65"], "\x6c\141\142\x65\x6c" => "\x43\x72\x65\141\164\145"]); goto D06bb; D06bb: return $form; goto adfc2; adfc2: } private function handleCreateNodejsSiteForm(Request $request, Form $form) { goto Cb79e; Cb79e: if (true === $form->isValid()) { goto cd1a5; } goto Ef1ce; c7455: try { goto Ca4f3; b97f4: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\163\151\164\145\x73")); goto B0302; bd260: Bcc31: goto a3078; c3b3f: $user = $this->getUser(); goto c9c36; Ca4f3: $session = $request->getSession(); goto c5fe7; c858f: $vhostTemplateName = self::NODEJS_VHOST_TEMPLATE_NAME; goto a1af3; e93d7: $session->getFlashBag()->set("\163\x75\x63\x63\x65\x73\x73", $this->translator->trans("\123\x69\164\x65\40\150\141\x73\x20\x62\x65\x65\156\x20\x63\162\145\x61\164\145\144\x2e")); goto b97f4; Cf163: goto Bcc31; goto Debfa; dfa48: EventQueue::addEvent(EventQueue::EVENT_SITE_NODEJS_CREATE, $user, $eventData, $request); goto e93d7; F1014: $eventData = ["\x73\x69\x74\145" => $domainName, "\163\x69\x74\x65\125\x73\x65\x72" => $siteUser, "\x6e\x6f\144\145\x6a\x73\126\145\x72\x73\x69\157\x6e" => $nodejsVersion, "\160\157\x72\x74" => $port]; goto dfa48; c5fe7: $domainName = $form->get("\x64\157\155\141\x69\156\x4e\x61\x6d\145")->getData(); goto F44e1; Debfa: E041d: goto c3b3f; B490a: $port = $form->get("\x70\157\162\x74")->getData(); goto e472e; B0302: return $response; goto bd260; E588a: throw new \Exception(sprintf("\x56\150\157\163\164\40\164\145\155\160\154\x61\x74\x65\40\42\45\163\x22\x20\156\157\x74\x20\146\157\x75\x6e\144\56", $vhostTemplateName)); goto Cf163; e472e: $siteUser = $form->get("\163\x69\164\x65\x55\163\145\162")->getData(); goto d6d7b; c9c36: $this->createNodejsSite($domainName, $nodejsVersion, $port, $siteUser, $siteUserPassword); goto F1014; d6d7b: $siteUserPassword = $form->get("\163\x69\164\x65\125\x73\x65\162\120\141\x73\163\167\x6f\x72\x64")->getData(); goto c858f; a1af3: $vhostTemplateEntity = $this->getVhostTemplateEntity($vhostTemplateName); goto b6039; b6039: if (false === is_null($vhostTemplateEntity)) { goto E041d; } goto E588a; F44e1: $nodejsVersion = $form->get("\x6e\x6f\x64\x65\152\x73\x56\x65\x72\x73\x69\x6f\156")->getData(); goto B490a; a3078: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\x67\x65\x72", $this->translator->trans("\x41\156\x20\x65\162\162\x6f\162\x20\x68\x61\x73\x20\x6f\x63\143\165\162\x72\145\x64\x2c\40\145\162\x72\157\162\x20\x6d\145\x73\163\141\x67\x65\x3a\40\45\x65\x72\x72\x6f\162\115\x65\163\163\x61\147\x65\x25", ["\45\145\162\x72\x6f\x72\x4d\145\163\163\141\x67\x65\45" => $e->getMessage()])); } goto B0341; B0341: D9144: goto afa9f; f3c71: goto D9144; goto eabd1; eabd1: cd1a5: goto c7455; Ef1ce: $this->formErrors = $this->getErrorMessages($form); goto f3c71; afa9f: } public function newStaticSite(Request $request) : Response { goto b0154; d8901: $user = $this->getUser(); goto A34a2; a26ec: goto A3a12; goto Ce593; b0154: $hasPermissions = $this->hasPermissions(); goto Eeffa; Ddb62: if (!(true === $form->isSubmitted())) { goto b41b5; } goto Af93a; F4165: b41b5: goto E3886; a6677: A3a12: goto C8cf6; ff8f6: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\x73\151\164\x65\163")); goto a26ec; Caa8f: $response = $this->render("\106\162\x6f\156\164\x65\x6e\144\57\x53\151\164\145\x2f\116\x65\167\57\x73\164\x61\x74\x69\x63\56\150\164\x6d\x6c\x2e\164\167\151\147", ["\x75\x73\145\162" => $user, "\x66\157\162\x6d" => $form->createView(), "\x66\x6f\162\155\x45\x72\x72\x6f\162\x73" => $this->formErrors]); goto a6677; Eeffa: if (true === $hasPermissions) { goto cd71c; } goto ff8f6; D2781: $form->handleRequest($request); goto Ddb62; A34a2: $form = $this->createStaticSiteForm(); goto e7126; C8cf6: return $response; goto a5ebe; e7126: if (!(true === $request->isMethod("\120\x4f\123\x54"))) { goto Aed38; } goto D2781; d23d7: b2e19: goto F4165; Af93a: $response = $this->handleCreateStaticSiteForm($request, $form); goto A5d89; Ce593: cd71c: goto d8901; D7256: return $response; goto d23d7; A5d89: if (!(false === is_null($response))) { goto b2e19; } goto D7256; E3886: Aed38: goto Caa8f; a5ebe: } private function createStaticSiteForm() : Form { goto Cd4f1; f7577: $form->add("\x73\165\142\155\151\x74", SubmitType::class, ["\x61\164\164\x72" => ["\x63\x6c\x61\x73\163" => "\x62\164\x6e\40\142\x74\156\55\x6c\147\40\142\164\x6e\55\x62\154\x75\145"], "\154\x61\142\x65\154" => "\x43\x72\145\x61\x74\x65"]); goto Cc045; Cd4f1: $form = $this->createForm("\101\x70\160\134\x46\x6f\x72\x6d\134\123\x69\164\x65\116\145\167\x53\x74\141\x74\151\x63\124\x79\x70\145", [], ["\x61\x63\164\x69\157\156" => $this->generateUrl("\x63\154\x70\x5f\163\151\164\145\x5f\x73\x74\x61\x74\151\143\137\156\145\167"), "\155\x65\x74\150\157\x64" => "\120\117\123\124", "\141\164\x74\x72" => []]); goto f7577; Cc045: return $form; goto ac557; ac557: } private function handleCreateStaticSiteForm(Request $request, Form $form) { goto e1b5c; F244a: $this->formErrors = $this->getErrorMessages($form); goto E11e9; E11e9: goto c71e1; goto f78c4; e1b5c: if (true === $form->isValid()) { goto e27be; } goto F244a; C66f4: try { goto C1a5d; cd351: $session->getFlashBag()->set("\163\x75\143\143\145\163\x73", $this->translator->trans("\123\x69\164\x65\40\x68\141\163\x20\142\145\145\x6e\40\x63\162\x65\141\164\145\144\x2e")); goto e1729; e586d: $domainName = $form->get("\144\x6f\155\x61\x69\x6e\116\141\x6d\x65")->getData(); goto c9b83; e924f: $siteUserPassword = $form->get("\x73\x69\x74\145\x55\x73\145\162\x50\141\163\163\167\157\162\x64")->getData(); goto bc136; b77ac: $eventData = ["\x73\151\164\x65" => $domainName, "\x73\151\164\145\x55\163\145\162" => $siteUser]; goto e04ae; C1a5d: $session = $request->getSession(); goto e586d; A463a: $user = $this->getUser(); goto da073; c2728: throw new \Exception(sprintf("\x56\x68\157\163\x74\x20\164\145\155\x70\154\x61\x74\x65\x20\x22\45\x73\42\x20\x6e\157\164\x20\146\157\x75\x6e\144\x2e", $vhostTemplateName)); goto D9b18; bc136: $vhostTemplateName = self::STATIC_SITE_VHOST_TEMPLATE_NAME; goto df67b; da073: $this->createStaticSite($domainName, $siteUser, $siteUserPassword); goto b77ac; C037e: c8440: goto A463a; c9b83: $siteUser = $form->get("\163\151\164\145\125\163\145\x72")->getData(); goto e924f; df67b: $vhostTemplateEntity = $this->getVhostTemplateEntity($vhostTemplateName); goto B91ed; D9b18: goto b752f; goto C037e; d796b: b752f: goto D68fd; e1729: $response = $this->redirect($this->generateUrl("\143\154\160\137\x73\x69\x74\x65\163")); goto f5f15; B91ed: if (false === is_null($vhostTemplateEntity)) { goto c8440; } goto c2728; f5f15: return $response; goto d796b; e04ae: EventQueue::addEvent(EventQueue::EVENT_SITE_STATIC_CREATE, $user, $eventData, $request); goto cd351; D68fd: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\x6e\147\145\x72", $this->translator->trans("\x41\x6e\40\145\162\x72\157\162\40\x68\141\x73\40\x6f\x63\x63\165\x72\x72\145\144\x2c\x20\145\162\x72\157\162\40\x6d\145\x73\x73\141\x67\145\72\40\45\145\162\x72\157\162\115\145\x73\163\141\147\x65\45", ["\x25\x65\x72\x72\x6f\x72\115\x65\x73\x73\141\147\145\x25" => $e->getMessage()])); } goto c707c; f78c4: e27be: goto C66f4; c707c: c71e1: goto Bd141; Bd141: } public function newPhpSite(Request $request) : Response { goto B4f33; cc7cd: if (!(true === $request->isMethod("\120\x4f\123\124"))) { goto ae801; } goto Ca6be; a2699: if (!(false === is_null($response))) { goto C1458; } goto F1bca; B4f33: $hasPermissions = $this->hasPermissions(); goto bb5db; Ffafb: goto de739; goto F4274; Ca6be: $form->handleRequest($request); goto ecd13; bb5db: if (true === $hasPermissions) { goto C3a4a; } goto D8431; D8431: $response = $this->redirect($this->generateUrl("\x63\154\160\137\x73\x69\164\x65\163")); goto Ffafb; bd26f: $form = $this->createPhpSiteForm(); goto cc7cd; F1bca: return $response; goto a2308; e8303: E83b5: goto C3d61; E2d7f: $response = $this->render("\106\x72\157\x6e\x74\x65\x6e\x64\x2f\123\x69\164\145\57\x4e\145\x77\57\160\150\160\56\150\164\x6d\154\56\164\167\x69\x67", ["\x75\x73\145\162" => $user, "\x66\x6f\162\155" => $form->createView(), "\146\x6f\162\155\105\x72\x72\x6f\x72\163" => $this->formErrors]); goto Efbc6; Efbc6: de739: goto eb78f; ecd13: if (!(true === $form->isSubmitted())) { goto E83b5; } goto C1f66; a2308: C1458: goto e8303; Adc4d: $user = $this->getUser(); goto bd26f; C3d61: ae801: goto E2d7f; C1f66: $response = $this->handleCreatePhpSiteForm($request, $form); goto a2699; eb78f: return $response; goto f17a7; F4274: C3a4a: goto Adc4d; f17a7: } private function createPhpSiteForm() : Form { goto a21ba; A5dcb: return $form; goto d3f69; a21ba: $form = $this->createForm("\101\x70\x70\134\106\157\x72\155\x5c\123\151\164\145\116\x65\167\x50\150\160\x54\x79\160\x65", [], ["\141\x63\164\x69\157\156" => $this->generateUrl("\x63\x6c\160\x5f\x73\151\x74\145\137\x70\x68\x70\137\x6e\145\x77"), "\155\x65\164\150\157\x64" => "\x50\x4f\x53\x54", "\141\164\164\x72" => []]); goto c5563; c5563: $form->add("\163\x75\142\155\x69\x74", SubmitType::class, ["\x61\164\x74\x72" => ["\x63\x6c\141\x73\x73" => "\x62\x74\x6e\x20\142\x74\156\55\x6c\147\40\x62\164\156\55\x62\154\x75\145"], "\x6c\x61\x62\145\154" => "\x43\x72\x65\141\x74\x65"]); goto A5dcb; d3f69: } private function handleCreatePhpSiteForm(Request $request, Form $form) { goto F2b52; F8d6b: e5bc8: goto acc28; fc567: B4a4a: goto afd0b; d8959: $this->formErrors = $this->getErrorMessages($form); goto b2bec; b2bec: goto B4a4a; goto F8d6b; F2b52: if (true === $form->isValid()) { goto e5bc8; } goto d8959; acc28: try { goto ed89b; B7ebe: $siteUser = $form->get("\163\151\x74\x65\x55\163\x65\x72")->getData(); goto Ca3da; dce20: if (!(false === empty($vhostTemplateEntity->getRootDirectory()))) { goto e7571; } goto fd0bc; ed89b: $session = $request->getSession(); goto B9274; B6b8b: $this->createPhpSite($domainName, $rootDirectory, $phpVersion, $vhostTemplateName, $siteUser, $siteUserPassword, $varnishCacheSettings); goto e1111; bb929: $varnishCacheSettings = []; goto C488c; Ac98d: $domainName = $form->get("\x64\x6f\155\141\151\156\x4e\141\155\145")->getData(); goto Fa218; c8df1: B4540: goto de071; b2009: Ecdea: goto Dcfac; b83de: $varnishCacheSettings = (array) json_decode($vhostTemplateEntity->getVarnishCacheSettings(), true); goto A54ec; Fa218: $phpVersion = $form->get("\x70\150\160\x56\x65\x72\x73\x69\x6f\156")->getData(); goto B7ebe; Dcfac: $user = $this->getUser(); goto D4ee1; ce9e8: if (false === is_null($vhostTemplateEntity)) { goto Ecdea; } goto A0e6f; C4836: return $response; goto c8df1; Ca3da: $siteUserPassword = $form->get("\163\x69\164\145\x55\x73\x65\x72\x50\x61\163\x73\167\157\162\x64")->getData(); goto c183c; Bac70: $session->getFlashBag()->set("\163\165\x63\x63\x65\163\163", $this->translator->trans("\x53\x69\x74\x65\x20\x68\x61\x73\40\142\145\x65\156\x20\143\162\145\x61\164\145\x64\56")); goto cef90; A0e6f: throw new \Exception(sprintf("\x56\150\x6f\x73\164\40\x74\x65\155\x70\x6c\x61\x74\145\40\42\x25\x73\42\40\156\x6f\164\x20\x66\157\165\x6e\x64\x2e", $vhostTemplateName)); goto b9c73; c183c: $vhostTemplateEntity = $this->getVhostTemplateEntity($vhostTemplateName); goto ce9e8; e1111: $eventData = ["\x73\151\164\x65" => $domainName, "\166\150\157\163\164\x54\145\155\160\154\x61\x74\x65\116\x61\155\145" => $vhostTemplateName, "\160\x68\160\x56\x65\x72\163\x69\x6f\x6e" => $phpVersion, "\163\x69\164\145\125\x73\x65\162" => $siteUser]; goto F0824; C488c: if (!(false === empty($vhostTemplateEntity->getVarnishCacheSettings()))) { goto Af3f6; } goto b83de; cef90: $response = $this->redirect($this->generateUrl("\143\x6c\x70\137\x73\151\164\x65\163")); goto C4836; fd0bc: $rootDirectory = sprintf("\45\163\57\45\x73", $rootDirectory, ltrim(rtrim($vhostTemplateEntity->getRootDirectory(), "\x2f"), "\57")); goto D8749; A54ec: Af3f6: goto B6b8b; D8749: e7571: goto bb929; B9274: $vhostTemplateName = $form->get("\141\x70\160\x6c\151\x63\x61\x74\x69\157\156")->getData(); goto Ac98d; D4ee1: $rootDirectory = $domainName; goto dce20; F0824: EventQueue::addEvent(EventQueue::EVENT_SITE_PHP_CREATE, $user, $eventData, $request); goto Bac70; b9c73: goto B4540; goto b2009; de071: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\156\x67\145\162", $this->translator->trans("\x41\x6e\40\145\162\x72\157\x72\40\x68\x61\x73\x20\x6f\143\x63\x75\162\x72\145\144\x2c\x20\145\x72\x72\x6f\x72\40\155\145\163\x73\141\x67\145\72\40\x25\145\162\162\157\162\x4d\x65\163\163\141\147\x65\45", ["\45\x65\x72\x72\157\x72\115\145\x73\163\x61\x67\145\45" => $e->getMessage()])); } goto fc567; afd0b: } public function newWordPressSite(Request $request) : Response { goto Fd182; Fd182: $hasPermissions = $this->hasPermissions(); goto c3e42; c66b8: b64bc: goto B2164; aa953: if (!(true === $form->isSubmitted())) { goto D209d; } goto F5919; B01e4: D209d: goto Ddd0d; ff77e: F618a: goto B01e4; F5919: $response = $this->handleCreateWordPressSiteForm($request, $form); goto f1090; Fddcc: $form = $this->createWordPressSiteForm(); goto C16f3; c91c7: $response = $this->render("\x46\x72\x6f\156\164\x65\x6e\x64\x2f\123\151\164\x65\57\116\145\x77\57\x77\x6f\x72\144\160\162\x65\x73\163\56\150\x74\x6d\154\x2e\x74\x77\151\147", ["\x75\x73\145\162" => $user, "\146\x6f\x72\155" => $form->createView(), "\146\157\162\x6d\x45\162\162\x6f\x72\x73" => $this->formErrors]); goto db11c; Ddd0d: f472c: goto c91c7; B2164: $user = $this->getUser(); goto Fddcc; Bf7db: $form->handleRequest($request); goto aa953; Beb8a: return $response; goto Ae010; db11c: C1920: goto Beb8a; C16f3: if (!(true === $request->isMethod("\x50\x4f\123\124"))) { goto f472c; } goto Bf7db; c3e42: if (true === $hasPermissions) { goto b64bc; } goto C05d2; C05d2: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\x73\151\164\x65\163")); goto d7144; f1090: if (!(false === is_null($response))) { goto F618a; } goto Db95f; d7144: goto C1920; goto c66b8; Db95f: return $response; goto ff77e; Ae010: } private function createWordPressSiteForm() : Form { goto Cfde2; Aefa1: return $form; goto a986b; e9e08: $form->add("\x73\165\x62\x6d\x69\164", SubmitType::class, ["\x61\164\164\x72" => ["\143\x6c\x61\163\x73" => "\x62\x74\156\40\x62\164\156\x2d\154\x67\x20\142\x74\x6e\55\x62\x6c\x75\x65"], "\x6c\141\142\x65\x6c" => "\103\162\x65\141\x74\x65"]); goto Aefa1; Cfde2: $form = $this->createForm("\101\x70\160\x5c\106\157\162\x6d\134\x53\151\164\145\x4e\145\x77\127\157\x72\x64\120\162\x65\163\163\x54\x79\x70\145", [], ["\141\143\x74\151\157\x6e" => $this->generateUrl("\143\154\160\137\163\151\x74\x65\137\x77\157\x72\x64\160\x72\x65\163\163\137\x6e\x65\x77"), "\x6d\145\x74\150\x6f\144" => "\x50\117\x53\124", "\141\x74\x74\x72" => ["\151\144" => "\156\x65\167\55\x77\x6f\162\x64\x70\x72\x65\163\x73\x2d\x73\151\x74\x65\55\x66\157\162\155"]]); goto e9e08; a986b: } private function handleCreateWordPressSiteForm(Request $request, Form $form) { goto Fd18b; F48b2: ad8a2: goto A7266; A7266: try { goto e63de; D7f85: $siteCredentials = [$this->translator->trans("\x53\151\x74\145") => [$this->translator->trans("\111\120\x20\101\x64\x64\x72\145\163\x73") => $instance->getIpv4PublicIp(), $this->translator->trans("\x44\x6f\x6d\x61\151\156\x20\x4e\141\x6d\145") => sprintf("\x68\x74\x74\x70\x73\x3a\x2f\x2f\45\163", $domainName), $this->translator->trans("\x53\x69\164\145\40\x55\163\145\162") => $siteUser, $this->translator->trans("\x50\x61\x73\163\167\157\x72\144") => $siteUserPassword]]; goto B71ed; ec8b2: $this->siteEntityManager->updateEntity($siteEntity); goto E4dfd; b7116: $siteUser = $this->getUniqueSiteUserName($generatedName); goto ce828; Dcb88: $siteCredentials[$this->translator->trans("\104\x61\x74\141\x62\141\163\145")] = [$this->translator->trans("\x48\x6f\x73\164") => $activeDatabaseServerEntity->getHost(), $this->translator->trans("\120\157\162\164") => $activeDatabaseServerEntity->getPort(), $this->translator->trans("\x44\141\x74\x61\x62\x61\x73\145\x20\116\x61\155\145") => $databaseName, $this->translator->trans("\x44\x61\164\x61\142\x61\x73\145\40\x55\163\x65\162\40\116\141\x6d\x65") => $databaseUserName, $this->translator->trans("\x44\141\x74\141\142\141\163\x65\40\125\163\x65\x72\40\x50\x61\163\163\x77\x6f\162\x64") => $databaseUserPassword]; goto Afc03; b63df: $databaseEntity = $this->databaseEntityManager->createEntity(); goto b23b9; d5652: $databaseUserEntity->setUserName($databaseUserName); goto d2f00; c9618: $session = $request->getSession(); goto b9360; Aeba2: $siteEntity = $this->createPhpSite($domainName, $domainName, $phpVersion, self::WORDPRESS_VHOST_TEMPLATE_NAME, $siteUser, $siteUserPassword, $varnishCacheSettings); goto c3419; a3cc8: $databaseUserPassword = PasswordGenerator::generate(self::PASSWORD_LENGTH); goto cd2be; c3419: $siteEntity->setApplication($vhostTemplateEntity->getName()); goto F949d; cd2be: $url = sprintf("\150\164\x74\160\163\72\x2f\x2f\x25\163", $siteEntity->getDomainName()); goto D9fcf; b23b9: $databaseEntity->setDatabaseServer($activeDatabaseServerEntity); goto cd944; ab480: $adminPassword = $form->get("\x61\144\155\151\x6e\120\141\x73\163\167\157\162\144")->getData(); goto adabd; Ea3a7: $response = $this->redirect($this->generateUrl("\143\x6c\x70\137\x73\151\164\x65\x5f\167\x6f\162\144\x70\162\x65\x73\163\x5f\x69\156\163\164\x61\154\154\x65\x64")); goto dd01e; E4dfd: $this->installWordPress($isMultiSite, $url, $title, $adminUserName, $adminPassword, $adminEmail, $siteEntity, $activeDatabaseServerEntity, $databaseEntity, $databaseUserEntity); goto Dcb88; F39b5: $databaseEntity->addUser($databaseUserEntity); goto B68fe; D9fcf: $title = $form->get("\163\151\164\x65\124\151\x74\x6c\145")->getData(); goto D0293; Afc03: $siteCredentials["\127\x6f\162\144\120\x72\x65\x73\163"] = [$this->translator->trans("\x41\x64\155\151\156\x20\105\55\115\141\151\154") => $adminEmail, $this->translator->trans("\101\x64\x6d\151\156\x20\x55\x73\x65\x72\x20\x4e\x61\155\145") => $adminUserName, $this->translator->trans("\101\x64\x6d\x69\156\40\120\x61\x73\163\x77\x6f\162\x64") => $adminPassword, $this->translator->trans("\101\144\155\151\156\x20\x55\162\x6c") => sprintf("\150\164\x74\x70\163\x3a\x2f\x2f\45\163\x2f\x77\x70\x2d\x61\x64\155\x69\x6e\x2f", rtrim($domainName, "\x2f"))]; goto E9486; B68fe: $siteEntity->addDatabase($databaseEntity); goto ded1c; A4d89: if (!(false === empty($vhostTemplateEntity->getVarnishCacheSettings()))) { goto ff226; } goto Ac8d6; Ac8d6: $varnishCacheSettings = (array) json_decode($vhostTemplateEntity->getVarnishCacheSettings(), true); goto B5c94; e00f3: $session->set("\x73\x69\x74\x65\x43\162\145\144\145\156\x74\151\x61\154\x73", $siteCredentials); goto e12a7; dd01e: return $response; goto f13a7; F3dc2: $databaseManager->createDatabase($databaseEntity); goto f2151; Bec2a: $varnishCacheSettings = []; goto A4d89; D0293: $adminUserName = $form->get("\141\x64\155\151\156\x55\x73\145\162\x4e\141\155\x65")->getData(); goto ab480; c913d: $databaseEntity->setSite($siteEntity); goto d8b94; F2550: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto b63df; b0789: $phpVersion = $vhostTemplateEntity->getPhpVersion(); goto Bec2a; Cf394: EventQueue::addEvent(EventQueue::EVENT_SITE_WORDPRESS_CREATE, $user, $eventData, $request); goto Ea3a7; F949d: $instance = $request->attributes->get("\x69\x6e\x73\x74\x61\156\x63\x65"); goto D7f85; ded1c: $databaseManager = new DatabaseManager($activeDatabaseServerEntity); goto F3dc2; B7070: $vhostTemplateEntity = $this->getVhostTemplateEntity(self::WORDPRESS_VHOST_TEMPLATE_NAME); goto b0789; d0e1e: $databaseName = $this->getUniqueDatabaseName($generatedName); goto c638f; d2f00: $databaseUserEntity->setPassword(Crypto::encrypt($databaseUserPassword)); goto Deb1d; cd944: $databaseEntity->setName($databaseName); goto c913d; B71ed: if (!(false === is_null($siteEntity))) { goto Fa780; } goto d0e1e; c638f: $databaseUserName = $this->getUniqueDatabaseUserName($generatedName); goto a3cc8; Fc7aa: $generatedName = $this->generateNameFromDomainName($domainName); goto b7116; B5c94: ff226: goto Aeba2; b9360: $domainName = $form->get("\x64\157\155\x61\x69\x6e\116\x61\x6d\x65")->getData(); goto Fc7aa; ce828: $siteUserPassword = PasswordGenerator::generate(self::PASSWORD_LENGTH); goto B7070; d0295: $isMultiSite = $form->get("\155\x75\154\164\x69\123\151\164\x65")->getData(); goto F2550; Deb1d: $databaseUserEntity->setPermissions(DatabaseUserEntity::PERMISSIONS_READ_WRITE); goto b14c7; adabd: $adminEmail = $form->get("\141\x64\155\151\156\105\x6d\x61\x69\154")->getData(); goto d0295; e63de: $user = $this->getUser(); goto c9618; f2151: $databaseManager->createUser($databaseUserEntity); goto ec8b2; d8b94: $databaseUserEntity = $this->databaseUserEntityManager->createEntity(); goto d5652; e12a7: $eventData = ["\163\x69\x74\x65" => $domainName, "\163\151\164\145\125\x73\145\x72" => $siteUser]; goto Cf394; b14c7: $databaseUserEntity->setDatabase($databaseEntity); goto F39b5; E9486: Fa780: goto e00f3; f13a7: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\x61\156\x67\145\162", $this->translator->trans("\101\x6e\40\x65\162\x72\157\162\40\150\x61\163\x20\x6f\x63\x63\x75\162\162\145\x64\54\x20\x65\x72\162\x6f\x72\x20\x6d\x65\x73\163\x61\x67\x65\72\40\x25\145\x72\x72\x6f\x72\x4d\145\163\163\x61\147\145\45", ["\45\x65\162\x72\x6f\x72\x4d\145\x73\x73\x61\147\145\45" => $e->getMessage()])); } goto a1dc4; Fd18b: if (true === $form->isValid()) { goto ad8a2; } goto D52ff; D180e: goto Dd031; goto F48b2; D52ff: $this->formErrors = $this->getErrorMessages($form); goto D180e; a1dc4: Dd031: goto E5bae; E5bae: } private function installWordPress(bool $isMultiSite, string $url, string $title, string $adminUserName, string $adminPassword, string $adminEmail, SiteEntity $siteEntity, DatabaseServerEntity $databaseServerEntity, DatabaseEntity $databaseEntity, DatabaseUserEntity $databaseUserEntity) : void { goto b04da; Edeb6: $databaseUserName = $databaseUserEntity->getUserName(); goto a6940; b04da: $databaseHost = sprintf("\x25\163\x3a\x25\x73", $databaseServerEntity->getHost(), $databaseServerEntity->getPort()); goto B1c57; a79db: C2973: goto Ed009; e5023: if (!(true === $isMultiSite)) { goto F5f6b; } goto C22ac; B42f6: Dc041: goto e5023; B1c57: $databaseName = $databaseEntity->getName(); goto Edeb6; C22ac: $this->wordPressMultiSiteConfigValues["\104\117\x4d\x41\x49\116\137\x43\125\122\122\x45\x4e\x54\x5f\123\x49\x54\x45"]["\x76\141\x6c\165\x65"] = $siteEntity->getDomainName(); goto e4b73; e0a76: $wordPressInstaller->createConfig($databaseHost, $databaseName, $databaseUserName, $databaseUserPassword); goto eed2b; Aa44d: $wordPressInstaller = new WordPressInstaller($siteEntity); goto Cccf1; A51a7: $wordPressInstaller->resetPermissions(); goto ac8c9; Ed009: F5f6b: goto A51a7; e4b73: foreach ($this->wordPressMultiSiteConfigValues as $key => $config) { $wordPressInstaller->setConfigValue($key, $config["\x76\141\x6c\165\145"], $config["\x72\141\x77"]); C5b7d: } goto a79db; eed2b: $wordPressInstaller->installCore($isMultiSite, $url, $title, $adminUserName, $adminPassword, $adminEmail); goto e0929; e0929: foreach ($this->wordPressDefaultConfigValues as $key => $config) { $wordPressInstaller->setConfigValue($key, $config["\166\x61\x6c\165\145"], $config["\x72\141\x77"]); d8799: } goto B42f6; Cccf1: $wordPressInstaller->downloadAndExtractLatestVersion(); goto e0a76; a6940: $databaseUserPassword = Crypto::decrypt($databaseUserEntity->getPassword()); goto Aa44d; ac8c9: } private function createPhpSite(string $domainName, string $rootDirectory, string $phpVersion, string $vhostTemplateName, string $siteUser, string $siteUserPassword, array $varnishCacheSettings = []) : SiteEntity { goto A75b8; Dce6b: $redirectionVhostTemplate = file_get_contents($redirectionVhostTemplateFile); goto d919a; c4e51: $phpSite->setVhostTemplate($siteEntity->getVhostTemplate()); goto Db905; b27f2: $siteConstraints = $this->validator->validate($siteEntity); goto C26ec; f4815: $certificateEntity->setPrivateKey($privateKey->getPEM()); goto Ab1e4; F670c: $phpSiteCreator->createNginxVhost(); goto Cb7be; b086f: $siteEntity->setVarnishCache(true); goto A0549; F2990: Cca71: goto Ee10e; A1c5f: ef0e1: goto ed0b8; A51ba: $siteEntity = $this->siteEntityManager->createEntity(); goto c66a7; d7252: $phpSiteCreator->createPhpFpmPool(); goto f22bd; Ef758: $vhostTemplate->resetProcessors(); goto A52e1; Fb331: $phpSettingsEntity = new PhpSettingsEntity(); goto Aa383; f22bd: $phpSiteCreator->reloadPhpFpmService(); goto Af3c3; fab2e: if (!(count($siteConstraints) || count($phpSettingsConstraints))) { goto Cca71; } goto E184b; bacbb: $vhostTemplate->addProcessor(new RedirectDomainProcessor()); goto E252b; a96d3: $vhostTemplate->setContent($siteEntity->getVhostTemplate()); goto Ef758; Db900: $siteEntity->setCertificate($certificateEntity); goto cc350; B4dd4: $csr = $csrGenerator->generate(); goto fddd6; C0aff: $phpSiteCreator->createRootDirectory(); goto D894d; D620c: $phpSite->setRegistrableDomain($registrableDomain); goto b3730; cc350: $phpSite = new PhpSite(); goto bfb19; E5612: $rootDirectory = trim(rtrim(ltrim($rootDirectory, "\x2f")), "\x2f"); goto d7fd7; Dfb9c: $subdomain = false === empty($subdomain) ? $subdomain : null; goto d31d3; fcbcc: $phpSite->setRootDirectory($siteEntity->getRootDirectory()); goto df60e; Dfc41: throw new \Exception(implode("\73\x20", $errorMessages)); goto F2990; b3730: $phpSite->setSubdomain($subdomain); goto fcbcc; d7fd7: $resolvedDomainName = $this->domainNameParser->resolveDomainName($domainName); goto e339a; Ee10e: $certificateEntity = $this->certificateEntityManager->createEntity(); goto Edb97; b270e: $subdomain = $resolvedDomainName->subDomain()->toString(); goto Dfb9c; df60e: $phpSite->setCertificate($certificateEntity); goto A48f4; Ccf2e: $this->siteEntityManager->updateEntity($siteEntity); goto e692e; F2ceb: $siteEntity->setUserPassword($siteUserPassword); goto B59a3; d391b: $vhostTemplate = $vhostTemplateEntity->getTemplate(); goto A51ba; Edb97: $certificateEntity->setSite($siteEntity); goto c0041; f3292: $phpSite->setVarnishCache(true); goto f224e; d919a: if (!(false === empty($redirectionVhostTemplate))) { goto ef0e1; } goto b17ae; ed2b5: $phpSiteCreator->createVarnishCacheStructure($varnishCacheSettings); goto E3d57; C26ec: $phpSettingsConstraints = $this->validator->validate($phpSettingsEntity); goto fab2e; A52e1: $vhostTemplate->addProcessor(new ServerNameProcessor()); goto Ed29a; c0041: $rsaKeyGenerator = new RsaKeyGenerator(); goto bcacc; bfb19: $phpSite->setUser($siteEntity->getUser()); goto ffb45; F269a: $phpSiteCreator->createIndexPhp(); goto C5cfa; d1de8: if (!(false === is_null($subdomain) && "\167\167\167" == $subdomain)) { goto A0154; } goto dd539; d31d3: $vhostTemplateEntity = $this->getVhostTemplateEntity($vhostTemplateName); goto d391b; c2486: $csrGenerator = new CsrGenerator($privateKey, $distinguishedName); goto B4dd4; Db905: $phpSiteCreator = new PhpSiteCreator($phpSite); goto A565d; b17ae: $vhostTemplate = sprintf("\x25\163\45\x73", $redirectionVhostTemplate, $vhostTemplate); goto A1c5f; ffb45: $phpSite->setUserPassword($siteEntity->getUserPassword()); goto E1048; Cb7be: $phpSiteCreator->reloadNginxService(); goto B887c; B8d58: $distinguishedName = new DistinguishedName($domainName, $subjectAlternativeNames); goto c2486; Fad3c: $constraintViolationList->addAll($siteConstraints); goto fe6cc; F9723: $siteEntity->setUser($siteUser); goto F2ceb; fddd6: $selfSignedCertificate = Openssl::createSelfSignedCertificate($privateKey, $csr); goto Afc21; e8ba4: $certificateEntity->setType(CertificateEntity::TYPE_SELF_SIGNED); goto de89a; Cc425: $vhostTemplate = new PhpVhostTemplate($phpSite); goto a96d3; B59a3: $siteEntity->setRootDirectory($rootDirectory); goto A7e66; A5cd3: $siteEntity->setVhostTemplate($vhostTemplate); goto Fb331; Ab1e4: $certificateEntity->setCertificate($selfSignedCertificate); goto Db900; E184b: $constraintViolationList = new ConstraintViolationList(); goto Fad3c; ed0b8: f5148: goto A5cd3; abfad: $subjectAlternativeNames[] = sprintf("\167\x77\167\x2e\45\163", $domainName); goto Ea17f; a6164: $phpSettingsEntity->setPhpVersion($phpVersion); goto a0acb; Af3c3: if (!(true === $varnishCache)) { goto B5132; } goto f3292; B887c: $phpSiteCreator->resetPermissions(); goto Cc425; Aa383: $siteEntity->setPhpSettings($phpSettingsEntity); goto a6164; e692e: return $siteEntity; goto c98ea; fe6cc: $constraintViolationList->addAll($phpSettingsConstraints); goto e01a4; D3b08: $siteEntity->setDomainName($domainName); goto F9723; C5cfa: $phpSiteCreator->createPrivateKeyAndCertificate(); goto d7252; A48f4: $phpSite->setPhpSettings($phpSettingsEntity); goto c4e51; e01a4: $errorMessages = $this->getConstraintViolationListErrorMessages($constraintViolationList); goto Dfc41; ecc4a: $varnishCacheSettings = array_merge($defaultVarnishCacheSettings, $varnishCacheSettings); goto ed2b5; A75b8: $varnishCache = false === empty($varnishCacheSettings) ? true : false; goto E5612; de89a: $certificateEntity->setCsr($csr); goto f4815; bcacc: $privateKey = $rsaKeyGenerator->generatePrivateKey(); goto ecbb4; F7097: if (!(true === is_null($subdomain))) { goto C1575; } goto abfad; dd539: $subjectAlternativeNames[] = $registrableDomain; goto C472f; D894d: $phpSiteCreator->createLogrotateFile(); goto F269a; fae75: if (!(true === is_null($subdomain) || "\x77\x77\x77" == $subdomain)) { goto f5148; } goto c3a5c; A79a5: $siteEntity->setApplication($vhostTemplateEntity->getName()); goto Ccf2e; f224e: $defaultVarnishCacheSettings = ["\x65\156\x61\142\154\x65\x64" => false, "\x73\145\x72\166\145\162" => self::VARNISH_CACHE_SERVER, "\143\x61\x63\150\145\x54\141\147\x50\x72\x65\146\x69\x78" => substr(md5(time()), 0, 4)]; goto ecc4a; cc0fd: B5132: goto F670c; C472f: A0154: goto B8d58; e339a: $registrableDomain = $resolvedDomainName->registrableDomain()->toString(); goto b270e; a0acb: $phpSettingsEntity->setSite($siteEntity); goto b27f2; c3a5c: $redirectionVhostTemplateFile = realpath(dirname(__FILE__) . "\57\56\x2e\57\x2e\x2e\x2f\56\x2e\57\x72\x65\x73\x6f\165\x72\143\145\x73\x2f\x6e\x67\151\x6e\x78\57\x76\x68\x6f\x73\x74\x5f\164\x65\x6d\x70\x6c\141\x74\145\x2f\x72\x65\x64\151\x72\x65\143\164"); goto Dce6b; Afc21: $certificateEntity->setDefaultCertificate(true); goto e8ba4; A7e66: if (!(false === empty($varnishCache))) { goto c31c8; } goto b086f; c66a7: $siteEntity->setType(SiteEntity::TYPE_PHP); goto D3b08; ecbb4: $subjectAlternativeNames = []; goto F7097; A0549: c31c8: goto fae75; A565d: $phpSiteCreator->createUser(); goto C0aff; E3d57: $phpSite->setVarnishCacheSettings($varnishCacheSettings); goto cc0fd; Ea17f: C1575: goto d1de8; E1048: $phpSite->setDomainName($domainName); goto D620c; Ed29a: $vhostTemplate->addProcessor(new RedirectServerNameProcessor()); goto bacbb; df9f9: $siteEntity->setVhostTemplate($vhostTemplate->getContent()); goto A79a5; E252b: $vhostTemplate->build(); goto df9f9; c98ea: } private function createNodejsSite(string $domainName, string $nodejsVersion, string $port, string $siteUser, string $siteUserPassword) : SiteEntity { goto Fdb15; Fd941: $nodejsSite->setDomainName($domainName); goto c6ed9; C344a: $siteConstraints = $this->validator->validate($siteEntity); goto f7cd7; a0a43: $vhostTemplate->build(); goto Cb931; a73d9: $subdomain = $resolvedDomainName->subDomain()->toString(); goto d91ef; Cbfe6: if (!(true === is_null($subdomain) || "\167\x77\167" == $subdomain)) { goto Bd6c1; } goto Ceb54; a1640: $nodejsSite->setSubdomain($subdomain); goto b51c5; d339d: $siteEntity->setUser($siteUser); goto C83d3; a78b2: $nodejsSite->setUser($siteEntity->getUser()); goto e38c7; bb9dc: Bd6c1: goto facde; e83bc: D7d13: goto A2d6c; ab8f9: if (!(false === is_null($subdomain) && "\167\x77\167" == $subdomain)) { goto D7d13; } goto D63cb; b51c5: $nodejsSite->setRootDirectory($siteEntity->getRootDirectory()); goto fab1e; a6c53: $vhostTemplate->addProcessor(new RedirectDomainProcessor()); goto a0a43; Fdb50: $siteEntity->setType(SiteEntity::TYPE_NODEJS); goto D3f68; ba5fd: $constraintViolationList->addAll($nodejsSettingsConstraints); goto B3aac; b5849: if (!(true === is_null($subdomain))) { goto aa9bb; } goto Cc468; fe845: $selfSignedCertificate = Openssl::createSelfSignedCertificate($privateKey, $csr); goto fc12f; ff41a: $csrGenerator = new CsrGenerator($privateKey, $distinguishedName); goto c636c; c6ed9: $nodejsSite->setRegistrableDomain($registrableDomain); goto a1640; f4b07: $privateKey = $rsaKeyGenerator->generatePrivateKey(); goto b9b76; Cc468: $subjectAlternativeNames[] = sprintf("\x77\167\167\56\x25\163", $domainName); goto B72ff; c636c: $csr = $csrGenerator->generate(); goto fe845; Deb02: $nodejsSiteCreator = new NodejsSiteCreator($nodejsSite); goto C7ab1; bb556: $nodejsSite = new NodejsSite(); goto a78b2; fc18b: $nodejsSiteCreator->createRootDirectory(); goto cc895; ca5ee: $registrableDomain = $resolvedDomainName->registrableDomain()->toString(); goto a73d9; D16ec: $certificateEntity->setCertificate($selfSignedCertificate); goto be748; bbd84: $vhostTemplate = sprintf("\x25\163\45\163", $redirectionVhostTemplate, $vhostTemplate); goto dce85; a302b: Fe99c: goto f83eb; B72ff: aa9bb: goto ab8f9; A7244: $vhostTemplate = $vhostTemplateEntity->getTemplate(); goto e9583; be55b: $rsaKeyGenerator = new RsaKeyGenerator(); goto f4b07; c705f: $vhostTemplate->addProcessor(new ServerNameProcessor()); goto Eb06e; C7ab1: $nodejsSiteCreator->createUser(); goto fc18b; Bf60d: $vhostTemplate = new StaticVhostTemplate($nodejsSite); goto b2102; A203e: $certificateEntity->setCsr($csr); goto Bcffe; B3aac: $errorMessages = $this->getConstraintViolationListErrorMessages($constraintViolationList); goto E27e4; D4c66: $nodejsSettingsEntity->setSite($siteEntity); goto C344a; D7e8a: $vhostTemplate->resetProcessors(); goto c705f; A1d34: $nodejsSite->setNodejsSettings($nodejsSettingsEntity); goto a7243; b2102: $vhostTemplate->setContent($siteEntity->getVhostTemplate()); goto D7e8a; D5590: $nodejsSiteCreator->createNginxVhost(); goto c69b0; fc12f: $certificateEntity->setDefaultCertificate(true); goto d014a; E5886: $constraintViolationList->addAll($siteConstraints); goto ba5fd; d014a: $certificateEntity->setType(CertificateEntity::TYPE_SELF_SIGNED); goto A203e; Cb931: $siteEntity->setVhostTemplate($vhostTemplate->getContent()); goto aa854; Bcffe: $certificateEntity->setPrivateKey($privateKey->getPEM()); goto D16ec; b2c03: return $siteEntity; goto A6a6d; f6b1c: $nodejsSettingsEntity = new NodejsSettingsEntity(); goto A5cc4; C37e0: $this->siteEntityManager->updateEntity($siteEntity); goto b2c03; dce85: Ef778: goto bb9dc; c3eb7: $nodejsSiteCreator->createNvmDirectory(); goto cd43e; Cf5d8: $certificateEntity->setSite($siteEntity); goto be55b; aa854: $siteEntity->setApplication($vhostTemplateEntity->getName()); goto C37e0; Fdb15: $resolvedDomainName = $this->domainNameParser->resolveDomainName($domainName); goto ca5ee; Bac66: $constraintViolationList = new ConstraintViolationList(); goto E5886; e38c7: $nodejsSite->setUserPassword($siteEntity->getUserPassword()); goto Fd941; D3f68: $siteEntity->setDomainName($domainName); goto d339d; facde: $siteEntity->setVhostTemplate($vhostTemplate); goto f6b1c; eb646: if (!(false === empty($redirectionVhostTemplate))) { goto Ef778; } goto bbd84; C9092: $vhostTemplateEntity = $this->getVhostTemplateEntity(self::NODEJS_VHOST_TEMPLATE_NAME); goto A7244; f7cd7: $nodejsSettingsConstraints = $this->validator->validate($nodejsSettingsEntity); goto A7c4e; C83d3: $siteEntity->setUserPassword($siteUserPassword); goto f333d; E27e4: throw new \Exception(implode("\x3b\40", $errorMessages)); goto a302b; E323f: $nodejsSettingsEntity->setNodejsVersion($nodejsVersion); goto C8b6a; a7243: $nodejsSite->setVhostTemplate($siteEntity->getVhostTemplate()); goto Deb02; c69b0: $nodejsSiteCreator->reloadNginxService(); goto cf654; Db2a5: $redirectionVhostTemplate = file_get_contents($redirectionVhostTemplateFile); goto eb646; e9583: $siteEntity = $this->siteEntityManager->createEntity(); goto Fdb50; A5cc4: $siteEntity->setNodejsSettings($nodejsSettingsEntity); goto E323f; d91ef: $subdomain = false === empty($subdomain) ? $subdomain : null; goto C9092; be748: $siteEntity->setCertificate($certificateEntity); goto bb556; cf654: $nodejsSiteCreator->resetPermissions(); goto Bf60d; C8b6a: $nodejsSettingsEntity->setPort($port); goto D4c66; C300b: $nodejsSiteCreator->createPrivateKeyAndCertificate(); goto D5590; cc895: $nodejsSiteCreator->createLogrotateFile(); goto c3eb7; b9b76: $subjectAlternativeNames = []; goto b5849; Eb06e: $vhostTemplate->addProcessor(new RedirectServerNameProcessor()); goto a6c53; Ceb54: $redirectionVhostTemplateFile = realpath(dirname(__FILE__) . "\x2f\x2e\56\x2f\56\x2e\57\56\56\57\x72\x65\163\157\165\162\143\x65\163\57\x6e\x67\151\x6e\x78\x2f\x76\x68\157\x73\164\x5f\164\x65\155\x70\154\141\x74\x65\x2f\162\145\144\151\162\x65\x63\x74"); goto Db2a5; f333d: $siteEntity->setRootDirectory($domainName); goto Cbfe6; A2d6c: $distinguishedName = new DistinguishedName($domainName, $subjectAlternativeNames); goto ff41a; D63cb: $subjectAlternativeNames[] = $registrableDomain; goto e83bc; cd43e: $nodejsSiteCreator->installNodejs(); goto C300b; A7c4e: if (!(count($siteConstraints) || count($nodejsSettingsConstraints))) { goto Fe99c; } goto Bac66; fab1e: $nodejsSite->setCertificate($certificateEntity); goto A1d34; f83eb: $certificateEntity = $this->certificateEntityManager->createEntity(); goto Cf5d8; A6a6d: } private function createPythonSite(string $domainName, string $pythonVersion, string $port, string $siteUser, string $siteUserPassword) : SiteEntity { goto ce334; Ac6d1: $vhostTemplate->addProcessor(new ServerNameProcessor()); goto fc22c; Efb90: $siteEntity->setVhostTemplate($vhostTemplate->getContent()); goto C8d5e; b6b4f: $registrableDomain = $resolvedDomainName->registrableDomain()->toString(); goto ecb06; b10d2: $vhostTemplate->resetProcessors(); goto Ac6d1; e3237: $pythonSite->setPythonSettings($pythonSettingsEntity); goto a7eba; Eba35: $pythonSettingsEntity->setPythonVersion($pythonVersion); goto ec6e9; Ba739: $vhostTemplate->build(); goto Efb90; Db8f7: $vhostTemplate->addProcessor(new RedirectDomainProcessor()); goto Ba739; D440a: $certificateEntity->setPrivateKey($privateKey->getPEM()); goto D16c7; Dcb1e: $pythonSettingsEntity = new PythonSettingsEntity(); goto B10c0; e3ecf: $pythonSiteCreator = new PythonSiteCreator($pythonSite); goto A0286; fc22c: $vhostTemplate->addProcessor(new RedirectServerNameProcessor()); goto Db8f7; Bb21c: $siteEntity->setApplication($vhostTemplateEntity->getName()); goto Ee4ea; B54de: if (!(count($siteConstraints) || count($pythonSettingsConstraints))) { goto b145c; } goto A2f07; ecb06: $subdomain = $resolvedDomainName->subDomain()->toString(); goto E8dfa; fbcec: if (!(true === is_null($subdomain) || "\x77\167\x77" == $subdomain)) { goto Addff; } goto F163b; b4e94: $errorMessages = $this->getConstraintViolationListErrorMessages($constraintViolationList); goto Ff3f1; dc10d: $vhostTemplate = sprintf("\x25\163\45\x73", $redirectionVhostTemplate, $vhostTemplate); goto F8bb1; Ee4ea: return $siteEntity; goto Eb646; B2676: $vhostTemplate->setContent($siteEntity->getVhostTemplate()); goto b10d2; c6557: $siteEntity->setUser($siteUser); goto c8ede; eb5a4: $pythonSettingsEntity->setSite($siteEntity); goto e1b7e; D26ec: $siteEntity->setRootDirectory($domainName); goto fbcec; bcb24: $certificateEntity = $this->certificateEntityManager->createEntity(); goto f8ae0; c3abb: $pythonSite->setUserPassword($siteEntity->getUserPassword()); goto D087d; A9dc3: $distinguishedName = new DistinguishedName($domainName, $subjectAlternativeNames); goto E97df; Cc56a: $siteEntity->setDomainName($domainName); goto c6557; A0286: $pythonSiteCreator->createUser(); goto D4756; A2475: $pythonSite->setRegistrableDomain($registrableDomain); goto ef2f1; a27bf: $pythonSiteCreator->createPrivateKeyAndCertificate(); goto Bc81c; A2f07: $constraintViolationList = new ConstraintViolationList(); goto Fcb7c; B2260: $siteEntity->setType(SiteEntity::TYPE_PYTHON); goto Cc56a; Ab954: $vhostTemplate = $vhostTemplateEntity->getTemplate(); goto Fea88; D4756: $pythonSiteCreator->createRootDirectory(); goto cf6ed; ef3e1: $rsaKeyGenerator = new RsaKeyGenerator(); goto b9cfa; Cabe0: Da33b: goto A9dc3; Bc81c: $pythonSiteCreator->createNginxVhost(); goto B8e6c; C3286: if (!(true === is_null($subdomain))) { goto d1bd3; } goto bf52d; b9cfa: $privateKey = $rsaKeyGenerator->generatePrivateKey(); goto Cd0e5; B8e6c: $pythonSiteCreator->reloadNginxService(); goto c7ab6; Fa2bc: $subjectAlternativeNames[] = $registrableDomain; goto Cabe0; Cf39d: $pythonSettingsConstraints = $this->validator->validate($pythonSettingsEntity); goto B54de; E1801: $pythonSite = new PythonSite(); goto A6a1f; e1b7e: $siteConstraints = $this->validator->validate($siteEntity); goto Cf39d; D16c7: $certificateEntity->setCertificate($selfSignedCertificate); goto D86eb; d2b32: $csr = $csrGenerator->generate(); goto ca407; Cd0e5: $subjectAlternativeNames = []; goto C3286; F163b: $redirectionVhostTemplateFile = realpath(dirname(__FILE__) . "\x2f\56\56\x2f\x2e\x2e\x2f\x2e\56\57\x72\145\x73\157\x75\x72\x63\145\163\57\156\147\151\156\x78\x2f\166\150\157\163\164\137\x74\145\x6d\160\x6c\141\164\x65\x2f\x72\145\x64\151\162\145\x63\164"); goto E45be; Fcb7c: $constraintViolationList->addAll($siteConstraints); goto D4fbf; E45be: $redirectionVhostTemplate = file_get_contents($redirectionVhostTemplateFile); goto af42d; F3548: $certificateEntity->setType(CertificateEntity::TYPE_SELF_SIGNED); goto C19c9; c8ede: $siteEntity->setUserPassword($siteUserPassword); goto D26ec; E529c: $vhostTemplateEntity = $this->getVhostTemplateEntity(self::PYTHON_VHOST_TEMPLATE_NAME); goto Ab954; C5fdd: Addff: goto ae812; E6151: $vhostTemplate = new PythonVhostTemplate($pythonSite); goto B2676; F8bb1: B753f: goto C5fdd; af42d: if (!(false === empty($redirectionVhostTemplate))) { goto B753f; } goto dc10d; c7ab6: $pythonSiteCreator->resetPermissions(); goto E6151; cf6ed: $pythonSiteCreator->createLogrotateFile(); goto ee379; f8ae0: $certificateEntity->setSite($siteEntity); goto ef3e1; eac71: $certificateEntity->setDefaultCertificate(true); goto F3548; D4fbf: $constraintViolationList->addAll($pythonSettingsConstraints); goto b4e94; ec6e9: $pythonSettingsEntity->setPort($port); goto eb5a4; A6a1f: $pythonSite->setUser($siteEntity->getUser()); goto c3abb; ee379: $pythonSiteCreator->writePythonVersionFile(); goto a27bf; bf52d: $subjectAlternativeNames[] = sprintf("\167\x77\x77\x2e\45\163", $domainName); goto E2ce9; ce334: $resolvedDomainName = $this->domainNameParser->resolveDomainName($domainName); goto b6b4f; ae812: $siteEntity->setVhostTemplate($vhostTemplate); goto Dcb1e; C8d5e: $this->siteEntityManager->updateEntity($siteEntity); goto Bb21c; a8296: b145c: goto bcb24; D5311: $pythonSite->setCertificate($certificateEntity); goto e3237; C19c9: $certificateEntity->setCsr($csr); goto D440a; f0d5b: $pythonSite->setRootDirectory($siteEntity->getRootDirectory()); goto D5311; D087d: $pythonSite->setDomainName($domainName); goto A2475; E97df: $csrGenerator = new CsrGenerator($privateKey, $distinguishedName); goto d2b32; E2ce9: d1bd3: goto B3b89; ca407: $selfSignedCertificate = Openssl::createSelfSignedCertificate($privateKey, $csr); goto eac71; B3b89: if (!(false === is_null($subdomain) && "\167\x77\167" == $subdomain)) { goto Da33b; } goto Fa2bc; Fea88: $siteEntity = $this->siteEntityManager->createEntity(); goto B2260; Ff3f1: throw new \Exception(implode("\73\40", $errorMessages)); goto a8296; ef2f1: $pythonSite->setSubdomain($subdomain); goto f0d5b; a7eba: $pythonSite->setVhostTemplate($siteEntity->getVhostTemplate()); goto e3ecf; E8dfa: $subdomain = false === empty($subdomain) ? $subdomain : null; goto E529c; B10c0: $siteEntity->setPythonSettings($pythonSettingsEntity); goto Eba35; D86eb: $siteEntity->setCertificate($certificateEntity); goto E1801; Eb646: } private function createStaticSite(string $domainName, string $siteUser, string $siteUserPassword) : SiteEntity { goto eabf6; F2d70: $vhostTemplate->setContent($siteEntity->getVhostTemplate()); goto eaa0f; Adf6c: $staticSite->setRegistrableDomain($registrableDomain); goto d05f0; Bf51f: $vhostTemplate = sprintf("\x25\x73\x25\x73", $redirectionVhostTemplate, $vhostTemplate); goto E9910; Eb634: $vhostTemplate->addProcessor(new ServerNameProcessor()); goto e93d9; f34bf: $constraintViolationList = new ConstraintViolationList(); goto A370e; ec447: $staticSiteCreator->createUser(); goto b0395; c26df: $staticSiteCreator->resetPermissions(); goto b68a8; b0395: $staticSiteCreator->createRootDirectory(); goto bfcbc; D6fbb: $staticSiteCreator->reloadNginxService(); goto c26df; eabf6: $resolvedDomainName = $this->domainNameParser->resolveDomainName($domainName); goto c01f5; ba05e: $subdomain = false === empty($subdomain) ? $subdomain : null; goto E6690; A4ab7: $certificateEntity->setType(CertificateEntity::TYPE_SELF_SIGNED); goto d9a71; d8dce: $this->siteEntityManager->updateEntity($siteEntity); goto f7499; d0a98: $staticSite->setCertificate($certificateEntity); goto D1abd; F1ec3: $staticSiteCreator->createIndexHtml(); goto bfc40; c01f5: $registrableDomain = $resolvedDomainName->registrableDomain()->toString(); goto cd9c9; e93d9: $vhostTemplate->addProcessor(new RedirectServerNameProcessor()); goto F7517; Af729: $certificateEntity->setCertificate($selfSignedCertificate); goto E3a92; D1827: $staticSiteCreator = new StaticSiteCreator($staticSite); goto ec447; C2719: $siteEntity->setUser($siteUser); goto E7883; A370e: $constraintViolationList->addAll($siteConstraints); goto F4571; db71b: throw new \Exception(implode("\73\40", $errorMessages)); goto fbdd8; D03b3: $certificateEntity->setDefaultCertificate(true); goto A4ab7; D1abd: $staticSite->setVhostTemplate($siteEntity->getVhostTemplate()); goto D1827; b89e8: if (!(true === is_null($subdomain))) { goto e96e6; } goto F10b7; db407: $redirectionVhostTemplateFile = realpath(dirname(__FILE__) . "\57\56\x2e\x2f\56\x2e\x2f\56\56\57\162\x65\163\x6f\x75\x72\x63\145\163\x2f\156\147\x69\x6e\x78\x2f\x76\x68\157\163\x74\137\x74\145\x6d\x70\x6c\141\164\x65\x2f\162\145\144\151\x72\145\143\164"); goto A4282; bfcbc: $staticSiteCreator->createLogrotateFile(); goto F1ec3; E3a92: $siteEntity->setCertificate($certificateEntity); goto c931d; F7517: $vhostTemplate->addProcessor(new RedirectDomainProcessor()); goto B0411; B0411: $vhostTemplate->build(); goto Bd7a7; A4282: $redirectionVhostTemplate = file_get_contents($redirectionVhostTemplateFile); goto Cac0e; E2326: $siteEntity->setApplication($vhostTemplateEntity->getName()); goto d8dce; a1c22: $subjectAlternativeNames[] = $registrableDomain; goto dec05; E9910: D5252: goto Ad889; E674f: $certificateEntity->setPrivateKey($privateKey->getPEM()); goto Af729; ac0c5: $siteEntity->setDomainName($domainName); goto C2719; Bd183: $staticSite->setUserPassword($siteEntity->getUserPassword()); goto Cb751; a7696: $privateKey = $rsaKeyGenerator->generatePrivateKey(); goto C2124; Ec3fc: $csrGenerator = new CsrGenerator($privateKey, $distinguishedName); goto a2fa3; f7499: return $siteEntity; goto C4d88; e5992: $distinguishedName = new DistinguishedName($domainName, $subjectAlternativeNames); goto Ec3fc; b3de8: $rsaKeyGenerator = new RsaKeyGenerator(); goto a7696; Ce93d: $siteEntity->setVhostTemplate($vhostTemplate); goto E1e41; b68a8: $vhostTemplate = new StaticVhostTemplate($staticSite); goto F2d70; d9a71: $certificateEntity->setCsr($csr); goto E674f; de117: $selfSignedCertificate = Openssl::createSelfSignedCertificate($privateKey, $csr); goto D03b3; dec05: F55db: goto e5992; Bd7a7: $siteEntity->setVhostTemplate($vhostTemplate->getContent()); goto E2326; b8448: $certificateEntity->setSite($siteEntity); goto b3de8; F13a2: $vhostTemplate = $vhostTemplateEntity->getTemplate(); goto a06f1; F4571: $errorMessages = $this->getConstraintViolationListErrorMessages($constraintViolationList); goto db71b; C2124: $subjectAlternativeNames = []; goto b89e8; a2fa3: $csr = $csrGenerator->generate(); goto de117; bb7a3: if (!(false === is_null($subdomain) && "\167\167\167" == $subdomain)) { goto F55db; } goto a1c22; Fa8a2: $siteEntity->setType(SiteEntity::TYPE_STATIC); goto ac0c5; A1456: if (!count($siteConstraints)) { goto F231b; } goto f34bf; e5282: e96e6: goto bb7a3; F10b7: $subjectAlternativeNames[] = sprintf("\167\x77\167\56\x25\163", $domainName); goto e5282; Bb2d9: $certificateEntity = $this->certificateEntityManager->createEntity(); goto b8448; Cb751: $staticSite->setDomainName($domainName); goto Adf6c; E8592: $staticSite->setUser($siteEntity->getUser()); goto Bd183; E1e41: $siteConstraints = $this->validator->validate($siteEntity); goto A1456; Ea5d4: $staticSiteCreator->createNginxVhost(); goto D6fbb; Fde39: $siteEntity->setRootDirectory($domainName); goto Fcc90; E7883: $siteEntity->setUserPassword($siteUserPassword); goto Fde39; Ad889: a3dba: goto Ce93d; eaa0f: $vhostTemplate->resetProcessors(); goto Eb634; E6690: $vhostTemplateEntity = $this->getVhostTemplateEntity(self::STATIC_SITE_VHOST_TEMPLATE_NAME); goto F13a2; cd9c9: $subdomain = $resolvedDomainName->subDomain()->toString(); goto ba05e; Cac0e: if (!(false === empty($redirectionVhostTemplate))) { goto D5252; } goto Bf51f; e3d96: $staticSite->setRootDirectory($siteEntity->getRootDirectory()); goto d0a98; Fcc90: if (!(true === is_null($subdomain) || "\167\167\x77" == $subdomain)) { goto a3dba; } goto db407; bfc40: $staticSiteCreator->createPrivateKeyAndCertificate(); goto Ea5d4; c931d: $staticSite = new StaticSite(); goto E8592; a06f1: $siteEntity = $this->siteEntityManager->createEntity(); goto Fa8a2; fbdd8: F231b: goto Bb2d9; d05f0: $staticSite->setSubdomain($subdomain); goto e3d96; C4d88: } private function createReverseProxySite(string $domainName, string $reverseProxyUrl, string $siteUser, string $siteUserPassword) : SiteEntity { goto E99ba; Cb084: $siteEntity = $this->siteEntityManager->createEntity(); goto B1b94; F1443: $reversProxySiteCreator->createLogrotateFile(); goto d7108; ac57f: return $siteEntity; goto fc61b; Ebbe7: $vhostTemplate->addProcessor(new RedirectDomainProcessor()); goto c6e69; F2060: $siteEntity->setApplication($vhostTemplateEntity->getName()); goto B48e2; E99ba: $resolvedDomainName = $this->domainNameParser->resolveDomainName($domainName); goto f6d38; Ec71b: B90e0: goto a6e13; dd744: $reverseProxySite->setReverseProxyUrl($reverseProxyUrl); goto C1a0b; D3297: $siteEntity->setUserPassword($siteUserPassword); goto F4281; Ea681: $errorMessages = $this->getConstraintViolationListErrorMessages($constraintViolationList); goto eb034; f500e: $vhostTemplate->addProcessor(new RedirectServerNameProcessor()); goto Ebbe7; Da747: $reversProxySiteCreator->reloadNginxService(); goto d105a; F4865: $siteEntity->setUser($siteUser); goto D3297; a82ec: $vhostTemplate = $vhostTemplateEntity->getTemplate(); goto Cb084; c6068: $vhostTemplate = new ReverseProxyVhostTemplate($reverseProxySite); goto daf2f; a1ef5: $siteEntity->setCertificate($certificateEntity); goto bb7ea; F4edf: c0351: goto Fc399; faf4a: $reverseProxySite->setUserPassword($siteEntity->getUserPassword()); goto e807a; cf62e: $selfSignedCertificate = Openssl::createSelfSignedCertificate($privateKey, $csr); goto ef178; Ebe35: $reversProxySiteCreator->createNginxVhost(); goto Da747; deeca: $siteEntity->setVhostTemplate($vhostTemplate); goto B5b41; E9cf8: $redirectionVhostTemplateFile = realpath(dirname(__FILE__) . "\x2f\x2e\x2e\57\x2e\x2e\x2f\x2e\x2e\57\162\x65\x73\157\165\162\143\145\163\57\156\147\151\x6e\x78\57\166\150\157\x73\164\x5f\164\x65\155\160\154\141\164\x65\57\x72\145\x64\x69\162\x65\x63\164"); goto cf6e5; E9f82: $certificateEntity = $this->certificateEntityManager->createEntity(); goto e96bc; a6e13: $distinguishedName = new DistinguishedName($domainName, $subjectAlternativeNames); goto ac34d; B2b59: $privateKey = $rsaKeyGenerator->generatePrivateKey(); goto Ae435; c6e69: $vhostTemplate->build(); goto f3b49; C4062: $subjectAlternativeNames[] = $registrableDomain; goto Ec71b; C8a44: $siteEntity->setDomainName($domainName); goto F4865; ed19f: $vhostTemplate = sprintf("\45\x73\45\163", $redirectionVhostTemplate, $vhostTemplate); goto Dcfed; fea50: $reverseProxySite->setCertificate($certificateEntity); goto dd744; ef178: $certificateEntity->setDefaultCertificate(true); goto facd2; C1a0b: $reverseProxySite->setVhostTemplate($siteEntity->getVhostTemplate()); goto B44f3; b7b0f: $certificateEntity->setPrivateKey($privateKey->getPEM()); goto C3486; ac34d: $csrGenerator = new CsrGenerator($privateKey, $distinguishedName); goto F5e90; c0da7: if (!count($siteConstraints)) { goto Af8d9; } goto a92fb; Dfe7d: $vhostTemplate->addProcessor(new ServerNameProcessor()); goto f500e; e96bc: $certificateEntity->setSite($siteEntity); goto c0b48; a92fb: $constraintViolationList = new ConstraintViolationList(); goto Cff6c; E576f: $subdomain = $resolvedDomainName->subDomain()->toString(); goto D7fca; C753e: $reverseProxySite->setSubdomain($subdomain); goto D2e8d; Cb2bc: if (!(true === is_null($subdomain) || "\167\x77\x77" == $subdomain)) { goto Fb684; } goto E9cf8; Dcfed: ce3ce: goto da250; c0b48: $rsaKeyGenerator = new RsaKeyGenerator(); goto B2b59; A7ef9: $vhostTemplateEntity = $this->getVhostTemplateEntity(self::REVERSE_PROXY_VHOST_TEMPLATE_NAME); goto a82ec; F4281: $siteEntity->setRootDirectory($domainName); goto a0710; D7fca: $subdomain = false === empty($subdomain) ? $subdomain : null; goto A7ef9; B1b94: $siteEntity->setType(SiteEntity::TYPE_REVERSE_PROXY); goto C8a44; Cff6c: $constraintViolationList->addAll($siteConstraints); goto Ea681; a0710: $siteEntity->setReverseProxyUrl($reverseProxyUrl); goto Cb2bc; eb034: throw new \Exception(implode("\x3b\40", $errorMessages)); goto e4e38; Aeb03: if (!(false === empty($redirectionVhostTemplate))) { goto ce3ce; } goto ed19f; b608a: $reversProxySiteCreator->createRootDirectory(); goto F1443; E26e8: $certificateEntity->setCsr($csr); goto b7b0f; B44f3: $reversProxySiteCreator = new ReverseProxySiteCreator($reverseProxySite); goto Ff196; F7d70: $reverseProxySite->setUser($siteEntity->getUser()); goto faf4a; d7108: $reversProxySiteCreator->createPrivateKeyAndCertificate(); goto Ebe35; B5b41: $siteConstraints = $this->validator->validate($siteEntity); goto c0da7; d4f01: $subjectAlternativeNames[] = sprintf("\x77\167\x77\x2e\x25\163", $domainName); goto F4edf; a56a8: $reverseProxySite->setRegistrableDomain($registrableDomain); goto C753e; cf6e5: $redirectionVhostTemplate = file_get_contents($redirectionVhostTemplateFile); goto Aeb03; Fc399: if (!(false === is_null($subdomain) && "\x77\x77\x77" == $subdomain)) { goto B90e0; } goto C4062; Ff196: $reversProxySiteCreator->createUser(); goto b608a; da250: Fb684: goto deeca; daf2f: $vhostTemplate->setContent($siteEntity->getVhostTemplate()); goto D6e36; f6d38: $registrableDomain = $resolvedDomainName->registrableDomain()->toString(); goto E576f; F5e90: $csr = $csrGenerator->generate(); goto cf62e; Ae435: $subjectAlternativeNames = []; goto A185b; e4e38: Af8d9: goto E9f82; d105a: $reversProxySiteCreator->resetPermissions(); goto c6068; e807a: $reverseProxySite->setDomainName($domainName); goto a56a8; C3486: $certificateEntity->setCertificate($selfSignedCertificate); goto a1ef5; facd2: $certificateEntity->setType(CertificateEntity::TYPE_SELF_SIGNED); goto E26e8; f3b49: $siteEntity->setVhostTemplate($vhostTemplate->getContent()); goto F2060; bb7ea: $reverseProxySite = new ReverseProxySite(); goto F7d70; D6e36: $vhostTemplate->resetProcessors(); goto Dfe7d; B48e2: $this->siteEntityManager->updateEntity($siteEntity); goto ac57f; D2e8d: $reverseProxySite->setRootDirectory($siteEntity->getRootDirectory()); goto fea50; A185b: if (!(true === is_null($subdomain))) { goto c0351; } goto d4f01; fc61b: } public function installedWordPressSite(Request $request) : Response { goto c102a; E1028: bdb1a: goto D2ba2; E92fa: $siteCredentials = $session->get("\x73\x69\x74\145\103\162\145\x64\x65\x6e\x74\x69\141\x6c\x73"); goto A372e; F87c6: return $response; goto Ec094; A372e: if (false === empty($siteCredentials)) { goto bdb1a; } goto e082d; e082d: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\x73\x69\164\x65\163")); goto Fd03c; Ec094: c9230: goto ffae5; cdad1: $response = $this->render("\106\162\x6f\x6e\164\145\156\x64\x2f\x53\151\x74\x65\57\116\x65\x77\57\167\157\162\144\160\x72\x65\x73\x73\55\151\156\163\164\141\154\x6c\145\144\56\150\x74\x6d\154\56\x74\167\x69\x67", ["\163\x69\164\145\x43\x72\145\x64\x65\x6e\x74\151\141\x6c\163" => $siteCredentials]); goto F87c6; ffae5: return $response; goto F8c78; Fd03c: goto c9230; goto E1028; c102a: $session = $request->getSession(); goto E92fa; D2ba2: $siteCredentials = $this->renderSiteCredentials($siteCredentials); goto cdad1; F8c78: } private function renderSiteCredentials(array $siteCredentials) : string { goto ff012; f67a3: B9a5d: goto a8f5a; ff012: $renderedCredentials = ''; goto bbea9; a8f5a: return $renderedCredentials; goto Bfe62; bbea9: foreach ($siteCredentials as $section => $sectionData) { goto ad468; f0032: $renderedCredentials .= "\55\55\55\x2d\x2d\55\x2d\x2d\55\55\55\55\55\x2d\55\55\x2d\x2d\55\55\55\x2d\x2d\x2d\x2d\55\x2d\55\x2d\55\55\x2d\55\x2d\x2d\x2d\55\55\x2d\x2d\x2d\55\x2d\x2d\x2d\x2d\x2d\55\55\55\55\55\55\55" . PHP_EOL; goto B662f; ad468: $renderedCredentials .= $section . PHP_EOL; goto f0032; F3e24: $renderedCredentials .= PHP_EOL; goto f9c1f; B662f: foreach ($sectionData as $key => $value) { $renderedCredentials .= sprintf("\x25\x73\x3a\40\x25\163", $key, $value) . PHP_EOL; b624b: } goto b178a; f9c1f: dcf85: goto Db7b3; b178a: Ddb6a: goto F3e24; Db7b3: } goto f67a3; Bfe62: } private function getVhostTemplateEntity(string $name) : mixed { goto d9c8d; b9bb8: return $vhostTemplateEntity; goto fa655; cd8b3: c7da3: goto b9bb8; Ac203: throw new \Exception($this->translator->trans("\x56\x68\x6f\163\x74\40\x54\x65\155\x70\154\x61\164\145\x20\x25\166\x68\157\x73\164\x54\145\155\x70\154\x61\x74\x65\x25\x20\144\x6f\145\163\x20\x6e\x6f\164\x20\145\x78\151\163\x74\x2e", ["\45\x76\x68\157\x73\164\x54\145\x6d\160\154\141\x74\145\45" => $name])); goto cd8b3; d9c8d: $vhostTemplateEntity = $this->vhostTemplateEntityManager->findOneByName($name); goto c34cb; c34cb: if (!(true === is_null($vhostTemplateEntity))) { goto c7da3; } goto Ac203; fa655: } private function getConstraintViolationListErrorMessages(ConstraintViolationList $constraintViolationList) : array { goto b49b3; D1427: return $errorMessages; goto Aab69; a2f99: foreach ($constraintViolationList as $constraint) { $errorMessages[] = sprintf("\45\x73\72\40\x25\x73", $constraint->getPropertyPath(), $constraint->getMessage()); bc83b: } goto F314f; b49b3: $errorMessages = []; goto a2f99; F314f: b2515: goto D1427; Aab69: } private function generateNameFromDomainName(string $domainName) : string { goto a1a7b; F89d2: if (!(false === empty($subdomain))) { goto Be1eb; } goto E1a76; F66b9: $name = $explodedRegistrableDomain[0] ?? ''; goto def27; a1a7b: $resolvedDomainName = $this->domainNameParser->resolveDomainName($domainName); goto A40dc; aed36: $name = $explodedRegistrableDomain[0] ?? ''; goto F89d2; def27: ee2d9: goto Afcac; f0aa8: if ("\x77\167\x77" == $subdomain) { goto D65b9; } goto aed36; A40dc: $registrableDomain = $resolvedDomainName->registrableDomain()->toString(); goto c2b9d; A754f: D65b9: goto F66b9; Df5cf: $name = sprintf("\45\x73\55\x25\x73", $explodedRegistrableDomain[0] ?? '', implode("\x2d", $explodedSubdomain)); goto Bdba3; E1a76: $explodedSubdomain = explode("\x2e", $subdomain); goto Df5cf; Bdba3: Be1eb: goto B132a; c2b9d: $subdomain = $resolvedDomainName->subDomain()->toString(); goto Ab311; Ab311: $explodedRegistrableDomain = explode("\56", $registrableDomain); goto f0aa8; B132a: goto ee2d9; goto A754f; Afcac: return $name; goto bc155; bc155: } private function getUniqueSiteUserName(string $siteUser) : string { goto ddc11; bb0ef: a4842: goto Fcff5; ddc11: $uniqueSiteUserName = $siteUser; goto e5f8e; f7d95: $uniqueSiteUserName = sprintf("\x25\x73\x2d\x73\151\x74\145", $uniqueSiteUserName); goto C5406; e5f8e: if (!(strlen($uniqueSiteUserName) <= 3)) { goto f35c2; } goto f7d95; a7c43: $i = 0; goto F3eb2; b3351: if (false === is_null($siteEntity)) { goto F6eaf; } goto e2ed6; C5406: f35c2: goto a7c43; a9683: fba67: goto a2ed2; b22f5: return $uniqueSiteUserName; goto d3e07; C9c0d: $i++; goto b3351; e2ed6: ecfb0: goto b22f5; eec76: $uniqueSiteUserName = sprintf("\x25\163\55\x25\163", $siteUser, $i); goto bb0ef; Fcff5: if (!(true === isset($uniqueSiteUserName[0]) && true === is_numeric($uniqueSiteUserName[0]))) { goto fba67; } goto C2f1a; C2f1a: $uniqueSiteUserName = sprintf("\143\154\160\55\x25\163", $uniqueSiteUserName); goto a9683; F3eb2: F6eaf: goto D0fd8; D0fd8: if (!(0 < $i)) { goto a4842; } goto eec76; a2ed2: $siteEntity = $this->siteEntityManager->findOneByUser($uniqueSiteUserName); goto C9c0d; d3e07: } private function getUniqueDatabaseName(string $databaseName) : string { goto ef97a; dc5a6: return $uniqueDatabaseName; goto E27c5; Beb5b: A7c2c: goto f36ce; C10b3: a5856: goto f8702; A10ad: $databaseConnection = new DatabaseConnection($activeDatabaseServerEntity); goto De724; d1387: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto A10ad; Faaa4: $uniqueDatabaseName = sprintf("\x25\163\x2d\x25\163", $databaseName, $i); goto Beb5b; C264d: $i = 0; goto d1387; f36ce: $databaseExists = in_array($uniqueDatabaseName, $databases); goto e51d4; f0416: if (!(strlen($uniqueDatabaseName) <= 3)) { goto C9359; } goto c3424; ef97a: $uniqueDatabaseName = $databaseName; goto f0416; B237f: f784c: goto dc5a6; D2750: if (true === $databaseExists) { goto a5856; } goto B237f; f8702: if (!(0 < $i)) { goto A7c2c; } goto Faaa4; c3424: $uniqueDatabaseName = sprintf("\45\x73\55\x64\x62", $uniqueDatabaseName); goto d8db8; d8db8: C9359: goto C264d; e51d4: $i++; goto D2750; De724: $databases = $databaseConnection->getDatabases(); goto C10b3; E27c5: } private function getUniqueDatabaseUserName(string $databaseUserName) : string { goto F93ab; Bf5e9: ae964: goto d41de; fdf40: if (!(0 < $i)) { goto F432b; } goto b5c89; F93ab: $uniqueDatabaseUserName = $databaseUserName; goto bde2d; D645a: $databaseUserEntity = $this->databaseUserEntityManager->findOneByUserName($uniqueDatabaseUserName); goto c7cfd; b5c89: $uniqueDatabaseUserName = sprintf("\45\x73\x2d\x25\x73", $databaseUserName, $i); goto c421b; bde2d: if (!(strlen($uniqueDatabaseUserName) <= 3)) { goto ae964; } goto e77fe; efd4f: if (false === is_null($databaseUserEntity)) { goto B0ab0; } goto Af4bf; c421b: F432b: goto D645a; Af4bf: ce95b: goto Cf155; e77fe: $uniqueDatabaseUserName = sprintf("\x25\x73\x2d\x64\142", $uniqueDatabaseUserName); goto Bf5e9; d41de: $i = 0; goto F205d; c7cfd: $i++; goto efd4f; F205d: B0ab0: goto fdf40; Cf155: return $uniqueDatabaseUserName; goto b8471; b8471: } private function hasPermissions() : bool { goto B4af1; B4af1: $user = $this->getUser(); goto Cfefe; e24bc: return true; goto ca4fe; d63da: return false; goto B90c0; Cfefe: if (!(UserEntity::ROLE_USER != $user->getRole())) { goto Fc2c4; } goto e24bc; ca4fe: Fc2c4: goto d63da; B90c0: } }
