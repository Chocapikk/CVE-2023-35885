<?php
 namespace App\Controller\Frontend; use Symfony\Component\Form\FormError; use Symfony\Component\HttpFoundation\Request; use Symfony\Component\HttpFoundation\Response; use Symfony\Component\HttpFoundation\RedirectResponse; use Symfony\Component\Form\Extension\Core\Type\ButtonType; use Symfony\Component\Form\Extension\Core\Type\SubmitType; use Symfony\Contracts\Translation\TranslatorInterface; use Symfony\Component\HttpFoundation\Cookie; use Symfony\Component\Form\Form; use Twig\Environment as Twig; use Doctrine\Common\Collections\ArrayCollection; use App\Controller\Controller; use App\Event\EventQueue; use App\Service\Crypto; use App\Service\Logger; use App\Site\Site; use App\Site\NodejsSite; use App\Site\StaticSite; use App\Site\PhpSite; use App\Site\PythonSite; use App\Site\ReverseProxySite; use App\Entity\Site as SiteEntity; use App\Entity\NodejsSettings; use App\Entity\PhpSettings; use App\Entity\PythonSettings; use App\Entity\BasicAuth as BasicAuthEntity; use App\Entity\BlockedBot as BlockedBotEntity; use App\Entity\BlockedIp as BlockedIpEntity; use App\Entity\Database as DatabaseEntity; use App\Entity\DatabaseUser as DatabaseUserEntity; use App\Entity\User as UserEntity; use App\Entity\Certificate as CertificateEntity; use App\Entity\CronJob as CronJobEntity; use App\Entity\FtpUser as FtpUserEntity; use App\Entity\SshUser as SshUserEntity; use App\Site\Updater as SiteUpdater; use App\Site\Updater\NodejsSite as NodejsSiteUpdater; use App\Site\Updater\StaticSite as StaticSiteUpdater; use App\Site\Updater\PhpSite as PhpSiteUpdater; use App\Site\Updater\PythonSite as PythonSiteUpdater; use App\Site\Updater\ReverseProxySite as ReverseProxySiteUpdater; use App\Site\Deleter as SiteDeleter; use App\Site\Deleter\NodejsSite as NodejsSiteDeleter; use App\Site\Deleter\StaticSite as StaticSiteDeleter; use App\Site\Deleter\PhpSite as PhpSiteDeleter; use App\Site\Deleter\PythonSite as PythonSiteDeleter; use App\Site\Deleter\ReverseProxySite as ReverseProxySiteDeleter; use App\Database\Manager as DatabaseManager; use App\Entity\Manager\ConfigManager; use App\Entity\Manager\SiteManager as SiteEntityManager; use App\Entity\Manager\BasicAuthManager as BasicAuthEntityManager; use App\Entity\Manager\BlockedIpManager as BlockedIpEntityManager; use App\Entity\Manager\BlockedBotManager as BlockedBotEntityManager; use App\Entity\Manager\CertificateManager as CertificateEntityManager; use App\Entity\Manager\CronJobManager as CronJobEntityManager; use App\Entity\Manager\DatabaseManager as DatabaseEntityManager; use App\Entity\Manager\DatabaseUserManager as DatabaseUserEntityManager; use App\Entity\Manager\DatabaseServerManager as DatabaseServerEntityManager; use App\Entity\Manager\NodejsSettingsManager as NodejsSettingsEntityManager; use App\Entity\Manager\FtpUserManager as FtpUserEntityManager; use App\Entity\Manager\SshUserManager as SshUserEntityManager; use App\Log\LogfileReader; use App\Log\LogsFinder; use App\Log\Parser\NginxAccessLogParser; use App\Log\Parser\NginxErrorLogParser; use App\Log\Parser\PhpFpmErrorLogParser; use App\Site\Parser\DomainName as DomainNameParser; use App\Site\Nginx\Exception\InvalidVhostException; use App\Site\Ssl\DistinguishedName; use App\Site\Ssl\Generator\RsaKeyGenerator; use App\Site\Ssl\Generator\CsrGenerator; use App\Site\Ssl\PrivateKey; use App\Site\Ssl\LetsEncryptClient; use App\Site\VarnishCache\Client as VarnishCacheClient; class SitesController extends Controller { private const FILE_MANAGER_COOKIE_EXPIRATION = 3; private ConfigManager $configManager; private SiteEntityManager $siteEntityManager; private BasicAuthEntityManager $basicAuthEntityManager; private BlockedIpEntityManager $blockedIpEntityManager; private BlockedBotEntityManager $blockedBotEntityManager; private CertificateEntityManager $certificateEntityManager; private CronJobEntityManager $cronJobEntityManager; private DatabaseEntityManager $databaseEntityManager; private DatabaseUserEntityManager $databaseUserEntityManager; private DatabaseServerEntityManager $databaseServerEntityManager; private NodejsSettingsEntityManager $nodejsSettingsEntityManager; private FtpUserEntityManager $ftpUserEntityManager; private SshUserEntityManager $sshUserEntityManager; private DomainNameParser $domainNameParser; public function __construct(ConfigManager $configManager, SiteEntityManager $siteEntityManager, BasicAuthEntityManager $basicAuthEntityManager, BlockedIpEntityManager $blockedIpEntityManager, BlockedBotEntityManager $blockedBotEntityManager, CertificateEntityManager $certificateEntityManager, CronJobEntityManager $cronJobEntityManager, DatabaseEntityManager $databaseEntityManager, DatabaseUserEntityManager $databaseUserEntityManager, DatabaseServerEntityManager $databaseServerEntityManager, NodejsSettingsEntityManager $nodejsSettingsEntityManager, FtpUserEntityManager $ftpUserEntityManager, SshUserEntityManager $sshUserEntityManager, DomainNameParser $domainNameParser, TranslatorInterface $translator, Logger $logger) { goto De7bd; C1025: $this->databaseServerEntityManager = $databaseServerEntityManager; goto Aa470; Aa470: $this->nodejsSettingsEntityManager = $nodejsSettingsEntityManager; goto d10a4; A780e: parent::__construct($translator, $logger); goto fb913; f7ba4: $this->basicAuthEntityManager = $basicAuthEntityManager; goto fa11f; fa11f: $this->blockedIpEntityManager = $blockedIpEntityManager; goto c88e3; F1fd1: $this->cronJobEntityManager = $cronJobEntityManager; goto f298b; B5c05: $this->sshUserEntityManager = $sshUserEntityManager; goto c2862; c88e3: $this->blockedBotEntityManager = $blockedBotEntityManager; goto Cdc4e; d10a4: $this->ftpUserEntityManager = $ftpUserEntityManager; goto B5c05; De7bd: $this->configManager = $configManager; goto cbd41; cbd41: $this->siteEntityManager = $siteEntityManager; goto f7ba4; f298b: $this->databaseEntityManager = $databaseEntityManager; goto dc3e7; Cdc4e: $this->certificateEntityManager = $certificateEntityManager; goto F1fd1; dc3e7: $this->databaseUserEntityManager = $databaseUserEntityManager; goto C1025; c2862: $this->domainNameParser = $domainNameParser; goto A780e; fb913: } public function index(Request $request) : Response { goto c6ff7; f2d9e: $response = $this->render("\106\162\x6f\x6e\164\145\x6e\144\57\123\151\x74\145\x2f\x69\156\x64\x65\x78\56\150\x74\x6d\154\x2e\164\x77\151\x67", ["\x75\163\145\162" => $user, "\163\151\x74\x65\163" => $sites]); goto b77e0; b77e0: return $response; goto F47c0; c6ff7: $user = $this->getUser(); goto C22e2; C22e2: $sites = $this->siteEntityManager->getUserSites($user, ["\x64\157\155\x61\151\x6e\116\x61\155\145" => "\141\163\143"]); goto f2d9e; F47c0: } public function fileManager(Request $request) : Response { goto f3f3b; e3bd6: $data = serialize($data); goto Ffc27; b4ca1: $response->headers->setCookie($cookie); goto e21b7; Ceddc: $locale = $request->getLocale(); goto c28a7; f6789: return $response; goto Dd728; Bd2b5: goto E7370; goto Ee043; F7a3e: $siteUser = $site->getUser(); goto Ceddc; Ee043: e87f1: goto F7a3e; D1c38: $encryptedData = trim(base64_encode($encryptedData)); goto b15ad; E5e1e: if (false === is_null($site)) { goto e87f1; } goto edfdd; b15ad: $cookie = new Cookie("\x63\154\160\55\x66\x6d", $encryptedData, $cookieExpirationDate); goto C91b7; c28a7: $cookieExpirationDate = new \DateTime("\156\157\x77"); goto b3329; c2dc7: $data = ["\165\163\x65\x72" => $siteUser, "\x6c\157\x63\141\154\x65" => $locale]; goto e3bd6; b3329: $cookieExpirationDate->modify(sprintf("\53\x25\163\40\x68\x6f\165\162\x73", self::FILE_MANAGER_COOKIE_EXPIRATION)); goto c2dc7; C91b7: $fileManagerUrl = sprintf("\45\x73\x2f\x66\151\x6c\x65\x2d\x6d\x61\x6e\x61\147\x65\162\57", rtrim($request->getSchemeAndHttpHost(), "\57")); goto cd7a8; e21b7: E7370: goto f6789; f3f3b: $site = $this->getSite($request); goto E5e1e; Ffc27: $encryptedData = Crypto::encrypt($data); goto D1c38; cd7a8: $response = $this->render("\x46\162\x6f\156\164\x65\x6e\144\57\123\151\164\145\57\x66\151\x6c\x65\x2d\x6d\141\156\x61\x67\x65\162\56\x68\x74\155\x6c\x2e\x74\x77\151\x67", ["\163\x69\x74\x65" => $site, "\146\x69\154\145\x4d\141\156\141\x67\145\x72\x55\x72\154" => $fileManagerUrl, "\x66\157\162\155\x45\x72\x72\157\162\163" => $this->formErrors]); goto b4ca1; edfdd: $response = $this->redirect($this->generateUrl("\x63\154\x70\x5f\163\151\164\145\x73")); goto Bd2b5; Dd728: } public function view(Request $request) : Response { goto c33cc; cc857: $response = $this->redirect($this->generateUrl("\x63\154\160\137\163\x69\x74\145\x5f\x73\145\x74\164\151\x6e\147\163", ["\x64\157\x6d\141\151\156\116\141\155\x65" => $domainName])); goto B7fe6; B7fe6: return $response; goto e9c10; c33cc: $domainName = $request->get("\x64\157\x6d\141\151\x6e\116\x61\155\x65"); goto cc857; e9c10: } public function logs(Request $request) : Response { goto B383c; B383c: $site = $this->getSite($request); goto F2aba; b4932: $form = $this->createLogsForm($siteEntity); goto B4e68; D0164: return $response; goto Ffd57; Ada1f: bd4d2: goto Bf62d; F2aba: if (false === is_null($site)) { goto bd4d2; } goto C3234; C3234: $response = $this->redirect($this->generateUrl("\143\x6c\160\x5f\x73\x69\x74\x65\x73")); goto D11c2; C23fe: a2936: goto D0164; B4e68: $response = $this->render("\106\162\x6f\x6e\x74\x65\156\x64\57\x53\151\164\x65\57\x6c\x6f\x67\163\x2e\150\164\155\x6c\56\164\x77\151\x67", ["\x73\x69\164\145" => $site, "\x66\157\162\x6d\x45\162\162\157\162\163" => $this->formErrors, "\146\x6f\x72\155" => $form->createView()]); goto C23fe; Bf62d: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto b4932; D11c2: goto a2936; goto Ada1f; Ffd57: } private function createLogsForm(SiteEntity $siteEntity) : Form { goto ecb7e; c61e7: return $form; goto D58ed; bd2be: $form->add("\165\160\x64\x61\x74\145", ButtonType::class, ["\x61\x74\x74\162" => ["\x63\x6c\x61\x73\163" => "\x62\x74\x6e\x20\x62\x74\x6e\55\154\x67\x20\x62\x74\x6e\55\142\x6c\165\x65\40\142\x74\156\55\x75\160\x64\x61\x74\x65"], "\x6c\x61\x62\145\154" => "\125\x70\x64\x61\164\x65"]); goto c61e7; ecb7e: $form = $this->createForm("\101\x70\x70\134\106\157\162\155\134\x53\151\164\x65\114\x6f\x67\x73\124\x79\x70\145", [], ["\x61\143\164\151\x6f\156" => $this->generateUrl("\143\154\x70\137\x73\x69\164\x65\137\154\x6f\147\x73", ["\x64\x6f\155\141\x69\156\x4e\x61\155\x65" => $siteEntity->getDomainName()]), "\x6d\145\164\x68\x6f\x64" => "\120\x4f\x53\x54", "\x61\164\x74\x72" => []]); goto bd2be; D58ed: } public function logFileContent(Request $request, Twig $twig) : Response { goto F498b; fb9b7: $logfileName = trim($request->get("\x6c\157\x67\106\x69\x6c\145")); goto A58c5; F498b: $data = []; goto C0876; b480f: Ef0c0: goto bd19f; e61dc: try { goto dd4a0; d6e3c: $logfileReader = new LogfileReader($logfile); goto c38c6; D623d: $logMessages = $phpFpmErrorLogParser->parse(); goto E629e; cecad: a3fef: goto Ea9be; D64b8: goto ede0c; goto c210c; c210c: Ad9a1: goto Dc574; b45ff: $logMessages = $nginxErrorLogParser->parse(); goto d0c1a; Ea9be: $data["\x6c\x6f\x67\x4d\145\x73\163\x61\x67\x65\x73\x48\x74\155\154"] = $logMessagesHtml; goto eb65f; e4055: $nginxErrorLogParser = new NginxErrorLogParser($logLines); goto b45ff; Cdca3: if (!("\x70\150\x70" == $service)) { goto a3fef; } goto F0764; bb26e: $logMessagesHtml = $twig->render("\x46\x72\157\156\x74\x65\156\144\57\123\151\164\145\x2f\114\x6f\147\163\x2f\156\x67\151\156\170\55\141\143\x63\x65\x73\x73\55\x6c\x6f\x67\55\x6d\145\163\x73\x61\x67\145\163\56\150\164\x6d\x6c\56\x74\167\151\x67", ["\x6c\x6f\x67\x4d\x65\163\163\x61\x67\145\x73" => $logMessages]); goto B7703; b161f: $logMessagesHtml = ''; goto C3ea4; F0764: $phpFpmErrorLogParser = new PhpFpmErrorLogParser($logLines); goto D623d; c38c6: $logLines = $logfileReader->getLines($numberOfLines); goto b161f; E629e: $logMessagesHtml = $twig->render("\106\162\x6f\x6e\164\x65\156\x64\57\123\x69\164\x65\x2f\114\157\147\x73\x2f\160\150\160\55\x66\160\x6d\55\x65\x72\x72\x6f\x72\x2d\x6c\157\147\55\x6d\145\163\163\x61\x67\145\163\x2e\x68\x74\x6d\x6c\x2e\164\167\151\x67", ["\154\157\x67\x4d\145\163\163\x61\147\145\163" => $logMessages]); goto cecad; Fe1ba: if ("\x61\143\143\x65\163\x73\x2e\x6c\x6f\147" == substr($logfileName, 0, 10)) { goto Ad9a1; } goto e4055; d0c1a: $logMessagesHtml = $twig->render("\106\162\157\x6e\x74\145\156\x64\x2f\x53\151\x74\145\57\x4c\157\147\163\57\156\147\x69\156\170\x2d\145\x72\162\157\x72\x2d\154\x6f\147\55\155\x65\163\x73\141\147\145\x73\56\x68\164\x6d\154\56\x74\x77\x69\x67", ["\x6c\157\147\x4d\x65\163\x73\x61\x67\145\163" => $logMessages]); goto D64b8; b6d7f: $nginxAccessLogParser->setTimezone($userTimezone->getName()); goto a1979; Dc574: $nginxAccessLogParser = new NginxAccessLogParser($logLines); goto b6d7f; B7703: ede0c: goto Ce862; C3ea4: $user = $this->getUser(); goto bf245; Ce862: C4cd4: goto Cdca3; dd4a0: $logfile = sprintf("\x2f\x68\157\x6d\145\57\45\163\x2f\x6c\x6f\147\x73\57\45\x73\57\45\x73", $site->getUser(), $service, $logfileName); goto d6e3c; Afae7: $userTimezone = $user->getTimezone(); goto Fe1ba; bf245: if (!("\x6e\x67\x69\x6e\x78" == $service)) { goto C4cd4; } goto Afae7; a1979: $logMessages = $nginxAccessLogParser->parse(); goto bb26e; eb65f: } catch (\Exception $e) { $this->logger->exception($e); } goto Aef9c; b7dd2: return $response; goto D6f65; Debdd: if (!(false === empty($service) && false === empty($logfileName))) { goto c66bf; } goto e61dc; bd19f: $response = $this->json($data); goto b7dd2; Aef9c: c66bf: goto b480f; Fd981: $service = trim($request->get("\x73\145\x72\166\151\143\145")); goto fb9b7; F0ebd: if (!(false === is_null($site))) { goto Ef0c0; } goto Fd981; C0876: $site = $this->getSite($request); goto F0ebd; A58c5: $numberOfLines = (int) $request->get("\x6e\x75\x6d\x62\145\x72\117\146\x4c\x69\156\145\163"); goto Debdd; D6f65: } public function loadLogfilesForService(Request $request) : Response { goto De18e; e393c: if (!(false === is_null($site))) { goto Af37d; } goto a1336; a1336: $service = trim($request->get("\x73\145\162\166\x69\143\145")); goto A618f; De18e: $data = []; goto C400c; a0131: Af37d: goto F966e; b73ad: try { goto c3990; adb32: aaca1: goto c149e; A8de5: $logsFinder = new LogsFinder($logfilesDirectory); goto d4a6a; C492c: if (!(false === empty($logfiles))) { goto aaca1; } goto aa63e; aa63e: $data["\x6c\157\x67\146\151\x6c\x65\x73"] = $logfiles; goto adb32; d4a6a: $logfiles = $logsFinder->getLogfiles(); goto C492c; c3990: $logfilesDirectory = sprintf("\57\150\157\155\x65\x2f\x25\x73\57\x6c\157\x67\163\x2f\x25\x73\57", $site->getUser(), $service); goto A8de5; c149e: } catch (\Exception $e) { $this->logger->exception($e); } goto c634d; f26cd: return $response; goto e4125; A618f: if (!(false === empty($service))) { goto d3c75; } goto b73ad; F966e: $response = $this->json($data); goto f26cd; c634d: d3c75: goto a0131; C400c: $site = $this->getSite($request); goto e393c; e4125: } public function cronJobs(Request $request) : Response { goto E58e2; d1836: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\x73\x69\x74\145\163")); goto A8974; c4349: c6501: goto D362a; E58e2: $site = $this->getSite($request); goto F311e; c2dcc: $response = $this->render("\x46\x72\157\156\x74\x65\156\144\x2f\x53\151\x74\x65\x2f\x63\162\157\156\55\x6a\157\142\x73\56\150\x74\x6d\x6c\x2e\x74\167\151\147", ["\163\x69\x74\145" => $site, "\x66\x6f\x72\x6d\105\x72\x72\157\x72\x73" => $this->formErrors]); goto c4349; D362a: return $response; goto ebc77; a4a01: d1307: goto c2dcc; F311e: if (false === is_null($site)) { goto d1307; } goto d1836; A8974: goto c6501; goto a4a01; ebc77: } public function newCronJob(Request $request) : Response { goto F305a; F305a: $site = $this->getSite($request); goto c1b21; c1b21: if (false === is_null($site)) { goto f0984; } goto ac680; F14fe: f0984: goto C50f7; f39ee: goto db29b; goto F14fe; C50f7: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto A429e; B9037: return $response; goto E874d; f282c: $cronJobEntity->setSite($siteEntity); goto Db2f4; A429e: $cronJobEntity = $this->cronJobEntityManager->createEntity(); goto f282c; bbefb: $response = $this->render("\106\x72\157\x6e\x74\x65\x6e\144\57\123\x69\x74\145\x2f\156\x65\167\x2d\143\162\157\x6e\x2d\152\157\x62\56\x68\x74\x6d\x6c\56\x74\167\x69\x67", ["\163\151\x74\x65" => $site, "\146\157\x72\155" => $form->createView(), "\146\x6f\162\x6d\105\x72\x72\x6f\162\163" => $this->formErrors]); goto Ede2a; E874d: Dc10b: goto cfb66; ac680: $response = $this->redirect($this->generateUrl("\x63\154\160\x5f\x73\x69\x74\x65\x73")); goto f39ee; Bfd4f: if (!(true === $form->isSubmitted())) { goto f5219; } goto F0e26; Db2f4: $form = $this->createCronJobForm($cronJobEntity); goto e435a; D9173: a2f67: goto bbefb; F0e26: $response = $this->handleCronJobForm($request, $form, $site); goto b6f14; ca6fc: $form->handleRequest($request); goto Bfd4f; e435a: if (!(true === $request->isMethod("\120\x4f\123\124"))) { goto a2f67; } goto ca6fc; cfb66: f5219: goto D9173; Ede2a: db29b: goto f3520; b6f14: if (!(false === is_null($response))) { goto Dc10b; } goto B9037; f3520: return $response; goto cb555; cb555: } private function createCronJobForm(CronJobEntity $cronJobEntity) : Form { goto D1237; B97c0: $form = $this->createForm("\x41\160\x70\x5c\x46\157\162\x6d\x5c\x53\x69\x74\x65\103\162\157\x6e\x4a\157\x62\x54\x79\160\145", $cronJobEntity, ["\x61\143\164\151\157\x6e" => $this->generateUrl("\143\x6c\160\137\x73\x69\x74\145\137\x63\x72\157\x6e\x5f\152\x6f\x62\137\x6e\x65\x77", ["\x64\157\155\141\151\x6e\116\141\x6d\x65" => $siteEntity->getDomainName()]), "\x6d\x65\x74\x68\x6f\144" => "\x50\x4f\123\x54", "\x61\164\x74\162" => []]); goto b3707; b3707: $form->add("\163\165\x62\155\x69\164", SubmitType::class, ["\141\x74\x74\162" => ["\143\154\x61\163\163" => "\x62\164\x6e\x20\142\164\156\x2d\142\154\165\x65\40\x62\x74\156\x2d\154\147"], "\x6c\141\142\145\154" => "\x41\x64\144\40\103\162\x6f\156\x20\x4a\x6f\x62"]); goto fbdbf; D1237: $siteEntity = $cronJobEntity->getSite(); goto B97c0; fbdbf: return $form; goto B06f4; B06f4: } private function handleCronJobForm(Request $request, Form $form, Site $site) { goto a0f54; B8369: cda2c: goto C2e3f; Ba4c2: $this->formErrors = $this->getErrorMessages($form); goto F960d; d19a1: Bc5fa: goto a62cd; C2e3f: try { goto D65c1; ac634: $domainName = $site->getDomainName(); goto c2bc1; db578: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\163\151\164\x65\163")); goto B3d7b; F9ecc: Ab6d8: goto b9984; B7fcc: $siteUpdater = $this->getSiteUpdater($site); goto a3ee8; c277b: $site->setCronJobs($siteEntity->getCronJobs()); goto c395f; b9984: $user = $this->getUser(); goto d5740; a3ee8: $siteUpdater->updateUserCrontab(); goto b2970; bdc53: $session->getFlashBag()->set("\x73\x75\143\x63\x65\163\x73", $this->translator->trans("\103\x72\x6f\156\40\x4a\157\x62\40\150\141\163\40\x62\x65\145\x6e\40\141\144\x64\x65\144\56")); goto Bee13; B3d7b: goto A682e; goto F9ecc; F535c: if (false === is_null($siteEntity)) { goto Ab6d8; } goto db578; B8eb2: $siteEntity->addCronJob($cronJobEntity); goto c277b; b2970: $eventData = ["\163\x69\x74\145" => $domainName, "\143\x72\157\x6e\x74\x61\142\105\x78\160\162\x65\x73\x73\151\157\x6e" => $cronJobEntity->getCrontabExpression()]; goto A1d0e; Bee13: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\137\x73\151\x74\145\137\143\162\x6f\x6e\x5f\152\x6f\x62\x73", ["\144\157\x6d\141\x69\156\x4e\141\155\x65" => $site->getDomainName()])); goto e7292; c395f: $this->siteEntityManager->updateEntity($siteEntity); goto B7fcc; D65c1: $session = $request->getSession(); goto ac634; A1d0e: EventQueue::addEvent(EventQueue::EVENT_SITE_CRON_JOB_ADD, $user, $eventData, $request); goto bdc53; e7292: A682e: goto be607; c2bc1: $siteEntity = $this->getSiteEntity($domainName); goto F535c; be607: return $response; goto ade47; d5740: $cronJobEntity = $form->getData(); goto B8eb2; ade47: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\156\147\145\x72", $this->translator->trans("\x41\x6e\40\x65\x72\162\157\x72\x20\x68\x61\x73\x20\157\x63\x63\x75\x72\162\145\144\54\40\145\162\x72\157\x72\x20\155\145\163\163\141\x67\145\x3a\40\x25\145\x72\162\157\x72\115\145\163\163\x61\147\x65\x25", ["\x25\x65\x72\x72\x6f\162\x4d\145\163\163\x61\147\x65\x25" => $e->getMessage()])); } goto d19a1; F960d: goto Bc5fa; goto B8369; a0f54: if (true === $form->isValid()) { goto cda2c; } goto Ba4c2; a62cd: } public function deleteCronJob(Request $request) : Response { goto b6a33; C6456: if (!(false === is_null($site))) { goto B8c13; } goto Ec3ab; F92e4: B8c13: goto De90f; b6a33: $site = $this->getSite($request); goto C6456; Ec3ab: try { goto Abe5d; F0a92: $domainName = $site->getDomainName(); goto Fbea4; Df17f: $this->siteEntityManager->updateEntity($siteEntity); goto faa4a; cd850: $id = (int) $request->get("\x69\x64"); goto F0a92; Ee21c: $siteUpdater->updateUserCrontab(); goto C20e6; B3f78: if (!(false === is_null($siteEntity) && false === is_null($cronJobEntity))) { goto B1010; } goto b3942; c4a60: return $response; goto F8d3b; b3942: $cronJobSiteEntity = $cronJobEntity->getSite(); goto B3020; c6231: $user = $this->getUser(); goto f2306; D0b4b: $cronJobEntity = $this->cronJobEntityManager->findOneById($id); goto B3f78; C20e6: $evenData = ["\163\151\164\145" => $domainName, "\143\157\x6d\x6d\141\x6e\x64" => $cronJobEntity->getCommand()]; goto D4747; Fbea4: $siteEntity = $this->getSiteEntity($domainName); goto D0b4b; Fd239: $site->setCronJobs($siteEntity->getCronJobs()); goto Df17f; Abe5d: $session = $request->getSession(); goto cd850; f2306: $siteEntity->removeCronJob($cronJobEntity); goto Fd239; A1be5: $response = $this->redirect($this->generateUrl("\143\x6c\x70\137\163\151\x74\145\x5f\x63\162\157\x6e\x5f\152\x6f\x62\x73", ["\x64\157\x6d\141\151\x6e\116\x61\x6d\x65" => $site->getDomainName()])); goto c4a60; F8d3b: f8d6a: goto Cf06c; Cf06c: B1010: goto Fc358; D4747: EventQueue::addEvent(EventQueue::EVENT_SITE_CRON_JOB_DELETE, $user, $evenData, $request); goto F9f7d; F9f7d: $session->getFlashBag()->set("\163\165\143\143\x65\x73\x73", $this->translator->trans("\x43\162\x6f\156\40\112\x6f\x62\x20\150\141\x73\40\x62\145\x65\x6e\x20\x64\145\154\x65\164\145\144\x2e")); goto A1be5; faa4a: $siteUpdater = $this->getSiteUpdater($site); goto Ee21c; B3020: if (!($siteEntity->getDomainName() == $cronJobSiteEntity->getDomainName())) { goto f8d6a; } goto c6231; Fc358: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\x6e\x67\x65\x72", $this->translator->trans("\x41\x6e\x20\145\x72\x72\x6f\162\40\x68\141\163\40\x6f\x63\x63\x75\162\162\x65\144\54\x20\145\x72\x72\157\x72\40\x6d\145\163\163\141\147\x65\x3a\40\x25\x65\x72\162\x6f\162\x4d\145\x73\163\x61\x67\145\x25", ["\45\x65\x72\162\157\x72\x4d\145\x73\x73\x61\x67\x65\45" => $e->getMessage()])); } goto F92e4; De90f: $response = $this->redirect($this->generateUrl("\143\154\x70\137\x73\x69\164\145\x73")); goto Fcfbe; Fcfbe: return $response; goto a2190; a2190: } public function editCronJob(Request $request) : Response { goto F9fa4; D8ab5: $response = $this->handleCronJobEditForm($request, $form, $site); goto C78e4; A93a6: $response = $this->redirect($this->generateUrl("\143\154\160\137\x73\151\164\145\163")); goto Ff5b7; Bd134: if (false === is_null($cronJobEntity) && false === is_null($site) && $cronJobEntity->getSite()->getDomainName() == $site->getDomainName()) { goto dc30a; } goto A93a6; C78e4: if (!(false === is_null($response))) { goto D3636; } goto F6755; B48d2: dc30a: goto fa12b; F9fa4: $id = (int) $request->get("\151\x64"); goto A1f19; F6755: return $response; goto Af9f6; Ff5b7: goto F1b08; goto B48d2; Dc4dc: F1b08: goto dfe23; c2213: $form->handleRequest($request); goto Ed623; Af9f6: D3636: goto B53cd; a2c1a: $cronJobEntity = $this->cronJobEntityManager->findOneById($id); goto Bd134; B53cd: C1239: goto be5ad; fa12b: $form = $this->createCronJobEditForm($cronJobEntity); goto d0268; A1f19: $site = $this->getSite($request); goto a2c1a; d0268: if (!(true === $request->isMethod("\x50\x4f\x53\x54"))) { goto Cc2e0; } goto c2213; b4377: $response = $this->render("\106\x72\x6f\156\164\x65\156\144\x2f\123\x69\164\x65\57\x65\144\x69\164\x2d\143\162\157\x6e\55\x6a\157\x62\56\x68\x74\x6d\x6c\x2e\x74\x77\151\147", ["\163\151\164\x65" => $site, "\146\x6f\x72\155" => $form->createView(), "\146\x6f\x72\x6d\x45\x72\162\157\x72\163" => $this->formErrors]); goto Dc4dc; Ed623: if (!(true === $form->isSubmitted())) { goto C1239; } goto D8ab5; be5ad: Cc2e0: goto b4377; dfe23: return $response; goto D96e7; D96e7: } private function createCronJobEditForm(CronJobEntity $cronJobEntity) : Form { goto Fd08f; e67b0: $form = $this->createForm("\x41\160\x70\134\x46\157\x72\x6d\134\x53\151\x74\x65\x43\x72\x6f\x6e\x4a\x6f\142\x45\x64\151\x74\x54\171\x70\x65", $cronJobEntity, ["\141\143\164\151\x6f\156" => $this->generateUrl("\143\154\160\137\x73\151\x74\x65\137\143\x72\x6f\156\x5f\152\x6f\x62\137\x65\x64\151\x74", ["\x64\x6f\155\141\x69\156\x4e\x61\x6d\x65" => $siteEntity->getDomainName(), "\x69\144" => $cronJobEntity->getId()]), "\155\x65\x74\150\x6f\144" => "\120\117\123\x54", "\x61\164\164\x72" => []]); goto Dd1fb; Fd08f: $siteEntity = $cronJobEntity->getSite(); goto e67b0; Dd1fb: $form->add("\163\165\x62\155\151\x74", SubmitType::class, ["\x61\164\x74\162" => ["\x63\154\x61\163\163" => "\142\164\156\x20\142\164\156\x2d\x62\154\165\x65\x20\142\164\156\55\x6c\x67"], "\154\x61\x62\x65\154" => "\x53\x61\x76\145"]); goto db826; db826: return $form; goto c8105; c8105: } private function handleCronJobEditForm(Request $request, Form $form, Site $site) { goto d60d7; Fa992: goto B0c1d; goto cede8; d60d7: if (true === $form->isValid()) { goto ad122; } goto fbdab; cede8: ad122: goto De52b; fbdab: $this->formErrors = $this->getErrorMessages($form); goto Fa992; A6111: B0c1d: goto e6fa8; De52b: try { goto Bdfda; B692d: c1e16: goto Cd2bc; Cd2bc: return $response; goto C9d00; D594b: $siteEntity = $this->getSiteEntity($domainName); goto dcbef; efa97: $site->setCronJobs($siteEntity->getCronJobs()); goto e8233; bbbe7: $user = $this->getUser(); goto F253e; dcbef: if (false === is_null($siteEntity)) { goto b94ab; } goto D331f; F253e: $cronJobEntity = $form->getData(); goto Bc3a3; baa76: $session->getFlashBag()->set("\163\165\x63\143\145\x73\163", $this->translator->trans("\x43\x72\157\156\x20\112\x6f\x62\40\150\x61\x73\x20\x62\145\x65\x6e\40\x73\141\x76\x65\144\56")); goto B0371; Bdfda: $session = $request->getSession(); goto Fd290; A196d: EventQueue::addEvent(EventQueue::EVENT_SITE_CRON_JOB_EDIT, $user, $eventData, $request); goto baa76; Bc3a3: $siteEntity->addCronJob($cronJobEntity); goto efa97; B0371: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\x73\151\x74\145\x5f\143\x72\157\x6e\137\152\x6f\x62\x73", ["\x64\x6f\155\141\151\156\x4e\x61\155\145" => $site->getDomainName()])); goto B692d; bda04: goto c1e16; goto Ffabb; Ffabb: b94ab: goto bbbe7; Bd2b8: $siteUpdater = $this->getSiteUpdater($site); goto F4287; e8233: $this->siteEntityManager->updateEntity($siteEntity); goto Bd2b8; Fd290: $domainName = $site->getDomainName(); goto D594b; F4287: $siteUpdater->updateUserCrontab(); goto F5dd0; D331f: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\163\151\164\x65\163")); goto bda04; F5dd0: $eventData = ["\x73\151\164\x65" => $domainName, "\143\162\157\156\164\141\142\105\170\x70\x72\145\x73\163\151\x6f\156" => $cronJobEntity->getCrontabExpression()]; goto A196d; C9d00: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\x61\x6e\x67\145\x72", $this->translator->trans("\x41\156\40\x65\162\x72\x6f\162\40\x68\x61\163\40\x6f\143\x63\165\x72\x72\145\144\54\x20\145\162\162\157\x72\40\x6d\x65\163\163\x61\x67\x65\x3a\x20\45\145\x72\162\157\x72\x4d\x65\x73\x73\141\x67\145\x25", ["\45\145\162\162\x6f\x72\x4d\145\x73\x73\x61\147\x65\x25" => $e->getMessage()])); } goto A6111; e6fa8: } public function users(Request $request) : Response { goto ccf2b; c00c8: $response = $this->render("\106\x72\157\156\x74\145\156\144\x2f\x53\151\164\x65\57\x75\x73\x65\x72\163\x2e\x68\x74\x6d\154\x2e\x74\167\151\147", ["\163\151\x74\x65" => $site, "\146\157\162\155\x45\x72\x72\157\162\163" => $this->formErrors]); goto cb46e; a3cd5: if (false === is_null($site)) { goto F3cf1; } goto C23e1; Ecc14: F3cf1: goto c00c8; acf1f: return $response; goto Ef32c; C23e1: $response = $this->redirect($this->generateUrl("\x63\154\x70\137\163\151\164\x65\x73")); goto c590c; cb46e: db3d7: goto acf1f; c590c: goto db3d7; goto Ecc14; ccf2b: $site = $this->getSite($request); goto a3cd5; Ef32c: } public function newFtpUser(Request $request) : Response { goto E2a71; Bb4fa: if (false === is_null($site)) { goto a94bd; } goto a3b83; cc820: $response = $this->handleFtpUserForm($request, $form, $site); goto D6871; Ff752: return $response; goto a9c13; d9887: $ftpUserEntity->setSite($siteEntity); goto dcd95; cd85a: Ccacb: goto A5bac; f418b: $form->handleRequest($request); goto B9505; Fbfe9: goto f213e; goto e38c5; A3272: $ftpUserEntity = $this->ftpUserEntityManager->createEntity(); goto d9887; D6871: if (!(false === is_null($response))) { goto B3bd0; } goto Ff752; f7ac5: return $response; goto d9912; Bff84: f213e: goto f7ac5; E2a71: $site = $this->getSite($request); goto Bb4fa; a3b83: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\137\x73\151\x74\x65\x73")); goto Fbfe9; c3707: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto A3272; D0129: if (!(true === $request->isMethod("\120\117\x53\x54"))) { goto Efe86; } goto f418b; e38c5: a94bd: goto c3707; B0569: $response = $this->render("\106\x72\x6f\x6e\x74\145\156\144\57\123\151\164\x65\57\x6e\x65\x77\x2d\146\164\x70\55\165\x73\145\162\x2e\150\164\x6d\154\56\164\x77\151\x67", ["\x73\151\164\145" => $site, "\146\157\162\155" => $form->createView(), "\146\157\x72\155\x45\162\x72\x6f\162\163" => $this->formErrors]); goto Bff84; dcd95: $form = $this->createFtpUserForm($ftpUserEntity); goto D0129; a9c13: B3bd0: goto cd85a; B9505: if (!(true === $form->isSubmitted())) { goto Ccacb; } goto cc820; A5bac: Efe86: goto B0569; d9912: } private function createFtpUserForm(FtpUserEntity $ftpUserEntity) : Form { goto Ffbb3; A6ca1: return $form; goto C2fd0; cbf9d: $form = $this->createForm("\101\x70\160\x5c\106\157\162\x6d\134\x53\151\x74\x65\x46\164\x70\125\x73\x65\162\x54\171\160\x65", $ftpUserEntity, ["\x61\x63\164\x69\x6f\156" => $this->generateUrl("\143\154\x70\137\x73\151\164\145\137\146\164\x70\137\165\163\x65\x72\137\x6e\145\167", ["\x64\x6f\155\141\151\x6e\116\141\x6d\145" => $siteEntity->getDomainName()]), "\155\x65\x74\x68\157\x64" => "\x50\x4f\123\124", "\141\x74\x74\x72" => []]); goto C11ed; Ffbb3: $siteEntity = $ftpUserEntity->getSite(); goto cbf9d; C11ed: $form->add("\x73\165\142\155\x69\x74", SubmitType::class, ["\x61\x74\x74\x72" => ["\x63\x6c\x61\x73\163" => "\142\x74\156\x20\x62\x74\x6e\55\x62\x6c\x75\x65\40\142\x74\x6e\55\154\147"], "\x6c\141\x62\145\x6c" => "\x41\x64\x64\x20\x55\x73\x65\162"]); goto A6ca1; C2fd0: } private function handleFtpUserForm(Request $request, Form $form, Site $site) { goto d2630; D56ea: try { goto C7cc5; De8f2: ae735: goto f5a4e; d31ca: return $response; goto D3ae8; b22a4: $eventData = ["\163\x69\164\145" => $domainName, "\x75\x73\x65\x72\116\141\155\145" => $ftpUserName, "\150\x6f\155\145\104\151\x72\145\x63\164\x6f\x72\x79" => $ftpUserEntity->getHomeDirectory()]; goto e6dd2; F6bbd: $siteUpdater = $this->getSiteUpdater($site); goto A1385; Eb40b: $ftpUserName = $ftpUserEntity->getUserName(); goto cf431; C7cc5: $session = $request->getSession(); goto a575d; A200c: goto a43e2; goto De8f2; Bf1f1: $response = $this->redirect($this->generateUrl("\143\154\x70\137\x73\151\x74\x65\x73")); goto A200c; cf431: $ftpUserPassword = $form->get("\x70\x61\163\x73\167\x6f\x72\x64")->getData(); goto f36ff; f36ff: $ftpUserEntity->setPassword($ftpUserPassword); goto ed6cb; B4fa8: $ftpUserEntity = $form->getData(); goto Eb40b; e6dd2: EventQueue::addEvent(EventQueue::EVENT_SITE_FTP_USER_ADD, $user, $eventData, $request); goto Cf74d; Cf74d: $session->getFlashBag()->set("\163\165\143\143\x65\163\x73", $this->translator->trans("\125\163\145\x72\x20\x68\x61\163\x20\x62\145\145\156\40\x61\x64\144\145\144\x2e")); goto dd119; b96c1: $siteEntity = $this->getSiteEntity($domainName); goto Fa6be; ed6cb: $siteEntity->addFtpUser($ftpUserEntity); goto a0bd9; a0bd9: $this->siteEntityManager->updateEntity($siteEntity); goto F6bbd; a575d: $domainName = $site->getDomainName(); goto b96c1; Fa6be: if (false === is_null($siteEntity)) { goto ae735; } goto Bf1f1; f5a4e: $user = $this->getUser(); goto B4fa8; A1385: $siteUpdater->createFtpUser($ftpUserEntity); goto b22a4; F484f: a43e2: goto d31ca; dd119: $response = $this->redirect($this->generateUrl("\x63\154\x70\x5f\x73\x69\x74\145\x5f\165\x73\145\x72\x73", ["\x64\x6f\155\x61\x69\156\x4e\x61\x6d\145" => $site->getDomainName()])); goto F484f; D3ae8: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\156\147\145\x72", $this->translator->trans("\x41\156\x20\x65\x72\x72\157\162\x20\150\x61\x73\40\157\143\x63\x75\x72\162\145\144\54\x20\x65\162\x72\x6f\162\40\x6d\x65\x73\163\141\147\145\x3a\x20\x25\145\162\x72\157\x72\x4d\x65\163\163\x61\147\145\45", ["\45\x65\162\162\x6f\x72\115\145\163\x73\x61\147\145\45" => $e->getMessage()])); } goto fef4b; C7b9f: $this->formErrors = $this->getErrorMessages($form); goto c1db4; c1db4: goto f1e7f; goto Ee96f; d2630: if (true === $form->isValid()) { goto ae8c6; } goto C7b9f; fef4b: f1e7f: goto e2bec; Ee96f: ae8c6: goto D56ea; e2bec: } public function editFtpUser(Request $request) : Response { goto Bb813; F79ba: goto E888c; goto Cfaa7; d063c: $site = $this->getSite($request); goto bb372; Cfaa7: e5aa4: goto abd22; cb9ed: $form->handleRequest($request); goto B8bbc; B8bbc: if (!(true === $form->isSubmitted())) { goto e4007; } goto e983c; f2bd7: a5938: goto eeb92; e0a18: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\163\151\x74\145\163")); goto F79ba; ea7f2: if (!(true === $request->isMethod("\120\x4f\x53\x54"))) { goto a5938; } goto cb9ed; e983c: $response = $this->handleFtpUserEditForm($request, $form, $site); goto A8fe8; cb5a6: return $response; goto F3bed; Fd9d4: if (false === is_null($ftpUserEntity) && false === is_null($site) && $ftpUserEntity->getSite()->getDomainName() == $site->getDomainName()) { goto e5aa4; } goto e0a18; Cb2ea: E888c: goto cb5a6; abd22: $form = $this->createFtpUserEditForm($ftpUserEntity); goto ea7f2; Cc9b6: e4007: goto f2bd7; eeb92: $response = $this->render("\106\162\157\x6e\x74\x65\156\x64\x2f\123\151\x74\145\57\x65\x64\x69\164\x2d\x66\164\160\x2d\x75\163\145\162\56\x68\x74\x6d\154\56\164\x77\x69\x67", ["\x73\151\164\x65" => $site, "\146\157\x72\155" => $form->createView(), "\146\157\x72\155\105\x72\162\157\162\163" => $this->formErrors]); goto Cb2ea; bb372: $ftpUserEntity = $this->ftpUserEntityManager->findOneByUserName($userName); goto Fd9d4; B5fdb: a21c4: goto Cc9b6; Bb813: $userName = $request->get("\x75\163\x65\162\x4e\141\x6d\x65"); goto d063c; A8fe8: if (!(false === is_null($response))) { goto a21c4; } goto C81ae; C81ae: return $response; goto B5fdb; F3bed: } private function createFtpUserEditForm(FtpUserEntity $ftpUserEntity) : Form { goto F3713; F3713: $siteEntity = $ftpUserEntity->getSite(); goto Af647; E01f9: $form->add("\163\165\142\155\x69\164", SubmitType::class, ["\141\x74\x74\162" => ["\x63\154\x61\163\163" => "\142\164\x6e\x20\142\164\156\x2d\x62\154\165\x65\x20\x62\164\x6e\x2d\x6c\x67"], "\154\x61\142\x65\x6c" => "\123\141\x76\145"]); goto F18e0; F18e0: return $form; goto A7973; Af647: $form = $this->createForm("\x41\160\x70\x5c\106\157\162\155\x5c\x53\x69\x74\145\106\164\160\125\163\145\x72\105\144\x69\x74\124\171\160\x65", $ftpUserEntity, ["\x61\x63\164\151\x6f\156" => $this->generateUrl("\x63\154\160\137\x73\x69\x74\145\x5f\x66\164\160\x5f\165\163\x65\x72\137\x65\144\151\164", ["\144\157\x6d\141\x69\156\x4e\141\x6d\145" => $siteEntity->getDomainName(), "\x75\x73\145\x72\x4e\x61\x6d\x65" => $ftpUserEntity->getUserName()]), "\x6d\x65\x74\x68\x6f\x64" => "\x50\117\x53\124", "\141\x74\x74\x72" => []]); goto E01f9; A7973: } private function handleFtpUserEditForm(Request $request, Form $form, Site $site) { goto F7f60; d0f77: goto E0659; goto Ad941; B0e23: try { goto a7418; b0ab7: D3018: goto c2aa6; d87f2: $response = $this->redirect($this->generateUrl("\x63\154\x70\137\163\151\164\x65\x5f\165\x73\145\x72\x73", ["\x64\x6f\x6d\141\151\x6e\x4e\x61\x6d\145" => $site->getDomainName()])); goto b0ab7; a7418: $session = $request->getSession(); goto F6d7b; c3925: $ftpUserHomeDirectory = $ftpUserEntity->getHomeDirectory(); goto B7a22; B7a22: $this->siteEntityManager->updateEntity($siteEntity); goto d4e0a; B5d7a: $eventData = ["\x73\x69\164\145" => $domainName, "\x75\163\x65\162\116\x61\155\145" => $ftpUserName, "\150\157\x6d\145\x44\x69\162\x65\143\164\x6f\x72\x79" => $ftpUserHomeDirectory]; goto C246a; C26ff: $siteUpdater->changeUserPassword($ftpUserName, $ftpUserPassword); goto c49ee; d4e0a: $siteUpdater = $this->getSiteUpdater($site); goto E6d2e; F67d3: if (!(false === empty($ftpUserPassword))) { goto Aa996; } goto C26ff; F6d7b: $domainName = $site->getDomainName(); goto C4adb; C246a: EventQueue::addEvent(EventQueue::EVENT_SITE_FTP_USER_EDIT, $user, $eventData, $request); goto e057d; b91b7: $user = $this->getUser(); goto Ff664; b06ab: $ftpUserPassword = $form->get("\160\x61\x73\163\167\x6f\x72\x64")->getData(); goto c3925; Ae5b1: ba717: goto b91b7; Ff664: $ftpUserEntity = $form->getData(); goto Ca42a; e057d: $session->getFlashBag()->set("\x73\165\143\x63\145\x73\163", $this->translator->trans("\x55\163\x65\x72\40\150\x61\x73\40\142\145\145\x6e\x20\x73\x61\x76\x65\144\x2e")); goto d87f2; a756e: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\x73\151\x74\x65\x73")); goto b396e; Ca42a: $ftpUserName = $ftpUserEntity->getUserName(); goto b06ab; b396e: goto D3018; goto Ae5b1; c49ee: Aa996: goto B5d7a; E6d2e: $siteUpdater->changeUserHomeDirectory($ftpUserName, $ftpUserHomeDirectory); goto F67d3; bb619: if (false === is_null($siteEntity)) { goto ba717; } goto a756e; C4adb: $siteEntity = $this->getSiteEntity($domainName); goto bb619; c2aa6: return $response; goto Fbe1d; Fbe1d: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\x6e\147\145\162", $this->translator->trans("\x41\156\x20\145\x72\x72\x6f\x72\x20\x68\x61\x73\40\157\143\143\x75\x72\162\145\x64\x2c\x20\145\x72\x72\x6f\162\x20\x6d\x65\x73\163\141\x67\145\x3a\40\45\145\x72\162\157\x72\x4d\x65\163\x73\x61\147\x65\45", ["\x25\145\x72\162\157\162\x4d\x65\x73\163\141\x67\145\x25" => $e->getMessage()])); } goto Ca036; F7f60: if (true === $form->isValid()) { goto b83b5; } goto f3f40; Ca036: E0659: goto Fdf1a; f3f40: $this->formErrors = $this->getErrorMessages($form); goto d0f77; Ad941: b83b5: goto B0e23; Fdf1a: } public function deleteFtpUser(Request $request) : Response { goto cf8c1; Aec14: try { goto ad2a8; f00b5: $domainName = $site->getDomainName(); goto fb783; af47a: $userName = $request->get("\x75\163\145\162\x4e\141\x6d\145"); goto f00b5; b2a3e: $session->getFlashBag()->set("\x73\x75\143\143\x65\163\x73", $this->translator->trans("\x55\163\145\x72\40\150\141\163\x20\x62\145\x65\156\x20\144\145\154\145\x74\x65\x64\56")); goto Cad05; d28e6: return $response; goto Dcefb; Cad05: $response = $this->redirect($this->generateUrl("\143\154\160\137\163\x69\x74\145\137\165\x73\145\162\163", ["\144\x6f\x6d\141\151\x6e\x4e\141\155\145" => $site->getDomainName()])); goto d28e6; a570c: $ftpUserSiteEntity = $ftpUserEntity->getSite(); goto B3a37; B3a37: if (!($siteEntity->getDomainName() == $ftpUserSiteEntity->getDomainName())) { goto fe005; } goto Ffb38; Cb43d: $siteUpdater = $this->getSiteUpdater($site); goto ef9ed; ef9ed: $siteUpdater->deleteUser($userName, false); goto F5f36; E510d: $this->siteEntityManager->updateEntity($siteEntity); goto Cb43d; Dcefb: fe005: goto D440c; fb4ff: $siteEntity->removeFtpUser($ftpUserEntity); goto E510d; C61d9: if (!(false === is_null($siteEntity) && false === empty($userName) && false === is_null($ftpUserEntity))) { goto Ae430; } goto a570c; dbe2a: EventQueue::addEvent(EventQueue::EVENT_SITE_FTP_USER_DELETE, $user, $evenData, $request); goto b2a3e; ad2a8: $session = $request->getSession(); goto af47a; c4471: $ftpUserEntity = $this->ftpUserEntityManager->findOneByUserName($userName); goto C61d9; Ffb38: $user = $this->getUser(); goto eae1c; fb783: $siteEntity = $this->getSiteEntity($domainName); goto c4471; F5f36: $evenData = ["\163\x69\x74\x65" => $domainName, "\x75\163\145\162\116\x61\x6d\145" => $userName]; goto dbe2a; eae1c: $userName = $ftpUserEntity->getUserName(); goto fb4ff; D440c: Ae430: goto ad479; ad479: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\x6e\x67\145\162", $this->translator->trans("\101\156\x20\145\162\162\157\x72\x20\x68\141\163\x20\x6f\x63\143\165\162\162\x65\x64\54\40\x65\x72\162\157\x72\40\x6d\145\x73\x73\x61\147\145\72\40\x25\145\x72\162\157\162\x4d\145\163\163\x61\147\x65\x25", ["\x25\x65\x72\x72\x6f\162\x4d\145\x73\x73\141\x67\x65\45" => $e->getMessage()])); } goto E8995; ddac7: $response = $this->redirect($this->generateUrl("\x63\x6c\160\137\163\151\x74\145\x73")); goto D03d6; B93bb: if (!(false === is_null($site))) { goto db677; } goto Aec14; E8995: db677: goto ddac7; cf8c1: $site = $this->getSite($request); goto B93bb; D03d6: return $response; goto fbdde; fbdde: } public function newSshUser(Request $request) : Response { goto f6f4c; E5ee1: if (!(true === $form->isSubmitted())) { goto B0826; } goto a1668; A7cc0: $response = $this->redirect($this->generateUrl("\143\154\160\137\163\151\164\145\163")); goto dc012; e0555: C51d1: goto f423d; F7c96: $response = $this->render("\x46\162\x6f\x6e\x74\x65\156\x64\57\x53\x69\x74\x65\x2f\x6e\145\x77\x2d\x73\x73\150\55\x75\163\x65\x72\56\150\164\x6d\154\56\164\167\151\x67", ["\163\x69\x74\x65" => $site, "\146\157\x72\x6d" => $form->createView(), "\146\x6f\162\x6d\105\162\162\157\x72\163" => $this->formErrors]); goto fc23a; Fd991: if (!(false === is_null($response))) { goto C51d1; } goto E8a80; ae7fc: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto d16ed; Cd8b1: a9cb4: goto F7c96; E415c: if (false === is_null($site)) { goto A4d2c; } goto A7cc0; d728a: if (!(true === $request->isMethod("\120\x4f\123\124"))) { goto a9cb4; } goto F871f; d16ed: $sshUserEntity = $this->sshUserEntityManager->createEntity(); goto afcff; dc012: goto ea5f1; goto C6fc7; F871f: $form->handleRequest($request); goto E5ee1; afcff: $sshUserEntity->setSite($siteEntity); goto Cfe9d; f423d: B0826: goto Cd8b1; C6fc7: A4d2c: goto ae7fc; f6f4c: $site = $this->getSite($request); goto E415c; fc23a: ea5f1: goto b5a50; b5a50: return $response; goto De538; Cfe9d: $form = $this->createSshUserForm($sshUserEntity); goto d728a; E8a80: return $response; goto e0555; a1668: $response = $this->handleSshUserForm($request, $form, $site); goto Fd991; De538: } private function createSshUserForm(SshUserEntity $sshUserEntity) : Form { goto f76ad; f76ad: $siteEntity = $sshUserEntity->getSite(); goto Ee2dd; aed21: $form->add("\163\x75\142\155\x69\x74", SubmitType::class, ["\141\x74\x74\x72" => ["\143\x6c\141\163\163" => "\142\x74\156\x20\142\164\156\55\142\x6c\x75\x65\40\142\164\x6e\55\154\x67"], "\154\141\142\x65\154" => "\x41\x64\x64\40\x55\163\x65\x72"]); goto e8aaa; Ee2dd: $form = $this->createForm("\101\160\x70\134\106\157\x72\155\x5c\x53\151\164\x65\x53\x73\150\x55\x73\145\x72\x54\171\x70\145", $sshUserEntity, ["\141\x63\x74\x69\157\156" => $this->generateUrl("\143\x6c\x70\x5f\x73\x69\164\x65\137\x73\163\150\x5f\165\163\145\x72\x5f\x6e\x65\167", ["\x64\157\155\x61\151\x6e\x4e\x61\x6d\145" => $siteEntity->getDomainName()]), "\155\145\x74\150\x6f\144" => "\120\x4f\x53\x54", "\141\x74\x74\162" => []]); goto aed21; e8aaa: return $form; goto B0e60; B0e60: } private function handleSshUserForm(Request $request, Form $form, Site $site) { goto f57f4; bdda7: goto Ff36b; goto f807b; adc90: try { goto cda9e; a65a5: $sshUserEntity = $form->getData(); goto A6260; Fe536: return $response; goto Df40d; a645c: $this->siteEntityManager->updateEntity($siteEntity); goto A5f79; d675d: $response = $this->redirect($this->generateUrl("\x63\154\160\x5f\163\151\x74\x65\163")); goto Cee6e; d698f: aec26: goto a7be3; D8ffd: $siteEntity = $this->getSiteEntity($domainName); goto c3935; b06a8: $eventData = ["\x73\151\x74\145" => $domainName, "\x75\x73\145\162\116\x61\155\145" => $sshUserName, "\x73\x73\150\x4b\145\171\163" => $sshKeys]; goto e7b68; ed807: $siteUpdater->updateUserSShKeys($sshUserName, $sshKeys); goto A9f79; a84fb: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\x73\x69\x74\145\137\x75\x73\145\162\x73", ["\x64\x6f\155\141\x69\156\x4e\141\155\x65" => $site->getDomainName()])); goto E33d0; A6260: $sshUserName = $sshUserEntity->getUserName(); goto E9f9f; E33d0: C5c6a: goto Fe536; a7be3: $user = $this->getUser(); goto a65a5; e7b68: EventQueue::addEvent(EventQueue::EVENT_SITE_SSH_USER_ADD, $user, $eventData, $request); goto e4420; D26d8: $siteUpdater->createSshUser($sshUserEntity); goto B643e; E9f9f: $sshUserPassword = $form->get("\x70\x61\163\163\x77\157\x72\x64")->getData(); goto Aa492; c3935: if (false === is_null($siteEntity)) { goto aec26; } goto d675d; A5f79: $siteUpdater = $this->getSiteUpdater($site); goto D26d8; fc57b: $domainName = $site->getDomainName(); goto D8ffd; B6eeb: $siteEntity->addSshUser($sshUserEntity); goto a645c; B643e: if (!(false === empty($sshKeys))) { goto caabf; } goto ed807; Aa492: $sshUserEntity->setPassword($sshUserPassword); goto C5dce; cda9e: $session = $request->getSession(); goto fc57b; A9f79: caabf: goto b06a8; C5dce: $sshKeys = $sshUserEntity->getSshKeys(); goto B6eeb; Cee6e: goto C5c6a; goto d698f; e4420: $session->getFlashBag()->set("\x73\x75\x63\143\x65\163\x73", $this->translator->trans("\x55\163\x65\x72\x20\150\141\x73\40\x62\x65\145\156\40\141\x64\144\145\144\x2e")); goto a84fb; Df40d: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\147\145\x72", $this->translator->trans("\101\156\x20\145\162\162\x6f\x72\x20\150\x61\x73\x20\157\143\x63\x75\162\162\145\144\54\40\x65\x72\x72\x6f\x72\40\x6d\145\163\x73\141\x67\145\72\x20\x25\145\162\162\157\162\x4d\x65\x73\163\x61\147\145\x25", ["\x25\145\x72\162\x6f\162\115\x65\163\x73\141\x67\145\45" => $e->getMessage()])); } goto d48e5; ee35f: $this->formErrors = $this->getErrorMessages($form); goto bdda7; d48e5: Ff36b: goto b6e5d; f57f4: if (true === $form->isValid()) { goto d2e05; } goto ee35f; f807b: d2e05: goto adc90; b6e5d: } public function editSshUser(Request $request) : Response { goto b7e71; f8768: Bbffe: goto D6678; a37f8: Cf33a: goto A30f7; fb68b: Ff2b5: goto f8768; Bac9a: f969a: goto d2483; d2483: $form = $this->createSshUserEditForm($sshUserEntity); goto f761a; ca0c7: $response = $this->handleSshUserEditForm($request, $form, $site); goto Cc0b4; ff69c: $form->handleRequest($request); goto c4a8c; D6678: $response = $this->render("\106\x72\x6f\156\x74\x65\x6e\x64\x2f\123\151\x74\145\57\145\144\151\x74\x2d\163\x73\150\55\165\163\x65\162\x2e\150\x74\x6d\154\x2e\164\167\151\147", ["\163\x69\x74\145" => $site, "\x66\x6f\x72\155" => $form->createView(), "\x66\157\x72\x6d\x45\162\x72\x6f\x72\163" => $this->formErrors]); goto a37f8; f761a: if (!(true === $request->isMethod("\120\x4f\x53\x54"))) { goto Bbffe; } goto ff69c; c4a8c: if (!(true === $form->isSubmitted())) { goto Ff2b5; } goto ca0c7; A30f7: return $response; goto f0314; f6a83: $sshUserEntity = $this->sshUserEntityManager->findOneByUserName($userName); goto edabc; F6d7d: F55e8: goto fb68b; d43c6: return $response; goto F6d7d; edabc: if (false === is_null($sshUserEntity) && false === is_null($site) && $sshUserEntity->getSite()->getDomainName() == $site->getDomainName()) { goto f969a; } goto fdf6f; fdf6f: $response = $this->redirect($this->generateUrl("\x63\154\x70\x5f\163\x69\164\x65\x73")); goto eb6f3; eb6f3: goto Cf33a; goto Bac9a; b7e71: $userName = $request->get("\x75\163\x65\162\x4e\141\x6d\145"); goto B7e04; B7e04: $site = $this->getSite($request); goto f6a83; Cc0b4: if (!(false === is_null($response))) { goto F55e8; } goto d43c6; f0314: } private function createSshUserEditForm(SshUserEntity $sshUserEntity) : Form { goto e75af; fd3ba: return $form; goto E0828; E578d: $form = $this->createForm("\101\x70\160\134\x46\x6f\x72\x6d\134\x53\x69\x74\x65\123\x73\150\125\x73\x65\x72\105\144\x69\x74\124\x79\x70\x65", $sshUserEntity, ["\141\x63\x74\x69\157\156" => $this->generateUrl("\x63\154\160\137\163\x69\x74\x65\137\163\x73\x68\x5f\x75\x73\x65\x72\137\x65\x64\151\x74", ["\144\x6f\x6d\x61\x69\x6e\x4e\141\x6d\x65" => $siteEntity->getDomainName(), "\x75\x73\x65\162\116\141\x6d\145" => $sshUserEntity->getUserName()]), "\155\x65\164\150\x6f\x64" => "\120\117\x53\x54", "\141\x74\x74\x72" => []]); goto fb08c; fb08c: $form->add("\x73\165\x62\x6d\151\164", SubmitType::class, ["\x61\164\x74\x72" => ["\x63\154\x61\x73\163" => "\142\x74\156\40\142\x74\x6e\55\142\x6c\165\145\x20\x62\164\156\55\x6c\x67"], "\x6c\x61\142\145\x6c" => "\123\x61\x76\145"]); goto fd3ba; e75af: $siteEntity = $sshUserEntity->getSite(); goto E578d; E0828: } private function handleSshUserEditForm(Request $request, Form $form, Site $site) { goto f98dd; Acbc1: da253: goto a6b95; f98dd: if (true === $form->isValid()) { goto da253; } goto b7a98; b7a98: $this->formErrors = $this->getErrorMessages($form); goto Dbd47; Dbd47: goto Efbf1; goto Acbc1; e219f: Efbf1: goto d7333; a6b95: try { goto C36dd; Ece96: $sshUserName = $sshUserEntity->getUserName(); goto b4f67; fec2c: $user = $this->getUser(); goto b8667; C56c7: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\x5f\163\151\164\145\163")); goto C48b7; Ec224: $sshKeys = false === is_null($sshUserEntity->getSshKeys()) ? $sshUserEntity->getSshKeys() : ''; goto b5a57; f2991: $session->getFlashBag()->set("\163\x75\143\x63\145\163\163", $this->translator->trans("\x55\163\145\x72\40\x68\x61\x73\x20\142\145\145\156\x20\163\x61\166\145\144\x2e")); goto bff4f; D0564: $eventData = ["\163\151\164\x65" => $domainName, "\165\x73\145\x72\116\141\155\x65" => $sshUserName, "\163\x73\x68\x4b\145\x79\x73" => $sshKeys]; goto Ca04b; c2411: $siteUpdater = $this->getSiteUpdater($site); goto e9c09; A27ab: $siteUpdater->changeUserPassword($sshUserName, $sshUserPassword); goto d687d; C48b7: goto Bff5a; goto c55a9; b4f67: $sshUserPassword = $form->get("\x70\141\x73\x73\167\x6f\x72\144")->getData(); goto Ec224; Ca04b: EventQueue::addEvent(EventQueue::EVENT_SITE_SSH_USER_EDIT, $user, $eventData, $request); goto f2991; Be107: $siteUpdater->updateUserSShKeys($sshUserName, $sshKeys); goto D0564; fb569: $siteEntity = $this->getSiteEntity($domainName); goto E85da; E85da: if (false === is_null($siteEntity)) { goto b60f2; } goto C56c7; C36dd: $session = $request->getSession(); goto c8a7c; E5f8c: Bff5a: goto Aa4a1; e9c09: if (!(false === empty($sshUserPassword))) { goto ebf3e; } goto A27ab; Aa4a1: return $response; goto C06ef; b5a57: $this->siteEntityManager->updateEntity($siteEntity); goto c2411; c55a9: b60f2: goto fec2c; d687d: ebf3e: goto Be107; c8a7c: $domainName = $site->getDomainName(); goto fb569; bff4f: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\x73\x69\164\145\137\165\163\x65\162\x73", ["\144\x6f\155\141\151\156\116\141\x6d\x65" => $site->getDomainName()])); goto E5f8c; b8667: $sshUserEntity = $form->getData(); goto Ece96; C06ef: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\x6e\x67\x65\162", $this->translator->trans("\101\x6e\40\x65\162\x72\157\x72\40\x68\x61\x73\40\x6f\x63\143\x75\162\162\x65\144\54\40\145\162\x72\157\x72\40\x6d\x65\x73\x73\141\x67\145\72\40\x25\x65\x72\x72\x6f\x72\115\145\x73\x73\141\147\145\45", ["\x25\145\x72\x72\157\x72\115\x65\x73\163\141\x67\145\45" => $e->getMessage()])); } goto e219f; d7333: } public function deleteSshUser(Request $request) : Response { goto ca7b9; cdf72: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\163\151\x74\145\x73")); goto F2794; ca7b9: $site = $this->getSite($request); goto da373; da373: if (!(false === is_null($site))) { goto ac2f7; } goto d1efc; F2794: return $response; goto D5750; B77af: ac2f7: goto cdf72; d1efc: try { goto efd7b; a2229: A0af4: goto A50c8; B049f: $siteEntity = $this->getSiteEntity($domainName); goto f66c2; D57a6: if (!(false === is_null($siteEntity) && false === empty($userName) && false === is_null($sshUserEntity))) { goto A0af4; } goto B83b2; Cc790: $evenData = ["\x73\151\164\145" => $domainName, "\x75\163\x65\x72\x4e\141\155\x65" => $userName]; goto A13ff; E43d5: $siteUpdater->deleteUser($userName, true); goto Cc790; eb28a: $userName = $sshUserEntity->getUserName(); goto b5b10; A13ff: EventQueue::addEvent(EventQueue::EVENT_SITE_SSH_USER_DELETE, $user, $evenData, $request); goto Cf7aa; B83b2: $sshUserSiteEntity = $sshUserEntity->getSite(); goto Fe09a; C75cd: $siteUpdater = $this->getSiteUpdater($site); goto E43d5; Fe09a: if (!($siteEntity->getDomainName() == $sshUserSiteEntity->getDomainName())) { goto da66d; } goto f9f08; f9f08: $user = $this->getUser(); goto eb28a; b0c2a: return $response; goto f8a3b; Cf7aa: $session->getFlashBag()->set("\163\x75\x63\x63\145\163\x73", $this->translator->trans("\125\x73\145\x72\x20\x68\x61\x73\x20\x62\145\x65\156\x20\144\x65\x6c\x65\164\145\144\56")); goto Fcb51; f66c2: $sshUserEntity = $this->sshUserEntityManager->findOneByUserName($userName); goto D57a6; b5b10: $siteEntity->removeSshUser($sshUserEntity); goto e1cf4; efd7b: $session = $request->getSession(); goto F5dc0; F5c53: $domainName = $site->getDomainName(); goto B049f; f8a3b: da66d: goto a2229; F5dc0: $userName = $request->get("\165\x73\x65\162\116\x61\x6d\x65"); goto F5c53; Fcb51: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\x5f\163\x69\164\x65\137\x75\163\145\x72\163", ["\x64\157\x6d\x61\x69\156\116\x61\x6d\145" => $site->getDomainName()])); goto b0c2a; e1cf4: $this->siteEntityManager->updateEntity($siteEntity); goto C75cd; A50c8: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\x61\x6e\147\x65\162", $this->translator->trans("\101\156\x20\x65\162\162\x6f\162\x20\x68\x61\x73\40\157\143\x63\165\162\162\x65\x64\x2c\40\145\162\162\157\x72\x20\155\x65\x73\x73\141\x67\x65\72\40\45\145\162\162\x6f\x72\115\145\163\x73\x61\x67\145\45", ["\45\145\162\162\x6f\x72\115\x65\x73\163\x61\147\x65\45" => $e->getMessage()])); } goto B77af; D5750: } public function security(Request $request) : Response { goto a1d4a; E2166: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto F692f; C851a: D6f30: goto f4925; f8f52: $basicAuthForm = $this->createBasicAuthForm($basicAuthEntity); goto c4337; d3747: $basicAuthEntity->setSite($siteEntity); goto f8f52; b8c64: Bb888: goto ee124; Ffda5: $blockedIps = $site->getBlockedIps(); goto Aa919; b9bca: Df960: goto E2166; a1d4a: $site = $this->getSite($request); goto af036; C47b5: if (!(false === is_null($response))) { goto f9fbc; } goto E5acb; B3378: goto d6ccf; goto b9bca; dd86c: D280d: goto C851a; f4925: $response = $this->render("\106\162\157\x6e\164\x65\x6e\144\x2f\123\151\x74\145\57\163\x65\x63\x75\x72\151\x74\x79\x2e\150\164\155\154\56\164\x77\x69\x67", ["\163\151\164\x65" => $site, "\142\x6c\x6f\x63\x6b\x65\144\x49\x70\x73" => $blockedIps, "\x62\154\157\143\153\x65\144\102\x6f\x74\x73" => $blockedBots, "\x62\x61\x73\151\x63\x41\x75\164\150\106\x6f\x72\x6d" => $basicAuthForm->createView(), "\x63\154\x6f\x75\144\146\x6c\141\x72\145\x46\x6f\162\x6d" => $cloudflareForm->createView(), "\x66\157\162\155\x45\162\x72\x6f\162\x73" => $this->formErrors]); goto Afcc8; ee124: ea2e7: goto f4b67; F089d: return $response; goto a10f4; F692f: $cloudflareData = ["\141\154\x6c\x6f\x77\x54\162\141\146\146\151\x63\x46\x72\x6f\x6d\x43\154\157\x75\x64\146\x6c\x61\x72\145\x4f\x6e\154\x79" => $siteEntity->allowTrafficFromCloudflareOnly()]; goto de702; A75b1: F1530: goto d3747; c4337: $cloudflareForm = $this->createCloudflareForm($siteEntity, $cloudflareData); goto E10d5; de702: $blockedBots = $site->getBlockedBots(); goto Ffda5; E5acb: return $response; goto Bd7c4; c6944: $response = $this->handleBasicAuthForm($request, $basicAuthForm, $site); goto d8f62; Ba659: $response = $this->handleCloudflareForm($request, $cloudflareForm, $site); goto C47b5; b2c81: if (!(true === $basicAuthForm->isSubmitted())) { goto ea2e7; } goto c6944; f4b67: if (!(true === $cloudflareForm->isSubmitted())) { goto D280d; } goto Ba659; Fd97e: return $response; goto b8c64; F5b9c: $basicAuthEntity = $this->basicAuthEntityManager->createEntity(); goto A75b1; af036: if (false === is_null($site)) { goto Df960; } goto Ab8d0; Afcc8: d6ccf: goto F089d; Bd7c4: f9fbc: goto dd86c; E10d5: if (!(true === $request->isMethod("\120\117\x53\124"))) { goto D6f30; } goto A7b2c; d8f62: if (!(false === is_null($response))) { goto Bb888; } goto Fd97e; Ab8d0: $response = $this->redirect($this->generateUrl("\143\154\x70\137\163\x69\164\x65\163")); goto B3378; Aa919: $basicAuthEntity = $site->getBasicAuth(); goto Def56; A7b2c: $basicAuthForm->handleRequest($request); goto Cfc94; Def56: if (!(true === is_null($basicAuthEntity))) { goto F1530; } goto F5b9c; Cfc94: $cloudflareForm->handleRequest($request); goto b2c81; a10f4: } private function createCloudflareForm(SiteEntity $siteEntity, array $data) : Form { goto D0b2f; Ea0ae: $form->add("\x73\x75\x62\155\x69\x74", SubmitType::class, ["\x61\164\164\x72" => ["\x63\154\x61\163\x73" => "\142\164\x6e\40\x62\x74\x6e\55\142\154\165\x65\x20\142\164\156\x2d\154\147"], "\x6c\141\x62\145\154" => "\123\x61\x76\x65"]); goto cfac7; D0b2f: $form = $this->createForm("\101\160\160\134\x46\x6f\x72\155\134\123\151\x74\145\103\154\x6f\165\144\146\x6c\141\x72\145\124\x79\160\x65", $data, ["\x61\x63\x74\x69\157\156" => $this->generateUrl("\143\x6c\x70\137\x73\151\164\x65\x5f\x73\145\x63\x75\x72\151\164\x79", ["\144\157\x6d\x61\x69\x6e\x4e\141\155\x65" => $siteEntity->getDomainName()]), "\x6d\x65\x74\x68\157\144" => "\x50\117\x53\124", "\141\164\x74\x72" => []]); goto Ea0ae; cfac7: return $form; goto eabc0; eabc0: } private function createBasicAuthForm(BasicAuthEntity $basicAuthEntity) : Form { goto D845b; D845b: $siteEntity = $basicAuthEntity->getSite(); goto efd08; efd08: $form = $this->createForm("\x41\x70\x70\x5c\x46\157\x72\155\134\123\x69\164\145\x42\141\x73\x69\x63\x41\x75\164\150\124\x79\x70\145", $basicAuthEntity, ["\x61\143\x74\151\x6f\156" => $this->generateUrl("\143\154\x70\137\x73\151\x74\145\137\163\x65\x63\165\x72\x69\164\x79", ["\x64\x6f\x6d\141\151\156\x4e\x61\x6d\x65" => $siteEntity->getDomainName()]), "\155\x65\x74\x68\157\144" => "\120\x4f\123\x54", "\141\x74\164\162" => []]); goto bd39b; bd39b: $form->add("\x73\x75\x62\x6d\151\164", SubmitType::class, ["\x61\x74\x74\x72" => ["\143\x6c\141\163\x73" => "\x62\164\x6e\40\x62\x74\x6e\55\142\154\x75\145\40\x62\x74\156\x2d\x6c\147"], "\154\x61\x62\145\x6c" => "\123\141\x76\x65"]); goto D4ea0; D4ea0: return $form; goto f44ca; f44ca: } private function handleBasicAuthForm(Request $request, Form $form, Site $site) { goto a952d; eebb7: f3259: goto ea538; Ef1fd: try { goto Ec8d1; ffda3: $siteEntity = $this->getSiteEntity($domainName); goto C9e5d; Ec8d1: $session = $request->getSession(); goto Ce27b; b8489: $siteUpdater->reloadNginxService(); goto Ad2dc; a2218: $user = $this->getUser(); goto b6fa7; b6fa7: $basicAuthEntity = $form->getData(); goto f85ac; f85ac: $siteEntity->setBasicAuth($basicAuthEntity); goto D513f; C9e5d: if (false === is_null($siteEntity)) { goto B88bc; } goto Abc28; ead9d: $response = $this->redirect($this->generateUrl("\143\154\x70\137\x73\151\x74\145\x5f\x73\145\143\165\x72\x69\x74\171", ["\144\x6f\155\x61\x69\156\116\x61\155\145" => $site->getDomainName()])); goto Ef8ea; Abc28: $response = $this->redirect($this->generateUrl("\x63\154\160\137\x73\x69\x74\145\x73")); goto Ff6e1; Ce27b: $domainName = $site->getDomainName(); goto ffda3; f14c4: $this->siteEntityManager->updateEntity($siteEntity); goto Ed925; E251e: $session->getFlashBag()->set("\x73\165\143\x63\x65\163\163", $this->translator->trans("\x42\x61\163\151\143\x20\x41\x75\x74\150\x65\x6e\164\x69\143\x61\x74\151\157\156\x20\x73\x65\x74\x74\x69\156\147\x73\40\x68\141\166\145\40\142\145\x65\x6e\40\163\141\x76\145\x64\56")); goto ead9d; F18dd: B88bc: goto a2218; D513f: $site->setBasicAuth($basicAuthEntity); goto f14c4; E7d03: $siteUpdater->createBasicAuthFile($basicAuthEntity); goto Fa028; Fa028: $siteUpdater->updateNginxVhost(); goto b8489; Ff6e1: goto D57c4; goto F18dd; Ed925: $siteUpdater = $this->getSiteUpdater($site); goto E7d03; ee93f: EventQueue::addEvent(EventQueue::EVENT_SITE_BASIC_AUTHENTIFICATION_SETTINGS, $user, $eventData, $request); goto E251e; Ad2dc: $eventData = ["\x73\x69\164\145" => $domainName, "\141\143\x74\x69\166\145" => true === $basicAuthEntity->getIsActive() ? "\x31" : "\x30", "\165\163\x65\x72\116\x61\155\x65" => $basicAuthEntity->getUserName(), "\167\150\151\164\145\154\151\163\164\145\x64\x49\x70\163" => $basicAuthEntity->getWhitelistedIps()]; goto ee93f; Ef8ea: D57c4: goto b0baf; b0baf: return $response; goto A8af0; A8af0: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\x6e\x67\x65\x72", $this->translator->trans("\101\x6e\x20\145\x72\x72\x6f\162\x20\150\141\x73\x20\x6f\x63\x63\165\x72\x72\145\144\x2c\40\x65\162\x72\x6f\162\x20\x6d\145\x73\163\x61\x67\x65\72\x20\x25\x65\162\162\x6f\162\x4d\x65\x73\x73\x61\x67\x65\x25", ["\45\x65\x72\162\x6f\162\115\x65\163\x73\141\x67\145\x25" => $e->getMessage()])); } goto eebb7; a952d: if (true === $form->isValid()) { goto C0b94; } goto Ad555; e234d: goto f3259; goto Bd1ae; Bd1ae: C0b94: goto Ef1fd; Ad555: $this->formErrors = $this->getErrorMessages($form); goto e234d; ea538: } private function handleCloudflareForm(Request $request, Form $form, Site $site) { goto c1bb0; f4007: goto C61cb; goto eaf5e; F59d9: C61cb: goto a4254; c1bb0: if (true === $form->isValid()) { goto A848e; } goto Efb5a; Efb5a: $this->formErrors = $this->getErrorMessages($form); goto f4007; e53f7: try { goto Bdf77; f1730: $siteUpdater->updateNginxVhost(); goto dc94b; A94ed: if (false === is_null($siteEntity)) { goto ec8cd; } goto ef886; C9c5b: $siteUpdater = $this->getSiteUpdater($site); goto f1730; dc94b: $siteUpdater->reloadNginxService(); goto f0787; f9db4: goto Cc9eb; goto aaa58; Bd321: return $response; goto Ec6c8; fff1a: $siteEntity = $this->getSiteEntity($domainName); goto A94ed; fe518: $response = $this->redirect($this->generateUrl("\x63\154\160\x5f\163\x69\164\x65\x5f\163\x65\143\x75\162\151\164\171", ["\x64\157\x6d\x61\151\x6e\x4e\141\155\145" => $site->getDomainName()])); goto Cd37b; ef886: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\x73\151\164\145\x73")); goto f9db4; bc8ee: $allowTrafficFromCloudflareOnly = $form->get("\x61\154\x6c\x6f\x77\x54\x72\141\146\x66\x69\x63\106\x72\x6f\x6d\103\x6c\x6f\165\x64\x66\x6c\141\x72\x65\117\x6e\154\x79")->getData(); goto F4480; b6767: $site->setAllowTrafficFromCloudflareOnly($allowTrafficFromCloudflareOnly); goto Aeb84; Bdf77: $session = $request->getSession(); goto B48b3; b666f: $session->getFlashBag()->set("\163\x75\143\x63\x65\x73\x73", $this->translator->trans("\103\154\157\165\144\x66\x6c\141\x72\145\40\x73\x65\164\x74\x69\156\x67\x73\x20\150\141\x76\x65\x20\142\x65\145\x6e\x20\163\x61\x76\x65\x64\x2e")); goto fe518; F69b7: EventQueue::addEvent(EventQueue::EVENT_SITE_CLOUDFLARE_SETTINGS, $user, $eventData, $request); goto b666f; f0787: $eventData = ["\x73\151\164\x65" => $domainName, "\141\x6c\154\157\167\124\x72\x61\x66\x66\x69\x63\106\162\157\x6d\x43\154\157\165\144\x66\154\141\x72\x65\117\x6e\154\171" => true === $allowTrafficFromCloudflareOnly ? "\x31" : "\60"]; goto F69b7; Aeb84: $this->siteEntityManager->updateEntity($siteEntity); goto C9c5b; f16da: $user = $this->getUser(); goto bc8ee; aaa58: ec8cd: goto f16da; B48b3: $domainName = $site->getDomainName(); goto fff1a; Cd37b: Cc9eb: goto Bd321; F4480: $siteEntity->setAllowTrafficFromCloudflareOnly($allowTrafficFromCloudflareOnly); goto b6767; Ec6c8: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\x61\x6e\x67\145\162", $this->translator->trans("\101\156\40\145\162\x72\x6f\162\x20\150\x61\163\40\x6f\143\143\x75\x72\162\x65\144\x2c\x20\145\162\x72\157\162\x20\x6d\145\163\163\x61\147\x65\x3a\x20\45\145\x72\x72\157\162\x4d\145\163\x73\x61\x67\x65\x25", ["\x25\x65\162\x72\157\x72\x4d\145\x73\x73\x61\x67\145\x25" => $e->getMessage()])); } goto F59d9; eaf5e: A848e: goto e53f7; a4254: } public function newBlockedIp(Request $request) : Response { goto a313c; B1973: if (false === is_null($site)) { goto E1f42; } goto fb18f; B1ee6: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto Eb2ba; a313c: $site = $this->getSite($request); goto B1973; d6839: ccca6: goto caaff; fb18f: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\163\151\164\145\x73")); goto f3ebc; b23de: $form->handleRequest($request); goto ec3eb; b4180: ad0ae: goto a3474; Cf36c: $response = $this->render("\x46\162\x6f\156\164\145\x6e\144\x2f\123\x69\164\145\57\156\145\167\55\142\x6c\x6f\x63\153\145\144\x2d\x69\x70\56\150\164\x6d\x6c\x2e\x74\167\x69\x67", ["\163\151\x74\x65" => $site, "\146\157\162\155" => $form->createView(), "\x66\x6f\x72\155\x45\x72\x72\157\162\163" => $this->formErrors]); goto d6839; Eb2ba: $blockedIpEntity = $this->blockedIpEntityManager->createEntity(); goto Ddb12; B17a1: if (!(false === is_null($response))) { goto ad0ae; } goto Adea1; ec3eb: if (!(true === $form->isSubmitted())) { goto b1ba2; } goto be4e0; Ddb12: $blockedIpEntity->setSite($siteEntity); goto e302d; be4e0: $response = $this->handleBlockedIpForm($request, $form, $site); goto B17a1; b754c: E1f42: goto B1ee6; b2833: if (!(true === $request->isMethod("\120\x4f\123\x54"))) { goto e2d63; } goto b23de; e302d: $form = $this->createBlockedIpForm($blockedIpEntity); goto b2833; Ec6a4: e2d63: goto Cf36c; f3ebc: goto ccca6; goto b754c; Adea1: return $response; goto b4180; a3474: b1ba2: goto Ec6a4; caaff: return $response; goto a26da; a26da: } private function createBlockedIpForm(BlockedIpEntity $blockedIpEntity) : Form { goto fe6c3; cd5fc: $form->add("\163\x75\x62\155\x69\x74", SubmitType::class, ["\x61\x74\164\162" => ["\143\x6c\141\163\x73" => "\x62\164\156\40\142\164\156\x2d\142\154\165\x65\40\x62\164\156\x2d\154\x67"], "\154\x61\142\x65\154" => "\101\144\x64\40\x49\120"]); goto E3ea7; ebad2: $form = $this->createForm("\101\x70\160\x5c\106\157\162\155\x5c\x53\151\x74\145\x42\154\157\143\x6b\145\x64\111\x50\124\171\160\145", $blockedIpEntity, ["\141\143\164\x69\157\x6e" => $this->generateUrl("\x63\154\x70\x5f\163\x69\x74\145\137\163\145\143\x75\162\x69\164\171\137\142\154\157\143\x6b\145\144\137\151\x70\x5f\156\145\167", ["\x64\157\x6d\x61\151\156\x4e\141\155\x65" => $siteEntity->getDomainName()]), "\155\145\x74\x68\157\144" => "\120\117\x53\124", "\141\164\x74\162" => []]); goto cd5fc; E3ea7: return $form; goto a7a51; fe6c3: $siteEntity = $blockedIpEntity->getSite(); goto ebad2; a7a51: } private function handleBlockedIpForm(Request $request, Form $form, Site $site) { goto C95e6; C95e6: if (true === $form->isValid()) { goto a958f; } goto ae8d4; ec7c2: goto C5614; goto c1759; E50a7: try { goto e5fae; dc685: Fedb2: goto B6cd6; d1699: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\137\x73\x69\x74\x65\x73")); goto a0507; B6cd6: return $response; goto A2d06; Fac19: $siteUpdater->updateNginxVhost(); goto Fe3c5; Da1be: $siteUpdater = $this->getSiteUpdater($site); goto Fac19; e5fae: $session = $request->getSession(); goto Ed329; dc5fb: if (false === is_null($siteEntity)) { goto acded; } goto d1699; e92bc: $eventData = ["\x73\x69\164\145" => $domainName, "\151\x70" => $blockedIp->getIp()]; goto A749e; D051b: $siteEntity = $this->getSiteEntity($domainName); goto dc5fb; Ed329: $domainName = $site->getDomainName(); goto D051b; Fe3c5: $siteUpdater->reloadNginxService(); goto e92bc; bdcc1: $user = $this->getUser(); goto a310a; Ccf1c: $response = $this->redirect($this->generateUrl("\x63\154\160\137\x73\x69\x74\145\137\x73\145\x63\165\162\x69\164\171", ["\144\x6f\x6d\141\151\156\116\x61\155\x65" => $site->getDomainName()])); goto dc685; f8fa3: $session->getFlashBag()->set("\163\165\x63\143\x65\163\x73", $this->translator->trans("\x49\120\40\150\x61\163\x20\x62\x65\x65\x6e\x20\x61\x64\144\x65\x64\x2e")); goto Ccf1c; a310a: $blockedIp = $form->getData(); goto d03e5; d03e5: $siteEntity->addBlockedIp($blockedIp); goto E1a70; a0507: goto Fedb2; goto F331e; E1a70: $this->siteEntityManager->updateEntity($siteEntity); goto Da1be; F331e: acded: goto bdcc1; A749e: EventQueue::addEvent(EventQueue::EVENT_SITE_BLOCKED_IP_ADD, $user, $eventData, $request); goto f8fa3; A2d06: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\x6e\x67\145\162", $this->translator->trans("\x41\156\x20\x65\162\162\x6f\162\x20\150\x61\x73\x20\157\143\x63\165\162\x72\x65\x64\54\x20\145\x72\x72\x6f\162\x20\155\145\x73\x73\x61\x67\145\72\x20\x25\145\162\x72\x6f\162\x4d\145\163\163\x61\147\145\x25", ["\45\145\162\x72\157\x72\115\x65\163\163\141\x67\x65\45" => $e->getMessage()])); } goto e64da; c1759: a958f: goto E50a7; ae8d4: $this->formErrors = $this->getErrorMessages($form); goto ec7c2; e64da: C5614: goto E5367; E5367: } public function deleteBlockedIp(Request $request) : Response { goto C8bc7; cce1b: if (!(false === is_null($site))) { goto B6125; } goto e10bf; C8bc7: $site = $this->getSite($request); goto cce1b; b6e75: B6125: goto b442a; e10bf: try { goto A569d; E012a: $domainName = $site->getDomainName(); goto E6c4b; E6c4b: $siteEntity = $this->getSiteEntity($domainName); goto A2a0b; Df831: $siteEntity->removeBlockedIp($blockedIpEntity); goto fff7c; B1300: if (!(false === is_null($siteEntity) && false === empty($id) && false === is_null($blockedIpEntity) && $siteEntity == $blockedIpEntity->getSite())) { goto ded5e; } goto B8226; ccd98: $siteUpdater->reloadNginxService(); goto c2a2f; ae119: ded5e: goto ff8d1; b99a5: return $response; goto ae119; A2a0b: $blockedIpEntity = $this->blockedIpEntityManager->findOneById($id); goto B1300; fff7c: $this->siteEntityManager->updateEntity($siteEntity); goto d064c; Ace8a: EventQueue::addEvent(EventQueue::EVENT_SITE_BLOCKED_IP_DELETE, $user, $eventData, $request); goto E07c4; B8226: $user = $this->getUser(); goto Df831; E07c4: $session->getFlashBag()->set("\x73\x75\x63\143\145\x73\x73", $this->translator->trans("\111\120\x20\150\141\163\x20\x62\x65\x65\x6e\40\144\145\154\x65\164\x65\144\56")); goto F21e4; F21e4: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\163\151\164\x65\137\x73\145\x63\x75\x72\151\x74\x79", ["\144\157\x6d\x61\x69\x6e\x4e\x61\155\145" => $site->getDomainName()])); goto b99a5; c2a2f: $eventData = ["\x73\x69\164\145" => $domainName, "\x69\x70" => $blockedIpEntity->getIp()]; goto Ace8a; A569d: $session = $request->getSession(); goto b9ca0; d064c: $siteUpdater = $this->getSiteUpdater($site); goto cea81; b9ca0: $id = (int) $request->get("\x69\144"); goto E012a; cea81: $siteUpdater->updateNginxVhost(); goto ccd98; ff8d1: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\147\x65\162", $this->translator->trans("\x41\156\x20\145\x72\x72\x6f\x72\40\150\x61\163\40\157\x63\143\x75\162\162\145\x64\x2c\40\145\162\x72\157\x72\40\155\145\163\x73\141\x67\145\72\x20\45\x65\x72\162\157\162\x4d\x65\163\163\x61\x67\145\45", ["\45\x65\x72\x72\x6f\x72\115\x65\163\163\141\x67\145\45" => $e->getMessage()])); } goto b6e75; Dbb9f: return $response; goto f064d; b442a: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\151\x74\x65\x73")); goto Dbb9f; f064d: } public function newBlockedBot(Request $request) : Response { goto Abadb; Fabdb: if (!(true === $form->isSubmitted())) { goto aeea8; } goto e1de5; e632e: return $response; goto Aa336; Aa336: Ad2f0: goto cea50; Abadb: $site = $this->getSite($request); goto F3846; B70cc: $blockedBotEntity->setSite($siteEntity); goto F4463; b1c3a: $blockedBotEntity = $this->blockedBotEntityManager->createEntity(); goto B70cc; F39c0: if (!(false === is_null($response))) { goto Ad2f0; } goto e632e; bba16: e95dc: goto B744d; F7ce8: C1eb7: goto Faf89; B744d: $response = $this->render("\106\162\157\x6e\164\x65\156\x64\57\x53\151\164\x65\x2f\x6e\x65\x77\55\x62\154\x6f\x63\153\x65\x64\55\142\157\x74\x2e\x68\164\x6d\154\56\x74\167\x69\x67", ["\x73\151\x74\x65" => $site, "\x66\x6f\x72\155" => $form->createView(), "\x66\157\x72\155\105\x72\x72\x6f\x72\163" => $this->formErrors]); goto a8c99; B5958: $form->handleRequest($request); goto Fabdb; e1de5: $response = $this->handleBlockedBotForm($request, $form, $site); goto F39c0; cf75d: return $response; goto bf039; cea50: aeea8: goto bba16; F3846: if (false === is_null($site)) { goto C1eb7; } goto Ad28f; Ad28f: $response = $this->redirect($this->generateUrl("\x63\x6c\160\137\x73\151\164\145\163")); goto D759e; F4463: $form = $this->createBlockedBotForm($blockedBotEntity); goto Aecec; Faf89: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto b1c3a; Aecec: if (!(true === $request->isMethod("\x50\117\123\124"))) { goto e95dc; } goto B5958; a8c99: B668e: goto cf75d; D759e: goto B668e; goto F7ce8; bf039: } private function createBlockedBotForm(BlockedBotEntity $blockedBotEntity) : Form { goto B74a9; f7e59: $form = $this->createForm("\x41\160\x70\x5c\106\157\x72\155\x5c\123\151\164\145\x42\x6c\x6f\x63\x6b\145\144\102\x6f\x74\x54\171\160\145", $blockedBotEntity, ["\141\x63\164\x69\x6f\156" => $this->generateUrl("\x63\154\x70\137\163\151\x74\145\137\163\x65\x63\165\162\151\x74\x79\x5f\142\154\157\x63\x6b\145\144\x5f\x62\x6f\x74\137\x6e\145\x77", ["\144\157\155\141\x69\156\x4e\141\x6d\145" => $siteEntity->getDomainName()]), "\155\145\x74\150\x6f\144" => "\120\x4f\x53\124", "\141\164\x74\x72" => []]); goto Ed3d7; Ed3d7: $form->add("\x73\165\142\155\x69\x74", SubmitType::class, ["\141\164\x74\162" => ["\143\154\141\x73\163" => "\142\164\x6e\40\x62\x74\156\55\x62\154\165\145\40\142\x74\156\x2d\x6c\147"], "\x6c\x61\142\x65\154" => "\101\144\144\x20\x42\157\164"]); goto C41ae; B74a9: $siteEntity = $blockedBotEntity->getSite(); goto f7e59; C41ae: return $form; goto e3203; e3203: } private function handleBlockedBotForm(Request $request, Form $form, Site $site) { goto Ebfa8; B296c: ab609: goto dc408; b9d8d: goto b9b3a; goto B296c; fdf41: b9b3a: goto fdf5c; dc408: try { goto B7a6c; B01d1: $siteUpdater->updateNginxVhost(); goto F6258; f6d20: $blockedBot = $form->getData(); goto Ddf63; F6258: $siteUpdater->reloadNginxService(); goto acde2; Aa7fa: Aeac5: goto F8ffc; Ddf63: $siteEntity->addBlockedBot($blockedBot); goto A5229; c4897: $response = $this->redirect($this->generateUrl("\143\154\160\137\x73\x69\164\145\x73")); goto cf632; de3b2: $siteEntity = $this->getSiteEntity($domainName); goto bdd7a; e57d5: $response = $this->redirect($this->generateUrl("\x63\154\160\x5f\x73\x69\164\145\137\x73\145\143\165\162\x69\164\171", ["\144\157\155\x61\151\156\116\x61\155\145" => $site->getDomainName()])); goto Aa7fa; d6f3c: $session->getFlashBag()->set("\x73\x75\x63\x63\x65\x73\x73", $this->translator->trans("\102\x6f\164\40\x68\141\x73\40\x62\x65\145\x6e\x20\141\x64\144\145\144\56")); goto e57d5; B7a6c: $session = $request->getSession(); goto Ac4b2; b1bb3: $siteUpdater = $this->getSiteUpdater($site); goto B01d1; bdd7a: if (false === is_null($siteEntity)) { goto bf04e; } goto c4897; Ac4b2: $domainName = $site->getDomainName(); goto de3b2; A5229: $this->siteEntityManager->updateEntity($siteEntity); goto b1bb3; F6d18: EventQueue::addEvent(EventQueue::EVENT_SITE_BLOCKED_BOT_ADD, $user, $eventData, $request); goto d6f3c; cf632: goto Aeac5; goto de253; F8ffc: return $response; goto Efe36; acde2: $eventData = ["\163\151\164\145" => $domainName, "\156\x61\x6d\145" => $blockedBot->getName()]; goto F6d18; de253: bf04e: goto E6006; E6006: $user = $this->getUser(); goto f6d20; Efe36: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\x6e\x67\x65\x72", $this->translator->trans("\101\156\x20\x65\x72\162\157\162\40\x68\x61\163\x20\157\143\x63\165\162\x72\145\144\x2c\40\145\x72\162\x6f\x72\x20\155\145\x73\x73\141\147\x65\x3a\x20\x25\145\x72\x72\157\x72\115\x65\x73\163\141\147\x65\x25", ["\x25\x65\x72\162\x6f\162\x4d\145\x73\x73\141\147\x65\x25" => $e->getMessage()])); } goto fdf41; Ebfa8: if (true === $form->isValid()) { goto ab609; } goto A2c66; A2c66: $this->formErrors = $this->getErrorMessages($form); goto b9d8d; fdf5c: } public function deleteBlockedBot(Request $request) : Response { goto B7b9a; D36f6: return $response; goto E55f1; Eb045: try { goto cdbe1; fdec2: $siteUpdater->reloadNginxService(); goto bcec1; C5e66: $domainName = $site->getDomainName(); goto c65fe; Dd61c: $siteEntity->removeBlockedBot($blockedBotEntity); goto A949e; B2e0e: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\x73\151\x74\x65\x5f\x73\145\143\165\162\151\x74\x79", ["\144\x6f\x6d\x61\x69\156\x4e\141\x6d\x65" => $site->getDomainName()])); goto Ee21a; dd12c: $siteUpdater->updateNginxVhost(); goto fdec2; c23ec: $session->getFlashBag()->set("\x73\165\x63\143\145\163\163", $this->translator->trans("\x42\157\164\x20\x68\x61\163\x20\142\x65\145\156\x20\x64\145\x6c\x65\164\145\144\x2e")); goto B2e0e; Ee21a: return $response; goto c3290; fc51c: $id = (int) $request->get("\151\x64"); goto C5e66; aba64: EventQueue::addEvent(EventQueue::EVENT_SITE_BLOCKED_BOT_DELETE, $user, $eventData, $request); goto c23ec; c3290: a996c: goto f7e1e; D1b45: $siteUpdater = $this->getSiteUpdater($site); goto dd12c; bcec1: $eventData = ["\163\151\x74\145" => $domainName, "\156\141\x6d\x65" => $blockedBotEntity->getName()]; goto aba64; c65fe: $siteEntity = $this->getSiteEntity($domainName); goto E94cd; cdbe1: $session = $request->getSession(); goto fc51c; E94cd: $blockedBotEntity = $this->blockedBotEntityManager->findOneById($id); goto F26c4; A949e: $this->siteEntityManager->updateEntity($siteEntity); goto D1b45; De4cc: $user = $this->getUser(); goto Dd61c; F26c4: if (!(false === is_null($siteEntity) && false === empty($id) && false === is_null($blockedBotEntity) && $siteEntity == $blockedBotEntity->getSite())) { goto a996c; } goto De4cc; f7e1e: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\x6e\147\145\x72", $this->translator->trans("\101\x6e\x20\145\x72\x72\x6f\x72\x20\x68\141\x73\x20\157\143\143\x75\x72\162\145\x64\x2c\40\x65\162\162\x6f\162\x20\x6d\145\163\163\x61\x67\x65\x3a\40\x25\x65\162\162\x6f\162\115\x65\x73\x73\141\147\x65\x25", ["\45\145\162\162\157\x72\x4d\x65\163\x73\141\147\145\x25" => $e->getMessage()])); } goto Fd2d5; e2964: if (!(false === is_null($site))) { goto c6db7; } goto Eb045; B7b9a: $site = $this->getSite($request); goto e2964; Fd2d5: c6db7: goto D91c3; D91c3: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\163\x69\x74\145\163")); goto D36f6; E55f1: } public function certificates(Request $request) : Response { goto F2082; Fe883: $response = $this->render("\106\162\157\156\164\x65\156\144\57\x53\151\x74\145\57\143\145\x72\164\151\146\x69\x63\x61\164\x65\x73\56\x68\x74\155\x6c\x2e\x74\x77\151\147", ["\163\151\164\145" => $site, "\151\156\x73\x74\141\154\154\x65\x64\103\145\162\164\x69\x66\151\x63\x61\x74\145" => $installedCertificate, "\143\x65\x72\x74\151\146\x69\x63\141\x74\145\163" => $certificates]); goto Cdab8; F2082: $site = $this->getSite($request); goto C68a6; Ffb5a: c23f7: goto cdfe3; Dc19d: $certificates = $site->getCertificates(); goto Fe883; Df237: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\x73\151\x74\x65\x73")); goto Fa7f4; Cdab8: B2206: goto E57d2; C68a6: if (false === is_null($site)) { goto c23f7; } goto Df237; Fa7f4: goto B2206; goto Ffb5a; E57d2: return $response; goto C85df; cdfe3: $installedCertificate = $site->getCertificate(); goto Dc19d; C85df: } public function importCertificate(Request $request) : Response { goto E4973; b106e: $response = $this->redirect($this->generateUrl("\143\154\x70\137\x73\151\164\x65\163")); goto E1a2d; B840a: $form = $this->createImportCertificateForm($certificateEntity); goto D8ac7; F21d0: if (!(false === is_null($response))) { goto Cf556; } goto A7583; cc31e: Cf556: goto c2cc6; A5507: D45f8: goto A8834; f7940: C55e7: goto ae51c; E5a8a: $form->handleRequest($request); goto c39ab; E1a2d: goto D45f8; goto bffb2; ae51c: $response = $this->render("\x46\162\157\156\x74\145\x6e\144\x2f\x53\x69\164\x65\57\x69\155\x70\157\x72\164\55\143\145\162\x74\x69\x66\x69\143\141\164\145\56\x68\164\x6d\x6c\56\164\167\x69\x67", ["\x73\x69\164\145" => $site, "\x66\x6f\x72\x6d" => $form->createView(), "\x66\x6f\162\155\x45\162\162\x6f\x72\163" => $this->formErrors]); goto A5507; A9d5f: $response = $this->handleImportCertificateForm($request, $form, $site); goto F21d0; A7583: return $response; goto cc31e; Ee494: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto cf5fb; f312b: $certificateEntity->setSite($siteEntity); goto B840a; c760e: if (false === is_null($site)) { goto C8fa6; } goto b106e; D8ac7: if (!(true === $request->isMethod("\x50\117\x53\x54"))) { goto C55e7; } goto E5a8a; bef6a: $certificateEntity->setType(CertificateEntity::TYPE_IMPORTED); goto f312b; c39ab: if (!(true === $form->isSubmitted())) { goto F1c5f; } goto A9d5f; E4973: $site = $this->getSite($request); goto c760e; c2cc6: F1c5f: goto f7940; cf5fb: $certificateEntity = $this->certificateEntityManager->createEntity(); goto bef6a; bffb2: C8fa6: goto Ee494; A8834: return $response; goto Ec6f7; Ec6f7: } private function createImportCertificateForm(CertificateEntity $certificateEntity) : Form { goto b8380; b8380: $siteEntity = $certificateEntity->getSite(); goto d546e; D05b4: $form->add("\x73\x75\x62\155\151\x74", SubmitType::class, ["\141\x74\x74\162" => ["\x63\154\x61\x73\163" => "\x62\x74\156\40\x62\x74\x6e\55\142\x6c\165\x65\x20\x62\x74\x6e\x2d\x6c\147"], "\154\141\x62\145\x6c" => "\111\155\x70\157\x72\164\40\x61\156\x64\40\x49\x6e\x73\164\x61\154\154"]); goto F0fd3; d546e: $form = $this->createForm("\101\x70\160\x5c\x46\x6f\162\x6d\x5c\123\151\164\145\x49\155\160\x6f\162\164\103\x65\162\164\x69\x66\x69\143\141\164\145\124\x79\160\x65", $certificateEntity, ["\x61\x63\164\151\x6f\x6e" => $this->generateUrl("\143\154\160\x5f\x73\x69\x74\145\137\x63\x65\x72\x74\151\x66\151\143\141\x74\145\x5f\151\x6d\x70\x6f\162\x74", ["\144\x6f\155\x61\151\x6e\x4e\x61\155\145" => $siteEntity->getDomainName()]), "\155\145\x74\x68\x6f\x64" => "\120\117\x53\124", "\x61\164\164\162" => []]); goto D05b4; F0fd3: return $form; goto f9ec0; f9ec0: } private function handleImportCertificateForm(Request $request, Form $form, Site $site) { goto b2c20; D8de0: try { goto d0936; cfe25: goto Dca27; goto A94a2; C92e7: $siteEntity->setCertificate($certificateEntity); goto b9e58; b9e58: $siteEntity->addCertificate($certificateEntity); goto E66c8; C7cd3: $siteUpdater->installCertificate($certificateEntity); goto C92e7; Cf20f: if (false === is_null($siteEntity)) { goto e2114; } goto e84a4; A94a2: e2114: goto B6c18; b60a8: Dca27: goto A8c8c; fcd06: $session->getFlashBag()->set("\163\x75\143\x63\145\163\163", $this->translator->trans("\x43\145\x72\164\x69\146\151\143\141\x74\x65\x20\150\141\x73\40\x62\145\145\x6e\x20\151\156\x73\164\x61\154\x6c\145\x64\x2e")); goto fc12c; e06c3: $siteUpdater = $this->getSiteUpdater($site); goto C7cd3; d0936: $session = $request->getSession(); goto D1e02; A8c8c: return $response; goto D8c27; fc12c: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\x73\x69\164\145\137\x63\x65\x72\x74\151\x66\151\143\x61\164\x65\163", ["\144\157\x6d\141\x69\x6e\116\141\155\x65" => $site->getDomainName()])); goto b60a8; D1e02: $domainName = $site->getDomainName(); goto C83df; Bc30e: EventQueue::addEvent(EventQueue::EVENT_SITE_CERTIFICATE_INSTALL, $user, $evenData, $request); goto fcd06; aae91: $evenData = ["\x73\x69\x74\x65" => $domainName]; goto Bc30e; eee9c: $certificateEntity = $form->getData(); goto e06c3; C83df: $siteEntity = $this->getSiteEntity($domainName); goto Cf20f; E66c8: $this->siteEntityManager->updateEntity($siteEntity); goto aae91; B6c18: $user = $this->getUser(); goto eee9c; e84a4: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\x73\151\x74\x65\x73")); goto cfe25; D8c27: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\x6e\x67\145\x72", $this->translator->trans("\x41\156\40\x65\x72\162\x6f\162\x20\x68\x61\163\40\x6f\143\143\165\x72\162\x65\144\54\x20\145\x72\162\157\x72\x20\x6d\145\163\x73\141\147\145\x3a\40\45\145\162\162\157\x72\115\x65\163\x73\141\x67\x65\45", ["\45\145\x72\162\157\162\115\145\x73\x73\x61\x67\x65\x25" => $e->getMessage()])); } goto e01fc; C1649: goto c02ae; goto B82dd; e01fc: c02ae: goto b66cc; b2c20: if (true === $form->isValid()) { goto C4b41; } goto Bb60e; Bb60e: $this->formErrors = $this->getErrorMessages($form); goto C1649; B82dd: C4b41: goto D8de0; b66cc: } public function newLetsEncryptCertificate(Request $request) : Response { goto e545c; C5cc9: fc4df: goto ac02f; A6689: $domains = (array) $request->get("\144\x6f\x6d\x61\x69\x6e\x73"); goto d435f; Efd2f: fae46: goto A3911; Bae86: $registrableDomain = $resolvedDomainName->registrableDomain()->toString(); goto c90d8; D4362: $domainName = $site->getDomainName(); goto f8227; Ae3d8: $domains = [$registrableDomain, sprintf("\167\167\x77\x2e\x25\163", $registrableDomain)]; goto A4ddf; e545c: $site = $this->getSite($request); goto ff342; A4ddf: Fb98f: goto a4c00; E626a: Eafe3: goto e1412; fe421: if (!(true === $form->isSubmitted())) { goto dfba0; } goto A6689; Ca39d: goto fae46; goto A15e8; de6fd: return $response; goto C5cc9; ff342: if (false === is_null($site)) { goto F2afa; } goto Eccb8; aa728: $response = $this->render("\x46\162\157\156\x74\145\156\144\x2f\123\x69\164\x65\x2f\156\x65\x77\x2d\154\145\164\163\55\x65\156\x63\x72\x79\x70\x74\x2d\143\x65\162\x74\x69\x66\151\x63\141\164\145\x2e\x68\x74\155\x6c\56\x74\x77\x69\147", ["\x73\151\164\x65" => $site, "\144\x6f\155\x61\x69\156\163" => $domains, "\x66\x6f\x72\155" => $form->createView(), "\146\x6f\162\155\x45\x72\x72\x6f\x72\x73" => $this->formErrors]); goto Efd2f; Eee6b: Ee558: goto aa728; Ce24d: if (true === is_null($subdomain) || "\x77\x77\167" == $subdomain) { goto fedc7; } goto a8704; F4e89: if (!(false === is_null($response))) { goto fc4df; } goto de6fd; Eccb8: $response = $this->redirect($this->generateUrl("\143\154\160\137\x73\x69\x74\145\x73")); goto Ca39d; ac5d7: $response = $this->handleLetsEncryptCertificateForm($request, $form, $site, $domains); goto F4e89; Fcb6e: $domains = array_unique($domains); goto ac5d7; a4c00: goto Ee558; goto E626a; a8704: $domains = [$domainName]; goto D4409; A3911: return $response; goto f3a8b; c90d8: $subdomain = $resolvedDomainName->subDomain()->toString(); goto C90c3; F7fdd: fedc7: goto Ae3d8; d435f: $domains = array_filter($domains, function ($value) { return false === empty(trim($value)); }); goto C5018; ac02f: dfba0: goto Eee6b; A15e8: F2afa: goto D4362; c6d3b: if (true === $request->isMethod("\120\x4f\x53\x54")) { goto Eafe3; } goto cf9b1; C5018: $domains = array_map("\164\162\151\x6d", $domains); goto Fcb6e; D4409: goto Fb98f; goto F7fdd; b64fb: $domains = []; goto c6d3b; cf9b1: $resolvedDomainName = $this->domainNameParser->resolveDomainName($domainName); goto Bae86; C90c3: $subdomain = false === empty($subdomain) ? $subdomain : null; goto Ce24d; f8227: $form = $this->createLetsEncryptCertificateForm($domainName); goto b64fb; e1412: $form->handleRequest($request); goto fe421; f3a8b: } private function createLetsEncryptCertificateForm(string $domainName) : Form { goto C5028; C5028: $form = $this->createForm("\101\160\x70\134\x46\x6f\162\155\134\123\151\x74\x65\x4c\x65\x74\163\105\156\x63\162\x79\160\x74\103\145\162\164\x69\x66\151\143\141\164\145\124\171\160\145", [], ["\x61\x63\164\x69\x6f\156" => $this->generateUrl("\x63\x6c\160\137\x73\x69\164\145\x5f\154\145\164\163\x5f\x65\x6e\143\162\x79\160\x74\x5f\143\x65\x72\x74\x69\x66\151\143\141\164\x65\137\x6e\145\x77", ["\x64\157\x6d\x61\x69\x6e\x4e\141\x6d\145" => $domainName]), "\x6d\x65\x74\150\157\144" => "\120\117\123\x54", "\141\164\x74\x72" => ["\x69\144" => "\x63\x72\145\x61\164\145\55\154\x65\x74\163\x2d\145\156\x63\162\171\x70\164\x2d\143\145\162\164\151\x66\x69\x63\x61\164\145\55\x66\x6f\x72\155"]]); goto ec38c; ec38c: $form->add("\x73\x75\142\155\151\164", SubmitType::class, ["\x61\x74\x74\x72" => ["\x63\154\141\163\163" => "\x62\164\x6e\x20\142\164\x6e\x2d\142\154\x75\x65\x20\x62\x74\156\55\x6c\x67"], "\154\141\x62\145\x6c" => "\x43\162\145\141\x74\x65\40\141\156\x64\40\111\156\x73\x74\x61\154\x6c"]); goto f9836; f9836: return $form; goto f1b20; f1b20: } private function handleLetsEncryptCertificateForm(Request $request, Form $form, Site $site, array $domains) { goto b37de; b37de: if (!(true === $form->isValid())) { goto C6149; } goto A297e; f67a1: $this->formErrors = $this->getErrorMessages($form); goto D0984; A297e: try { goto f4cc0; bc6ba: $session->getFlashBag()->set("\163\165\x63\143\x65\163\163", $this->translator->trans("\x43\145\x72\164\x69\146\x69\x63\141\x74\x65\40\x68\x61\x73\x20\x62\x65\x65\x6e\x20\151\x6e\x73\164\x61\x6c\154\x65\x64\x2e")); goto e0fb2; c70e7: $letsEncryptClient->registerAccount(); goto Bbfb7; c8d7a: $letsEncryptClient = new LetsEncryptClient($privateKey); goto c70e7; Ca4e7: $certificate = $letsEncryptClient->finalizeOrder($certificateOrder, $privateKey, $csr); goto E361d; abbeb: $distinguishedNameDomains = $domains; goto Abff1; B9c56: if (false === is_null($siteEntity)) { goto D89a5; } goto d9d83; C2c27: $privateKey = $rsaKeyGenerator->generatePrivateKey(); goto a5895; cee75: $domainName = $site->getDomainName(); goto E409e; D43c6: return $response; goto Ab4c8; B3a21: $siteEntity->setCertificate($certificateEntity); goto e610e; B12e8: $siteUpdater->installCertificate($certificateEntity); goto B3a21; cc177: $this->siteEntityManager->updateEntity($siteEntity); goto df989; a6667: $certificateEntity->setPrivateKey($certificate->getPrivateKey()); goto a5701; f98b3: $distinguishedName = new DistinguishedName($commonName, $distinguishedNameDomains); goto b1e1c; A6716: A4fbc: goto abbeb; f0235: return $response; goto Cae6c; c1989: $certificateEntity->setType(CertificateEntity::TYPE_LETS_ENCRYPT); goto e919f; f4cc0: $session = $request->getSession(); goto cee75; a5701: $certificateEntity->setCertificate($certificate->getCertificate()); goto E61e0; d9d83: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\x5f\x73\x69\x74\x65\163")); goto f0235; Ab4c8: Ab6a1: goto e4e30; A8566: $user = $this->getUser(); goto Ca027; Cae6c: goto af4e1; goto B7257; Abff1: $commonName = array_shift($distinguishedNameDomains); goto f98b3; e0fb2: $response = $this->redirect($this->generateUrl("\143\154\x70\137\x73\x69\164\145\x5f\x63\145\x72\164\x69\x66\x69\x63\141\x74\145\163", ["\x64\157\155\x61\x69\x6e\116\x61\155\x65" => $site->getDomainName()])); goto D43c6; E61e0: $certificateEntity->setCertificateChain($certificate->getCertificateChain()); goto F6197; D04e5: foreach ($validationErrors as $domain => $validationErrorMessage) { $form->addError(new FormError(sprintf("\x25\163\x3a\40\x25\163", $domain, $validationErrorMessage))); b0e9c: } goto ff247; Edda5: $siteUpdater->deleteLetsEncryptChallengeDirectory(); goto dc144; A4751: if (true === empty($validationErrors)) { goto A4fbc; } goto D04e5; e610e: $siteEntity->addCertificate($certificateEntity); goto cc177; a5895: $csrGenerator = new CsrGenerator($privateKey, $distinguishedName); goto Dbb60; ff247: bdaaa: goto Ed801; e919f: $certificateEntity->setSite($siteEntity); goto a02f3; Bbfb7: $certificateOrder = $letsEncryptClient->requestOrder($domains); goto ce985; E361d: $certificateEntity = $this->certificateEntityManager->createEntity(); goto c1989; e8f7a: EventQueue::addEvent(EventQueue::EVENT_SITE_CERTIFICATE_INSTALL, $user, $evenData, $request); goto bc6ba; Ed801: goto Ab6a1; goto A6716; dc144: $siteUpdater->createLetsEncryptChallengeFiles($certificateOrder); goto D2629; E409e: $siteEntity = $this->getSiteEntity($domainName); goto B9c56; b1e1c: $rsaKeyGenerator = new RsaKeyGenerator(); goto C2c27; a02f3: $certificateEntity->setCsr($certificate->getCsr()); goto a6667; ce985: $siteUpdater = $this->getSiteUpdater($site); goto Edda5; F6197: $siteUpdater = $this->getSiteUpdater($site); goto B12e8; df989: $evenData = ["\163\x69\x74\x65" => $domainName]; goto e8f7a; df8f4: $privateKey = new PrivateKey($letsEncryptPrivateKey); goto c8d7a; D2629: $validationErrors = $letsEncryptClient->validateDomains($certificateOrder); goto A4751; B7257: D89a5: goto A8566; Dbb60: $csr = $csrGenerator->generate(); goto Ca4e7; Ca027: $letsEncryptPrivateKey = $this->configManager->get("\x6c\x65\x5f\160\162\x69\166\x61\164\x65\x5f\x6b\145\x79"); goto df8f4; e4e30: af4e1: goto e5752; e5752: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\x6e\x67\145\162", $this->translator->trans("\x41\156\40\x65\x72\x72\x6f\x72\40\150\141\x73\40\157\143\143\165\162\162\145\x64\54\40\145\x72\x72\157\x72\x20\155\145\x73\x73\x61\147\145\x3a\x20\x25\145\x72\162\x6f\162\115\x65\163\163\141\x67\x65\45", ["\x25\x65\x72\162\157\162\115\145\163\x73\x61\x67\x65\45" => $e->getMessage()])); } finally { if (!(true === isset($siteUpdater))) { goto fd701; } $siteUpdater->deleteLetsEncryptChallengeDirectory(); fd701: } goto a762c; a762c: C6149: goto f67a1; D0984: } public function installCertificate(Request $request) : Response { goto Ca096; C2bd2: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\x69\x74\x65\163")); goto a7b8e; Ff04d: e99a8: goto C2bd2; a7b8e: return $response; goto ecaf2; C2cf1: try { goto b2cca; e4352: if (!(false === is_null($siteEntity) && false === empty($uid) && false === is_null($certificateEntity))) { goto F0c65; } goto eb142; E0610: EventQueue::addEvent(EventQueue::EVENT_SITE_CERTIFICATE_INSTALL, $user, $evenData, $request); goto e0ebf; B74a5: $siteUpdater->installCertificate($certificateEntity); goto ac655; ac655: $siteEntity->setCertificate($certificateEntity); goto c94a3; E4d14: $domainName = $site->getDomainName(); goto D1385; eb142: $certificateSiteEntity = $certificateEntity->getSite(); goto f7613; D4bdf: return $response; goto C0a53; E05e4: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\151\x74\x65\137\143\x65\x72\x74\151\146\x69\x63\x61\164\x65\163", ["\144\x6f\x6d\x61\x69\x6e\116\x61\x6d\145" => $site->getDomainName()])); goto D4bdf; b2cca: $session = $request->getSession(); goto d37fa; E7bf2: $certificateEntity = $this->certificateEntityManager->findOneByUid($uid); goto e4352; b9881: $siteUpdater = $this->getSiteUpdater($site); goto B74a5; D7d6c: $user = $this->getUser(); goto b9881; f7613: if (!($siteEntity->getDomainName() == $certificateSiteEntity->getDomainName() && $siteEntity->getCertificate() != $certificateSiteEntity)) { goto c9afc; } goto D7d6c; B5abc: $evenData = ["\163\151\164\x65" => $domainName]; goto E0610; c8a59: F0c65: goto Ac59a; e0ebf: $session->getFlashBag()->set("\163\x75\x63\143\x65\163\x73", $this->translator->trans("\103\145\x72\164\151\146\x69\143\x61\164\145\x20\x68\141\163\x20\142\x65\145\156\x20\151\156\163\164\x61\154\154\145\144\x2e")); goto E05e4; D1385: $siteEntity = $this->getSiteEntity($domainName); goto E7bf2; c94a3: $this->siteEntityManager->updateEntity($siteEntity); goto B5abc; d37fa: $uid = $request->get("\x75\151\x64"); goto E4d14; C0a53: c9afc: goto c8a59; Ac59a: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\x61\x6e\x67\145\x72", $this->translator->trans("\x41\156\40\145\x72\x72\157\162\x20\x68\141\x73\x20\157\143\x63\165\x72\x72\145\x64\x2c\40\x65\162\x72\x6f\x72\40\155\145\x73\x73\x61\147\x65\x3a\x20\45\145\x72\x72\157\x72\x4d\x65\x73\163\x61\147\x65\45", ["\x25\x65\x72\162\x6f\x72\x4d\x65\163\x73\141\147\x65\45" => $e->getMessage()])); } goto Ff04d; Ca096: $site = $this->getSite($request); goto Fb0ee; Fb0ee: if (!(false === is_null($site))) { goto e99a8; } goto C2cf1; ecaf2: } public function deleteCertificate(Request $request) : Response { goto b37bf; F7d0e: try { goto C00de; F75b3: $certificateSiteEntity = $certificateEntity->getSite(); goto cd595; A0079: $session->getFlashBag()->set("\163\x75\143\143\145\x73\163", $this->translator->trans("\x43\x65\162\x74\x69\146\151\x63\141\x74\x65\40\x68\141\x73\x20\x62\145\x65\x6e\x20\144\145\x6c\x65\164\145\144\56")); goto Efa28; Bc834: d6c10: goto c6897; B2c9a: $domainName = $site->getDomainName(); goto dca29; dca29: $siteEntity = $this->getSiteEntity($domainName); goto bd34b; e19e7: if (!(false === is_null($siteEntity) && false === empty($uid) && false === is_null($certificateEntity) && false === $certificateEntity->getDefaultCertificate())) { goto d6c10; } goto F75b3; a2958: $siteEntity->removeCertificate($certificateEntity); goto A1945; A1945: $this->siteEntityManager->updateEntity($siteEntity); goto C4211; C4211: $evenData = ["\x73\x69\x74\x65" => $domainName]; goto D430b; d5a22: $user = $this->getUser(); goto a2958; C00de: $session = $request->getSession(); goto Bd62b; Efa28: $response = $this->redirect($this->generateUrl("\143\x6c\160\x5f\x73\x69\x74\x65\x5f\143\145\162\x74\151\146\151\143\141\x74\145\x73", ["\144\x6f\155\x61\x69\156\x4e\141\155\145" => $site->getDomainName()])); goto Bffaa; Bffaa: return $response; goto C907e; cd595: if (!($siteEntity->getDomainName() == $certificateSiteEntity->getDomainName() && $siteEntity->getCertificate() != $certificateSiteEntity)) { goto Ea3ea; } goto d5a22; C907e: Ea3ea: goto Bc834; Bd62b: $uid = $request->get("\x75\x69\x64"); goto B2c9a; bd34b: $certificateEntity = $this->certificateEntityManager->findOneByUid($uid); goto e19e7; D430b: EventQueue::addEvent(EventQueue::EVENT_SITE_CERTIFICATE_DELETE, $user, $evenData, $request); goto A0079; c6897: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\156\x67\145\x72", $this->translator->trans("\101\x6e\x20\145\162\162\157\162\x20\150\141\163\x20\157\x63\x63\x75\x72\x72\145\144\x2c\x20\145\162\x72\157\x72\40\x6d\x65\163\x73\x61\147\145\x3a\40\x25\145\x72\x72\157\x72\x4d\x65\x73\x73\141\147\x65\45", ["\x25\x65\162\162\157\162\115\x65\163\163\x61\147\145\x25" => $e->getMessage()])); } goto b2a7a; b2a7a: Fb1de: goto D1bfc; D1bfc: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\x5f\x73\x69\x74\145\x73")); goto e0a0e; f0fcc: if (!(false === is_null($site))) { goto Fb1de; } goto F7d0e; e0a0e: return $response; goto bed74; b37bf: $site = $this->getSite($request); goto f0fcc; bed74: } public function databases(Request $request) : Response { goto C2323; A8dbd: $databaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto e9a2a; bd525: $databases = $site->getDatabases(); goto A8dbd; F82d0: $response = $this->redirect($this->generateUrl("\143\154\x70\137\163\x69\164\145\163")); goto bfd4b; Cd04d: return $response; goto Ca934; bd40e: D7f27: goto Ce7b1; C2323: $site = $this->getSite($request); goto Ceed8; E23e3: foreach ($databases as $database) { $numberOfDatabaseUsers += count($database->getUsers()); d5d2c: } goto bd40e; bfd4b: goto D2760; goto F0825; Ce7b1: $response = $this->render("\x46\162\157\156\164\x65\156\x64\57\123\151\x74\145\x2f\144\x61\x74\x61\142\x61\163\145\163\56\150\x74\x6d\154\x2e\x74\x77\151\147", ["\163\x69\x74\145" => $site, "\x64\x61\x74\x61\x62\x61\163\145\x73" => $databases, "\x6e\x75\155\x62\x65\162\117\146\104\x61\x74\141\142\141\x73\145\x55\x73\145\162\x73" => $numberOfDatabaseUsers, "\x64\x61\164\x61\142\141\163\145\123\145\x72\166\145\x72" => $databaseServerEntity]); goto Adc6f; Adc6f: D2760: goto Cd04d; F0825: a8ea3: goto bd525; e9a2a: $numberOfDatabaseUsers = 0; goto E23e3; Ceed8: if (false === is_null($site)) { goto a8ea3; } goto F82d0; Ca934: } public function newDatabase(Request $request) : Response { goto C9e8c; F3818: $databaseEntity->setSite($siteEntity); goto Dbfb0; C9e8c: $site = $this->getSite($request); goto F0ec6; beb79: if (!(true === $request->isMethod("\x50\x4f\123\124"))) { goto bed62; } goto cc1d0; C9531: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\x69\x74\x65\x73")); goto ce5b7; d9e26: A8e78: goto b5637; b25f2: $response = $this->render("\106\x72\157\x6e\164\145\156\144\x2f\123\151\164\x65\x2f\156\145\167\x2d\144\x61\x74\x61\x62\141\163\145\x2e\150\x74\x6d\154\x2e\164\167\x69\147", ["\163\151\164\145" => $site, "\x66\157\162\155" => $form->createView(), "\146\x6f\162\x6d\x45\x72\x72\157\162\163" => $this->formErrors]); goto a5e7e; b5637: dbeeb: goto f1fb2; A9e47: return $response; goto d9e26; D8af5: C349f: goto bbf66; bbf66: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto E58a0; ce5b7: goto E2a8b; goto D8af5; a5e7e: E2a8b: goto D2ff4; F0ec6: if (false === is_null($site)) { goto C349f; } goto C9531; D2ff4: return $response; goto Ed1eb; Bd332: if (!(false === is_null($response))) { goto A8e78; } goto A9e47; Dbfb0: $form = $this->createDatabaseForm($site, $databaseEntity); goto beb79; Baacd: $response = $this->handleDatabaseForm($request, $form, $site); goto Bd332; E0877: if (!(true === $form->isSubmitted())) { goto dbeeb; } goto Baacd; f1fb2: bed62: goto b25f2; E58a0: $databaseEntity = $this->databaseEntityManager->createEntity(); goto F3818; cc1d0: $form->handleRequest($request); goto E0877; Ed1eb: } private function createDatabaseForm(Site $site, DatabaseEntity $databaseEntity) : Form { goto E591c; C556b: $form->add("\x73\x75\x62\x6d\151\164", SubmitType::class, ["\x61\164\x74\162" => ["\143\x6c\141\x73\x73" => "\142\x74\156\40\x62\164\156\x2d\x62\154\x75\145\x20\x62\x74\156\x2d\x6c\x67"], "\154\141\142\145\154" => "\101\x64\x64\40\x44\x61\164\x61\x62\x61\163\x65"]); goto E7d62; E7d62: return $form; goto E9eaa; E591c: $form = $this->createForm("\x41\x70\x70\134\106\x6f\162\155\134\x53\x69\164\x65\x44\141\x74\141\x62\x61\163\x65\124\171\x70\x65", $databaseEntity, ["\x61\x63\x74\151\x6f\156" => $this->generateUrl("\143\154\160\x5f\163\151\x74\145\137\x64\141\x74\141\x62\141\163\x65\137\156\145\x77", ["\x64\157\155\141\151\156\116\141\155\145" => $site->getDomainName()]), "\x6d\145\x74\x68\x6f\x64" => "\120\x4f\123\124", "\x61\164\x74\x72" => []]); goto C556b; E9eaa: } private function handleDatabaseForm(Request $request, Form $form, Site $site) { goto Ef9ac; Ef9ac: if (true === $form->isValid()) { goto f6953; } goto fa9be; A8dcc: f6953: goto da0b2; Dedac: goto c3003; goto A8dcc; fa9be: $this->formErrors = $this->getErrorMessages($form); goto Dedac; da0b2: try { goto Ac399; d28ee: if (false === is_null($siteEntity)) { goto eca79; } goto Fbcde; B3bbe: goto fd480; goto Adbb7; Ce287: $databaseUserName = $form->get("\x75\163\145\162\x4e\141\x6d\x65")->getData(); goto C5a66; D3d63: $siteEntity->addDatabase($databaseEntity); goto cfd01; De0c8: $databaseManager->createUser($databaseUserEntity); goto cac62; C5a66: $databaseUserPassword = $form->get("\x75\163\145\162\x50\141\163\x73\x77\x6f\162\144")->getData(); goto c2adb; Fbcde: $response = $this->redirect($this->generateUrl("\143\154\x70\137\163\151\164\x65\x5f\x64\x61\164\141\x62\141\x73\x65\x5f\x6e\145\x77", ["\144\157\x6d\x61\x69\156\116\x61\155\x65" => $site->getDomainName()])); goto B3bbe; c17f7: $databaseEntity->addUser($databaseUserEntity); goto D3d63; c2adb: $databaseUserEntity = $this->databaseUserEntityManager->createEntity(); goto D9a09; D9a09: $databaseUserEntity->setUserName($databaseUserName); goto c294f; c64ca: fd480: goto df0d5; d350a: $session = $request->getSession(); goto Eab29; a4f8b: EventQueue::addEvent(EventQueue::EVENT_SITE_DATABASE_ADD, $user, $eventData, $request); goto b258d; bab9c: $databaseEntity = $form->getData(); goto B4edf; cfd01: $databaseManager->createDatabase($databaseEntity); goto De0c8; df0d5: return $response; goto ad246; Ee83d: $databaseEntity->setSite($siteEntity); goto Ce287; f39dc: $databaseUserEntity->setPermissions(DatabaseUserEntity::PERMISSIONS_READ_WRITE); goto ead94; ead94: $databaseUserEntity->setDatabase($databaseEntity); goto c17f7; cac62: $this->siteEntityManager->updateEntity($siteEntity); goto a335d; Ffe8b: $response = $this->redirect($this->generateUrl("\x63\154\x70\137\163\151\164\x65\137\144\x61\164\x61\142\141\163\x65\x73", ["\144\157\x6d\x61\151\156\x4e\x61\x6d\145" => $site->getDomainName()])); goto c64ca; c294f: $databaseUserEntity->setPassword(Crypto::encrypt($databaseUserPassword)); goto f39dc; Ac399: $user = $this->getUser(); goto d350a; b185d: $databaseEntity->setDatabaseServer($activeDatabaseServerEntity); goto Ee83d; a335d: $eventData = ["\163\151\164\145" => $domainName, "\x64\x61\164\x61\142\141\x73\x65" => $databaseEntity->getName(), "\x64\x61\164\141\x62\141\x73\x65\x55\x73\145\x72\116\141\155\145" => $databaseUserEntity->getUserName()]; goto a4f8b; Bb85e: $databaseManager = new DatabaseManager($activeDatabaseServerEntity); goto b185d; b258d: $session->getFlashBag()->set("\163\165\143\x63\145\163\163", $this->translator->trans("\104\x61\x74\141\142\x61\x73\x65\x20\150\141\x73\40\x62\145\145\156\40\x61\144\x64\x65\144\56")); goto Ffe8b; Eab29: $domainName = $site->getDomainName(); goto c845f; c845f: $siteEntity = $this->getSiteEntity($domainName); goto d28ee; B4edf: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto Bb85e; Adbb7: eca79: goto bab9c; ad246: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\x67\145\162", $this->translator->trans("\x41\x6e\40\x65\162\x72\x6f\x72\40\150\x61\x73\x20\157\143\143\165\x72\x72\145\144\x2c\40\x65\162\x72\x6f\x72\40\x6d\145\163\163\141\x67\x65\72\40\45\145\162\162\x6f\x72\115\x65\163\163\x61\147\x65\45", ["\45\145\162\162\157\x72\x4d\145\163\x73\141\147\145\45" => $e->getMessage()])); } goto e6772; e6772: c3003: goto ed77a; ed77a: } public function deleteDatabase(Request $request) : Response { goto d828c; A3b9a: $databaseName = $request->get("\144\x61\164\141\x62\141\163\x65\116\x61\x6d\x65"); goto D7e84; F17f6: $siteEntity = $this->getSiteEntity($site->getDomainName()); goto e3b4c; a192a: return $response; goto F4c4c; D7e84: $databaseEntity = $this->databaseEntityManager->findOneByName($databaseName); goto F17f6; F4c4c: a8e95: goto f074d; f074d: f4163: goto Af6e5; Fb99f: $response = $this->redirect($this->generateUrl("\x63\154\x70\x5f\x73\151\164\x65\137\144\141\164\x61\x62\x61\x73\x65\x73", ["\x64\157\155\141\x69\156\x4e\141\155\145" => $site->getDomainName()])); goto a192a; Af6e5: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\x73\151\x74\145\163")); goto E3d68; de5ef: try { goto b2786; d3135: $databaseManager->deleteDatabase($databaseEntity, true); goto a81d6; fa9e7: $session = $request->getSession(); goto E64d7; b5d94: $this->siteEntityManager->updateEntity($siteEntity); goto Ea068; C505f: $databaseManager = new DatabaseManager($databaseServerEntity); goto d3135; Ee13a: $session->getFlashBag()->set("\163\165\x63\143\145\163\x73", $this->translator->trans("\104\x61\164\141\x62\141\163\x65\40\150\x61\x73\x20\x62\145\145\156\x20\144\145\x6c\145\x74\145\x64\x2e")); goto ec749; a81d6: $siteEntity->removeDatabase($databaseEntity); goto b5d94; A9086: EventQueue::addEvent(EventQueue::EVENT_SITE_DATABASE_DELETE, $user, $eventData, $request); goto Ee13a; b2786: $user = $this->getUser(); goto fa9e7; E64d7: $domainName = $site->getDomainName(); goto c3bf4; Ea068: $eventData = ["\x73\151\x74\x65" => $domainName, "\144\141\x74\x61\x62\x61\x73\x65" => $databaseEntity->getName()]; goto A9086; c3bf4: $databaseServerEntity = $databaseEntity->getDatabaseServer(); goto C505f; ec749: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\156\x67\145\162", $this->translator->trans("\x41\156\40\145\162\x72\x6f\162\x20\150\141\x73\x20\157\x63\143\165\162\x72\145\144\54\40\x65\162\x72\157\162\x20\x6d\145\x73\163\x61\x67\145\x3a\40\x25\145\162\x72\x6f\x72\x4d\145\163\163\x61\x67\145\x25", ["\45\x65\x72\162\157\x72\115\x65\x73\x73\141\147\145\x25" => $e->getMessage()])); } goto Fb99f; d828c: $site = $this->getSite($request); goto a9449; a9449: if (!(false === is_null($site))) { goto f4163; } goto A3b9a; E3d68: return $response; goto fd08b; e3b4c: if (!(false === is_null($databaseEntity) && $site->getDomainName() == $databaseEntity->getSite()->getDomainName() && false === is_null($siteEntity))) { goto a8e95; } goto de5ef; fd08b: } public function phpMyAdmin(Request $request) : Response { goto Aae78; A1fc2: $response = new RedirectResponse($phpMyAdminUrl); goto de44a; B510b: if (!(false === is_null($activeDatabaseServerEntity))) { goto Cc2d5; } goto cce2d; Cd24e: $response->headers->clearCookie("\x53\151\147\x6e\x6f\156\x53\145\163\163\x69\157\x6e"); goto A1762; d529d: Bcfdf: goto ff840; c907d: return $response; goto Fe0b6; b1396: F126e: goto fe3f8; d2fe3: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto fe5f4; fe879: $response = new RedirectResponse($phpMyAdminUrl); goto c0f92; C90b6: $databaseUserEntity = $this->databaseUserEntityManager->findOneByUserName($databaseUserName); goto d2fe3; cc849: return $response; goto ff641; Aae78: $domainName = $request->get("\x64\157\x6d\x61\x69\156\x4e\141\x6d\145"); goto a4853; A3e5e: Cc2d5: goto cc856; a68b1: $databaseUserName = $request->get("\x64\141\164\141\142\x61\x73\145\x55\163\x65\x72\116\141\x6d\145"); goto C90b6; Fe0b6: A10ec: goto e55ad; e14a7: if (!(false === is_null($site))) { goto F126e; } goto a68b1; Ca670: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto B510b; Bfc0c: $databaseServerPort = $activeDatabaseServerEntity->getPort(); goto f8fe8; F71f4: $encryptedData = Crypto::encrypt($data); goto Dcdeb; c0f92: $response->headers->setCookie($cookie); goto c907d; cce2d: $databaseServerHost = urlencode(base64_encode($activeDatabaseServerEntity->getHost())); goto Bfc0c; E51b9: $databaseServerHost = urlencode(base64_encode($activeDatabaseServerEntity->getHost())); goto F082b; Fdef0: $response->headers->clearCookie("\160\150\160\115\x79\101\x64\155\151\156\x5f\x68\x74\x74\x70\163"); goto de5d3; d6add: if (!(false === is_null($databaseEntity) && $site->getDomainName() == $databaseEntity->getSite()->getDomainName())) { goto A10ec; } goto E51b9; f8fe8: $phpMyAdminUrl = sprintf("\150\164\x74\x70\163\72\x2f\57\45\x73\x3a\x25\163\x2f\x70\150\160\155\171\141\x64\x6d\x69\156\x2f\154\157\x67\x69\156\x2e\160\150\160\77\x68\x6f\163\164\x3d\45\163\x26\160\157\x72\164\x3d\x25\x73", $request->getHost(), $request->getPort(), $databaseServerHost, $databaseServerPort); goto A1fc2; Dcdeb: $encryptedData = trim(base64_encode($encryptedData)); goto d2c3f; a4853: if (false === is_null($domainName)) { goto Bcfdf; } goto Ca670; Ae755: $phpMyAdminUrl = sprintf("\x68\164\164\x70\163\x3a\57\x2f\45\x73\x3a\x25\163\57\160\x68\160\155\x79\141\x64\x6d\151\x6e\x2f\x6c\157\x67\x69\156\x2e\x70\x68\160\77\x68\x6f\163\x74\x3d\x25\x73\46\160\157\162\x74\x3d\45\x73", $request->getHost(), $request->getPort(), $databaseServerHost, $databaseServerPort); goto c4364; dc6d3: $data = serialize($data); goto F71f4; F082b: $databaseServerPort = $activeDatabaseServerEntity->getPort(); goto Ae755; fe5f4: if (!(false === is_null($activeDatabaseServerEntity) && false === is_null($activeDatabaseServerEntity))) { goto b6f2b; } goto b23fd; cc856: goto d8108; goto d529d; c4364: $data = ["\x68\157\163\x74" => $activeDatabaseServerEntity->getHost(), "\165\x73\145\x72\x4e\141\155\x65" => $databaseUserEntity->getUserName(), "\160\x61\163\x73\167\x6f\x72\144" => $databaseUserEntity->getDecryptedPassword(), "\x70\157\162\164" => $activeDatabaseServerEntity->getPort()]; goto dc6d3; ff840: $site = $this->getSite($request); goto e14a7; b23fd: $databaseEntity = $databaseUserEntity->getDatabase(); goto d6add; A1762: return $response; goto A3e5e; e55ad: b6f2b: goto b1396; de44a: $response->headers->clearCookie("\143\x6c\x70\x2d\160\155\x61"); goto Fdef0; fe3f8: d8108: goto a28ef; de5d3: $response->headers->clearCookie("\x70\x6d\141\101\165\164\150\x2d\x31\137\x68\x74\x74\160\x73"); goto Cd24e; d2c3f: $cookie = new Cookie("\143\154\x70\55\x70\x6d\x61", $encryptedData); goto fe879; a28ef: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\163\x69\164\x65\x73")); goto cc849; ff641: } public function phpMyAdminLogout(Request $request) { goto eb4bc; E242f: $response->headers->clearCookie("\143\x6c\160\55\x70\x6d\x61"); goto e076d; e076d: $response->headers->clearCookie("\160\150\160\115\x79\x41\x64\155\151\156\137\x68\164\164\160\163"); goto Ce31b; Ce31b: $response->headers->clearCookie("\160\155\x61\x41\x75\x74\150\x2d\x31\x5f\150\x74\x74\x70\x73"); goto Aa188; eb4bc: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\151\164\145\163")); goto E242f; A8210: return $response; goto Fe85a; Aa188: $response->headers->clearCookie("\x53\x69\x67\156\157\156\123\x65\163\x73\x69\157\x6e"); goto A8210; Fe85a: } public function newDatabaseUser(Request $request) : Response { goto bce64; bce64: $site = $this->getSite($request); goto bfaae; b2033: return $response; goto ef318; Cc761: $siteEntity = $this->getSiteEntity($domainName); goto ef59e; F9f3a: $response = $this->render("\106\162\x6f\156\x74\x65\x6e\x64\x2f\123\151\x74\x65\x2f\156\145\x77\55\144\x61\164\141\x62\141\163\x65\55\x75\163\x65\x72\x2e\150\164\155\154\x2e\164\167\x69\147", ["\163\151\164\x65" => $site, "\x64\141\164\141\x62\141\163\145\x55\163\x65\162" => $databaseUserEntity, "\x64\x61\x74\x61\x62\141\x73\x65\x73" => $databases, "\146\157\162\x6d" => $form->createView(), "\146\157\x72\155\x45\x72\x72\157\162\x73" => $this->formErrors]); goto a6a1e; C9e2f: ac6d5: goto b1803; Ab2f1: $domainName = $site->getDomainName(); goto Cc761; F7628: $databaseUserEntity = $this->databaseUserEntityManager->createEntity(); goto f71c5; Baec0: d1615: goto F9f3a; B11e0: goto Bdaaa; goto Db288; F0455: $form->handleRequest($request); goto Fe2cf; A0088: if (!(false === is_null($response))) { goto ac6d5; } goto ef676; a6a1e: Bdaaa: goto b824d; b1803: D6227: goto Baec0; e760c: $form = $this->createDatabaseUserForm($site, $databaseUserEntity); goto f5abb; f5abb: if (!(true === $request->isMethod("\x50\x4f\123\124"))) { goto d1615; } goto F0455; Fe2cf: if (!(true === $form->isSubmitted())) { goto D6227; } goto Fbd05; bfaae: if (false === is_null($site)) { goto e0626; } goto D926a; f71c5: $databaseUserEntity->setSite($siteEntity); goto e760c; ab078: $session->getFlashBag()->set("\x64\141\x6e\147\145\162", $this->translator->trans("\116\157\x20\x64\141\164\x61\x62\141\x73\x65\x20\146\157\165\x6e\144\x3b\40\143\x72\x65\141\164\x65\x20\141\40\144\x61\x74\141\142\141\x73\145\x20\x66\151\162\163\x74\x2e")); goto bf71c; ef676: return $response; goto C9e2f; D0c1c: $session = $request->getSession(); goto ab078; Bac57: goto b9d9a; goto D224a; ef59e: if (count($databases) && false === is_null($siteEntity)) { goto cfd66; } goto D0c1c; b824d: b9d9a: goto b2033; D224a: e0626: goto f269a; bf71c: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\x69\164\145\137\x64\141\x74\x61\x62\x61\163\145\x73", ["\144\x6f\155\141\151\156\x4e\141\155\145" => $site->getDomainName()])); goto B11e0; Db288: cfd66: goto F7628; Fbd05: $response = $this->handleDatabaseUserForm($request, $form, $site); goto A0088; D926a: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\151\164\x65\x73")); goto Bac57; f269a: $databases = $site->getDatabases(); goto Ab2f1; ef318: } private function createDatabaseUserForm(Site $site, DatabaseUserEntity $databaseUserEntity) : Form { goto b4cfe; b4cfe: $form = $this->createForm("\101\160\x70\134\106\157\x72\x6d\134\x53\151\x74\x65\104\141\x74\x61\x62\x61\x73\145\125\x73\x65\162\124\171\x70\145", $databaseUserEntity, ["\x61\143\x74\151\157\x6e" => $this->generateUrl("\x63\x6c\x70\x5f\163\151\164\145\137\144\x61\x74\141\142\x61\x73\145\x5f\165\x73\x65\162\x5f\156\145\x77", ["\144\157\x6d\x61\151\156\x4e\141\155\145" => $site->getDomainName()]), "\x6d\x65\x74\150\157\144" => "\x50\117\123\124", "\141\164\x74\x72" => []]); goto Ef92c; Ef92c: $form->add("\163\x75\142\155\151\164", SubmitType::class, ["\141\x74\164\162" => ["\x63\154\x61\163\163" => "\x62\164\156\x20\x62\164\156\55\142\154\x75\x65\x20\x62\x74\156\x2d\154\147"], "\x6c\x61\x62\x65\x6c" => "\x41\144\144\x20\x44\141\164\141\x62\x61\x73\145\x20\x55\x73\x65\162"]); goto E6841; E6841: return $form; goto Bc772; Bc772: } private function handleDatabaseUserForm(Request $request, Form $form, Site $site) { goto c3cee; eddf7: F00d3: goto E4d4f; F7eb0: B63c4: goto e091c; Fcf5a: $this->formErrors = $this->getErrorMessages($form); goto Ff009; Ff009: goto F00d3; goto F7eb0; e091c: try { goto Dc7b9; b9907: $databaseManager = new DatabaseManager($activeDatabaseServerEntity); goto b3766; cf78a: $siteEntity = $this->getSiteEntity($domainName); goto Dee77; Cd780: d479d: goto A473f; C7e99: $this->databaseUserEntityManager->updateEntity($databaseUserEntity); goto E8c7f; Ca368: $domainName = $site->getDomainName(); goto cf78a; f533b: $encryptedPassword = Crypto::encrypt($databaseUserEntity->getPassword()); goto Bec30; Bec30: $databaseUserEntity->setPassword($encryptedPassword); goto e4b6c; f3306: a7000: goto E5ca7; Dc7b9: $user = $this->getUser(); goto f7fcc; F0f2f: $session->getFlashBag()->set("\163\x75\x63\x63\145\163\x73", $this->translator->trans("\x44\141\x74\141\142\x61\x73\x65\x20\125\x73\145\162\40\150\141\163\40\x62\145\x65\156\40\x61\x64\144\x65\x64\56")); goto ad025; E5ca7: $databaseUserEntity = $form->getData(); goto f533b; ad025: $response = $this->redirect($this->generateUrl("\143\154\x70\137\163\151\x74\145\x5f\x64\x61\x74\x61\x62\x61\x73\x65\x73", ["\x64\x6f\x6d\x61\x69\156\x4e\x61\x6d\145" => $site->getDomainName()])); goto Cd780; acbfe: EventQueue::addEvent(EventQueue::EVENT_SITE_DATABASE_USER_ADD, $user, $eventData, $request); goto F0f2f; e4b6c: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto b9907; E8c7f: $databaseEntity = $databaseUserEntity->getDatabase(); goto c947e; ae111: goto d479d; goto f3306; E77b6: $response = $this->redirect($this->generateUrl("\x63\x6c\160\x5f\x73\x69\164\x65\x5f\144\x61\164\141\142\141\x73\145\x5f\x75\163\145\162\137\156\145\167", ["\x64\x6f\155\141\x69\x6e\116\141\x6d\x65" => $site->getDomainName()])); goto ae111; b3766: $databaseManager->createUser($databaseUserEntity); goto C7e99; c07f9: $eventData = ["\x73\151\164\145" => $domainName, "\144\141\164\141\142\141\x73\x65\125\163\145\162\116\x61\155\145" => $databaseUserEntity->getUserName(), "\160\x65\x72\155\x69\x73\163\x69\x6f\156\163" => $databaseUserEntity->getPermissions(), "\144\x61\164\141\142\141\x73\145" => $databaseName]; goto acbfe; f7fcc: $session = $request->getSession(); goto Ca368; Dee77: if (false === is_null($siteEntity)) { goto a7000; } goto E77b6; c947e: $databaseName = $databaseEntity->getName(); goto c07f9; A473f: return $response; goto Fbaa7; Fbaa7: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\x6e\x67\145\x72", $this->translator->trans("\x41\x6e\40\x65\x72\x72\157\162\40\150\x61\163\40\157\x63\143\x75\162\162\145\x64\x2c\40\145\x72\162\157\x72\x20\x6d\x65\x73\x73\141\x67\145\x3a\x20\x25\x65\162\162\x6f\162\115\145\x73\x73\141\x67\x65\x25", ["\45\x65\x72\x72\157\162\115\145\x73\x73\141\147\x65\x25" => $e->getMessage()])); } goto eddf7; c3cee: if (true === $form->isValid()) { goto B63c4; } goto Fcf5a; E4d4f: } public function editDatabaseUser(Request $request) : Response { goto A519f; F2a8d: $session = $request->getSession(); goto bcf2f; aef1b: if (count($databases) && false === is_null($siteEntity)) { goto E0662; } goto F2a8d; B65f5: C6dcf: goto Eb180; f6ff2: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\x73\x69\164\x65\163")); goto d0fd8; d1ae8: $response = $this->redirect($this->generateUrl("\x63\154\160\137\163\151\164\x65\137\x64\x61\164\141\x62\141\x73\145\x73", ["\x64\157\155\141\x69\x6e\116\x61\x6d\145" => $site->getDomainName()])); goto a9d31; cc974: D9ad0: goto Ea04d; eb8b5: if (!(true === $form->isSubmitted())) { goto F74cc; } goto F8480; A8450: F74cc: goto cc974; ea86a: $databaseUserEntity = $this->databaseUserEntityManager->findOneByUserName($databaseUserName); goto Baec1; d01d4: $domainName = $site->getDomainName(); goto Eb456; Eb180: E7ba8: goto b0815; Abd7b: if (false === is_null($site)) { goto E924a; } goto f6ff2; bcf2f: $session->getFlashBag()->set("\x64\x61\x6e\147\x65\x72", $this->translator->trans("\x4e\157\40\144\x61\164\x61\x62\x61\163\x65\40\x66\157\165\x6e\144\x3b\x20\143\x72\145\x61\164\x65\x20\141\40\144\141\x74\141\x62\x61\x73\145\40\146\151\x72\x73\164\x2e")); goto d1ae8; b0815: return $response; goto Ecb35; A02b0: $databaseUserName = $request->get("\144\x61\164\x61\x62\x61\x73\145\125\163\145\162\116\141\155\x65"); goto ea86a; Baec1: if (!(false === is_null($databaseUserEntity))) { goto F0551; } goto f4e39; Fb8cd: $form = $this->createDatabaseUserEditForm($site, $databaseUserEntity); goto b1adc; Ea04d: $response = $this->render("\106\x72\157\x6e\164\145\x6e\144\x2f\x53\151\164\x65\57\145\x64\151\164\55\144\141\x74\x61\142\x61\x73\145\x2d\165\x73\x65\x72\x2e\x68\164\155\x6c\x2e\164\x77\151\x67", ["\163\151\x74\x65" => $site, "\144\x61\164\x61\x62\141\163\145\x55\163\145\162" => $databaseUserEntity, "\x66\x6f\x72\155" => $form->createView(), "\x66\x6f\x72\155\x45\x72\x72\x6f\162\x73" => $this->formErrors]); goto C96b8; bd746: if (!(false === is_null($response))) { goto e650e; } goto e9337; f4e39: $databaseUserEntity->setPassword(''); goto Fb8cd; f381c: e650e: goto A8450; a9d31: goto C6dcf; goto ea4cb; ea4cb: E0662: goto A02b0; B5f1b: E924a: goto d0141; e9337: return $response; goto f381c; Eb456: $siteEntity = $this->getSiteEntity($domainName); goto aef1b; d0fd8: goto E7ba8; goto B5f1b; beec6: $form->handleRequest($request); goto eb8b5; C96b8: F0551: goto B65f5; d0141: $databases = $site->getDatabases(); goto d01d4; F8480: $response = $this->handleDatabaseUserEditForm($request, $form, $site); goto bd746; b1adc: if (!(true === $request->isMethod("\x50\117\x53\124"))) { goto D9ad0; } goto beec6; A519f: $site = $this->getSite($request); goto Abd7b; Ecb35: } private function createDatabaseUserEditForm(Site $site, DatabaseUserEntity $databaseUserEntity) : Form { goto ba1d3; ba1d3: $form = $this->createForm("\101\x70\160\134\x46\157\162\x6d\134\x53\x69\x74\x65\x44\141\164\141\142\141\x73\145\125\x73\x65\162\x45\144\151\164\124\x79\x70\145", $databaseUserEntity, ["\141\143\164\x69\x6f\156" => $this->generateUrl("\143\154\x70\137\x73\x69\x74\145\x5f\144\x61\164\x61\142\141\163\145\x5f\165\163\145\162\x5f\x65\x64\x69\x74", ["\x64\157\x6d\x61\x69\x6e\x4e\x61\155\x65" => $site->getDomainName(), "\x64\141\x74\141\x62\x61\163\145\125\x73\x65\162\116\x61\x6d\145" => $databaseUserEntity->getUserName()]), "\x6d\x65\164\x68\157\x64" => "\x50\117\x53\x54", "\x61\x74\164\x72" => []]); goto F9a31; F9a31: $form->add("\x73\x75\142\x6d\x69\x74", SubmitType::class, ["\x61\164\164\x72" => ["\143\x6c\x61\163\163" => "\x62\164\x6e\40\x62\164\x6e\x2d\x62\x6c\165\145\40\142\x74\x6e\55\154\147"], "\x6c\x61\x62\x65\x6c" => "\x53\141\166\x65"]); goto c9107; c9107: return $form; goto E18d8; E18d8: } private function handleDatabaseUserEditForm(Request $request, Form $form, Site $site) { goto A2aeb; D2575: c3558: goto c7341; Efcbd: $this->formErrors = $this->getErrorMessages($form); goto Ea41f; Ea41f: goto c3558; goto Bab3e; A2aeb: if (true === $form->isValid()) { goto ad89f; } goto Efcbd; E709d: try { goto Ce6cd; Dc244: efca1: goto f6833; ac8ee: $databaseUserEntity->setPassword($encryptedPassword); goto A55dd; Ca4e2: if (false === is_null($siteEntity)) { goto cc92b; } goto Aafa4; Aac15: $databaseUserEntity = $form->getData(); goto F91df; aa721: $response = $this->redirect($this->generateUrl("\x63\x6c\160\137\163\151\x74\145\x5f\144\141\164\141\142\x61\x73\x65\163", ["\144\157\155\141\151\156\x4e\x61\155\145" => $site->getDomainName()])); goto Dc244; A55dd: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto e712a; ff81b: $eventData = ["\163\x69\x74\145" => $domainName, "\144\141\x74\x61\142\x61\163\145\125\163\145\162\116\141\155\x65" => $databaseUserEntity->getUserName(), "\160\145\x72\x6d\x69\x73\x73\151\157\x6e\163" => $databaseUserEntity->getPermissions(), "\144\x61\164\x61\x62\141\x73\145" => $databaseName]; goto F3859; Ec21a: $session->getFlashBag()->set("\163\x75\x63\143\145\x73\163", $this->translator->trans("\x44\x61\164\x61\x62\141\163\145\x20\x55\x73\x65\162\x20\x68\141\163\40\x62\x65\145\156\x20\x75\160\x64\x61\x74\145\144\56")); goto aa721; b167f: $session = $request->getSession(); goto Ffef8; Ce6cd: $user = $this->getUser(); goto b167f; Ffef8: $domainName = $site->getDomainName(); goto df9fe; Aafa4: $response = $this->redirect($this->generateUrl("\143\x6c\160\x5f\163\151\x74\x65\x5f\x64\141\x74\x61\x62\141\163\145\137\165\163\x65\x72\137\x6e\x65\167", ["\x64\x6f\155\x61\x69\156\116\x61\x6d\x65" => $site->getDomainName()])); goto fb0ef; f6833: return $response; goto ece73; da48b: cc92b: goto Aac15; fb0ef: goto efca1; goto da48b; df9fe: $siteEntity = $this->getSiteEntity($domainName); goto Ca4e2; F91df: $encryptedPassword = Crypto::encrypt($databaseUserEntity->getPassword()); goto ac8ee; f3f11: $databaseManager->createUser($databaseUserEntity); goto cff4f; e712a: $databaseManager = new DatabaseManager($activeDatabaseServerEntity); goto f3f11; Dea57: $databaseName = $databaseEntity->getName(); goto ff81b; cff4f: $this->databaseUserEntityManager->updateEntity($databaseUserEntity); goto ae693; ae693: $databaseEntity = $databaseUserEntity->getDatabase(); goto Dea57; F3859: EventQueue::addEvent(EventQueue::EVENT_SITE_DATABASE_USER_EDIT, $user, $eventData, $request); goto Ec21a; ece73: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\x6e\x67\x65\x72", $this->translator->trans("\101\156\x20\x65\x72\162\157\x72\40\150\141\163\x20\157\143\x63\165\x72\162\145\x64\54\x20\x65\162\x72\x6f\162\x20\x6d\x65\163\x73\141\x67\145\x3a\40\45\145\162\x72\157\x72\115\145\x73\x73\x61\x67\x65\45", ["\x25\145\x72\x72\157\x72\115\x65\163\x73\141\x67\145\45" => $e->getMessage()])); } goto D2575; Bab3e: ad89f: goto E709d; c7341: } public function deleteDatabaseUser(Request $request) : Response { goto B50a7; C7477: try { goto F124c; A410b: if (!(false === is_null($databaseEntity) && $site->getDomainName() == $databaseEntity->getSite()->getDomainName())) { goto cbf2a; } goto d8828; Aa5a3: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto ab267; C1df0: cbf2a: goto D91de; E71f3: $domainName = $site->getDomainName(); goto b4639; Aff8f: $eventData = ["\163\x69\164\x65" => $domainName, "\144\141\164\x61\x62\x61\x73\x65\125\163\x65\162\116\141\155\x65" => $databaseUserName]; goto Da017; F124c: $databaseEntity = $databaseUserEntity->getDatabase(); goto A410b; ab267: $databaseManager = new DatabaseManager($activeDatabaseServerEntity); goto B0962; B0962: $databaseManager->deleteUser($databaseUserEntity); goto b1b5f; d8828: $user = $this->getUser(); goto E71f3; Da017: EventQueue::addEvent(EventQueue::EVENT_SITE_DATABASE_USER_DELETE, $user, $eventData, $request); goto C1df0; b1b5f: $this->databaseUserEntityManager->deleteEntity($databaseUserEntity); goto B0ad0; b4639: $session = $request->getSession(); goto Aa5a3; B0ad0: $session->getFlashBag()->set("\163\165\143\x63\x65\163\x73", $this->translator->trans("\104\x61\164\x61\x62\x61\163\145\40\x55\163\x65\x72\x20\x68\x61\x73\x20\142\145\145\156\40\144\x65\x6c\145\164\x65\x64\56")); goto Aff8f; D91de: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\x67\x65\x72", $this->translator->trans("\101\156\x20\145\x72\x72\x6f\x72\40\x68\141\x73\x20\157\143\x63\165\162\x72\x65\144\54\x20\145\162\x72\157\x72\40\x6d\x65\x73\163\x61\x67\x65\x3a\x20\x25\x65\x72\x72\157\162\115\x65\x73\x73\141\147\x65\x25", ["\45\x65\162\x72\157\162\115\x65\x73\x73\x61\x67\145\45" => $e->getMessage()])); } goto ec15c; f0fc2: return $response; goto A98c2; B50a7: $site = $this->getSite($request); goto E0aae; ec15c: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\x73\151\x74\145\137\x64\141\x74\141\142\x61\x73\x65\x73", ["\144\157\155\x61\x69\156\x4e\141\x6d\145" => $site->getDomainName()])); goto f0fc2; abdba: if (!(false === is_null($databaseUserEntity))) { goto E5b17; } goto C7477; A98c2: E5b17: goto B6bb2; b3951: $databaseUserName = $request->get("\x64\x61\x74\x61\x62\x61\x73\145\125\x73\145\x72\x4e\x61\155\145"); goto Cccf5; B7981: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\x73\x69\164\x65\163")); goto Eb9c8; B6bb2: f058a: goto B7981; Eb9c8: return $response; goto d4bff; E0aae: if (!(false === is_null($site))) { goto f058a; } goto b3951; Cccf5: $databaseUserEntity = $this->databaseUserEntityManager->findOneByUserName($databaseUserName); goto abdba; d4bff: } public function varnishCache(Request $request) : Response { goto e2025; b35c2: return $response; goto B6e09; D6b6c: C4068: goto B462f; D4d6b: $purgeCacheForm->handleRequest($request); goto Ed0ff; cbcf3: goto C4068; goto c60bd; D463d: if (false === is_null($site) && true === $site->getVarnishCache()) { goto Ee9ca; } goto e9203; A60b7: $varnishCacheSettings = $site->getVarnishCacheSettings(); goto Ea8d0; e9203: $response = $this->redirect($this->generateUrl("\x63\154\x70\137\163\151\x74\145\163")); goto cbcf3; eebc0: $purgeCacheForm = $this->createVarnishCachePurgeCacheForm($site); goto bba55; c60bd: Ee9ca: goto A60b7; b21e3: $settingsForm = $this->createVarnishCacheSettingsForm($site, $varnishCacheSettingsData); goto eebc0; B6e09: B5248: goto D0986; Acceb: $response = $this->handleVarnishCacheSettingsForm($request, $settingsForm, $site); goto C9408; bf1d5: return $response; goto E2b1c; b6cb0: if (!(true === $purgeCacheForm->isSubmitted())) { goto Cbcb7; } goto D5332; bba55: if (!(true === $request->isMethod("\120\117\123\124"))) { goto db1e9; } goto f511b; d0b92: if (!(false === is_null($response))) { goto d8bb4; } goto bf1d5; e2025: $site = $this->getSite($request); goto D463d; Ca386: $response = $this->render("\x46\162\x6f\156\x74\x65\x6e\x64\x2f\x53\151\164\145\x2f\166\141\x72\x6e\151\163\x68\x2d\x63\141\143\150\145\x2e\x68\164\155\154\56\164\x77\x69\147", ["\x73\x69\164\x65" => $site, "\x73\145\x74\x74\x69\x6e\x67\x73\106\x6f\162\155" => $settingsForm->createView(), "\160\165\162\147\x65\103\x61\143\x68\145\x46\157\162\x6d" => $purgeCacheForm->createView(), "\x66\x6f\x72\x6d\x45\x72\x72\157\x72\163" => $this->formErrors]); goto D6b6c; D5332: $response = $this->handleVarnishCachePurgeCacheForm($request, $purgeCacheForm, $site); goto d0b92; C9408: if (!(false === is_null($response))) { goto B5248; } goto b35c2; ab8b7: db1e9: goto Ca386; D0986: F5d57: goto b6cb0; E2b1c: d8bb4: goto bbc6e; B462f: return $response; goto A792f; bbc6e: Cbcb7: goto ab8b7; Ed0ff: if (!(true === $settingsForm->isSubmitted())) { goto F5d57; } goto Acceb; f511b: $settingsForm->handleRequest($request); goto D4d6b; Ea8d0: $varnishCacheSettingsData = ["\151\163\105\x6e\x61\x62\x6c\x65\144" => true === isset($varnishCacheSettings["\145\156\x61\142\x6c\x65\144"]) && true === $varnishCacheSettings["\x65\x6e\141\x62\x6c\145\x64"] ? true : false, "\163\145\x72\x76\x65\x72" => true === isset($varnishCacheSettings["\x73\x65\x72\x76\145\162"]) ? $varnishCacheSettings["\163\x65\x72\x76\145\162"] : "\x31\x32\x37\56\x30\x2e\x30\x2e\61\x3a\x36\60\70\61", "\143\x61\143\150\145\x54\x61\x67\120\162\145\x66\151\170" => true === isset($varnishCacheSettings["\x63\x61\143\x68\145\x54\x61\147\120\162\145\146\151\x78"]) ? $varnishCacheSettings["\x63\141\x63\150\x65\124\141\x67\x50\x72\145\146\151\x78"] : substr(md5(time()), 0, 4), "\143\x61\x63\x68\x65\114\151\146\145\164\151\155\145" => true === isset($varnishCacheSettings["\143\141\143\x68\145\x4c\x69\x66\145\x74\151\x6d\x65"]) ? $varnishCacheSettings["\x63\x61\x63\x68\x65\114\151\146\145\x74\x69\x6d\x65"] : "\66\x30\x34\70\x30\x30", "\x65\170\x63\154\165\x64\145\144\120\x61\162\x61\155\x73" => true === isset($varnishCacheSettings["\145\170\143\154\165\144\x65\144\120\141\162\x61\155\163"]) ? implode("\x2c", $varnishCacheSettings["\145\170\x63\x6c\x75\x64\x65\x64\120\141\x72\x61\x6d\x73"]) : "\x5f\137\123\x49\x44\x2c\x6e\157\x43\141\143\150\145\x2c", "\x65\x78\143\x6c\165\x64\x65\x73" => true === isset($varnishCacheSettings["\x65\x78\143\x6c\x75\144\145\x73"]) ? implode(PHP_EOL, $varnishCacheSettings["\x65\170\x63\x6c\165\x64\145\x73"]) : '']; goto b21e3; A792f: } private function createVarnishCacheSettingsForm(Site $site, array $data) : Form { goto a8b1e; a8b1e: $form = $this->createForm("\x41\x70\x70\x5c\x46\157\162\x6d\x5c\x53\x69\164\x65\x56\x61\162\156\151\163\x68\x43\141\x63\x68\145\123\145\164\x74\151\x6e\147\163\x54\171\x70\x65", $data, ["\x61\x63\164\x69\157\156" => $this->generateUrl("\x63\x6c\160\137\163\x69\x74\145\137\x76\141\x72\x6e\151\163\150\x5f\143\x61\143\x68\x65", ["\x64\157\x6d\x61\x69\156\x4e\x61\x6d\145" => $site->getDomainName()]), "\155\145\x74\150\157\x64" => "\120\117\123\x54", "\141\164\x74\162" => []]); goto D2ee6; D2ee6: $form->add("\163\165\142\x6d\151\164", SubmitType::class, ["\x61\164\x74\162" => ["\x63\x6c\141\x73\x73" => "\142\164\x6e\40\x62\164\x6e\55\x62\x6c\165\145\40\142\164\156\55\x6c\x67"], "\154\141\x62\145\x6c" => "\123\x61\x76\x65"]); goto B5935; B5935: return $form; goto dcae1; dcae1: } private function createVarnishCachePurgeCacheForm(Site $site) : Form { goto C0e97; cfcd5: $form->add("\163\165\x62\155\x69\x74", SubmitType::class, ["\x61\164\x74\x72" => ["\x63\x6c\141\x73\x73" => "\x62\x74\x6e\40\x62\164\x6e\x2d\x62\154\165\145\40\x62\164\156\x2d\154\x67"], "\x6c\x61\142\x65\154" => "\x50\x75\162\x67\x65\x20\103\141\143\x68\x65"]); goto dfbb7; C0e97: $form = $this->createForm("\x41\x70\160\134\106\x6f\162\x6d\x5c\123\151\x74\x65\126\141\x72\x6e\151\163\x68\x43\x61\143\150\x65\120\x75\162\x67\145\103\141\143\x68\145\x54\171\x70\x65", ["\163\x69\x74\145" => $site], ["\141\143\x74\151\x6f\x6e" => $this->generateUrl("\143\x6c\160\x5f\163\x69\x74\x65\x5f\x76\141\162\x6e\x69\x73\150\137\143\x61\x63\x68\x65", ["\144\157\155\x61\151\156\x4e\x61\155\x65" => $site->getDomainName()]), "\x6d\x65\164\150\x6f\x64" => "\x50\117\x53\124", "\141\164\164\162" => []]); goto cfcd5; dfbb7: return $form; goto ef0ef; ef0ef: } private function handleVarnishCacheSettingsForm(Request $request, Form $form, Site $site) { goto b7a05; c51ac: a0ca9: goto a4ff5; C51f8: $this->formErrors = $this->getErrorMessages($form); goto f5e0f; c57b8: c7310: goto F5eab; F5eab: try { goto F8866; e3da2: $user = $this->getUser(); goto b0099; A64f6: goto a868d; goto B6be1; Ef558: $server = $form->get("\163\x65\x72\166\x65\x72")->getData(); goto f0c6b; F8866: $session = $request->getSession(); goto Ad7b0; d6c6f: $excludes = array_map("\x74\x72\x69\x6d", array_filter(explode(PHP_EOL, trim($form->get("\x65\170\143\x6c\165\x64\x65\x73")->getData())))); goto C27c9; b0099: $isEnabled = $form->get("\x69\163\105\x6e\141\x62\x6c\145\x64")->getData(); goto Ef558; fcde5: EventQueue::addEvent(EventQueue::EVENT_SITE_VARNISH_CACHE_SETTINGS_UPDATE, $user, $eventData, $request); goto A68b4; B6be1: f74d8: goto e3da2; d471b: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\x5f\x73\151\164\145\x73")); goto A64f6; b6eaf: $site->setVarnishCacheSettings($varnishCacheSettings); goto Cc86b; E29ca: $siteEntity = $this->getSiteEntity($domainName); goto Dc88c; Dc88c: if (false === is_null($siteEntity)) { goto f74d8; } goto d471b; ba11d: $cacheTagPrefix = $form->get("\143\x61\143\x68\x65\124\141\x67\120\x72\145\146\151\x78")->getData(); goto Afb2a; C27c9: $varnishCacheSettings = ["\x65\156\x61\142\154\145\144" => $isEnabled, "\x73\x65\x72\x76\x65\162" => $server, "\x63\x61\x63\150\145\124\x61\147\120\x72\x65\146\151\x78" => $cacheTagPrefix, "\143\141\143\x68\x65\114\151\146\x65\x74\151\x6d\x65" => $cacheLifetime, "\x65\x78\143\154\x75\144\x65\x73" => $excludes, "\x65\x78\143\154\x75\144\x65\144\120\141\162\141\155\x73" => $excludedParams]; goto b6eaf; e564f: a868d: goto A4215; Ad7b0: $domainName = $site->getDomainName(); goto E29ca; B9fca: $response = $this->redirect($this->generateUrl("\x63\154\160\x5f\x73\151\164\x65\137\x76\141\x72\156\151\163\150\x5f\143\x61\143\150\145", ["\x64\157\x6d\x61\151\156\116\141\155\145" => $site->getDomainName()])); goto e564f; B6d2e: $siteUpdater->phpSettings(); goto e4fcd; A4215: return $response; goto ccd74; Cc86b: $siteUpdater = $this->getSiteUpdater($site); goto f25a4; e4fcd: $eventData = ["\163\x69\x74\x65" => $domainName, "\x76\141\x72\156\x69\x73\150\103\x61\x63\x68\x65\x45\156\141\142\154\x65\x64" => $isEnabled, "\163\x65\162\166\145\162" => $server, "\143\141\143\x68\x65\x54\x61\147\120\x72\145\146\x69\170" => $cacheTagPrefix, "\x63\141\143\150\145\x4c\151\146\x65\164\151\155\145" => $cacheLifetime, "\x65\170\x63\x6c\165\144\x65\163" => $excludes, "\x65\x78\143\x6c\165\144\145\144\x50\141\x72\x61\x6d\x73" => $excludedParams]; goto fcde5; A68b4: $session->getFlashBag()->set("\163\x75\143\143\145\163\x73", $this->translator->trans("\x56\141\162\156\151\x73\x68\40\x43\141\x63\150\x65\40\x53\145\164\x74\151\156\147\x73\x20\x68\141\166\x65\40\x62\x65\x65\x6e\x20\163\141\x76\x65\x64\56")); goto B9fca; f25a4: $siteUpdater->writeVarnishCacheSettingsFile($varnishCacheSettings); goto B6d2e; f0c6b: $cacheLifetime = $form->get("\143\141\143\x68\x65\x4c\x69\x66\x65\164\x69\x6d\145")->getData(); goto ba11d; Afb2a: $excludedParams = array_map("\164\x72\151\x6d", array_filter(explode("\54", trim($form->get("\x65\170\143\154\x75\x64\145\144\120\141\162\x61\155\x73")->getData())))); goto d6c6f; ccd74: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\156\147\145\x72", $this->translator->trans("\x41\156\40\x65\x72\x72\x6f\x72\40\x68\141\163\40\157\x63\143\165\162\x72\145\x64\54\x20\x65\x72\162\x6f\x72\x20\155\x65\163\163\x61\x67\145\72\40\x25\x65\x72\x72\157\x72\x4d\145\x73\x73\x61\x67\145\45", ["\x25\x65\162\162\157\x72\x4d\x65\163\163\141\147\x65\x25" => $e->getMessage()])); } goto c51ac; b7a05: if (true === $form->isValid()) { goto c7310; } goto C51f8; f5e0f: goto a0ca9; goto c57b8; a4ff5: } private function handleVarnishCachePurgeCacheForm(Request $request, Form $form, Site $site) { goto b18b8; e464d: C1b53: goto B4e34; Acfaf: b0110: goto fd083; b18b8: if (true === $form->isValid()) { goto b0110; } goto a9fec; ec8e8: goto C1b53; goto Acfaf; a9fec: $this->formErrors = $this->getErrorMessages($form); goto ec8e8; fd083: try { goto beb43; F8c42: if (false === empty($purgeValues) && true === isset($varnishCacheSettings["\x73\x65\162\x76\x65\x72"]) && false === empty($varnishCacheSettings["\163\145\162\166\x65\x72"])) { goto ce376; } goto d140d; Ba89a: goto b3a6c; goto Ca342; f6ed4: $varnishCacheSettings = $site->getVarnishCacheSettings(); goto Ff08d; A36f6: if (false === is_null($siteEntity)) { goto bbb6f; } goto baafd; Ca342: ce376: goto c251a; B5262: $varnishCacheClient->setServer($varnishCacheSettings["\x73\x65\x72\166\x65\x72"]); goto d5687; bd08e: $session->getFlashBag()->set("\163\165\143\143\145\x73\x73", $this->translator->trans("\126\141\162\156\151\x73\150\x20\x43\141\143\150\145\40\150\x61\x73\40\142\x65\145\x6e\40\x70\x75\162\x67\145\x64\x2e")); goto c0965; f81f5: EventQueue::addEvent(EventQueue::EVENT_SITE_VARNISH_CACHE_PURGE, $user, $eventData, $request); goto bd08e; c0965: $response = $this->redirect($this->generateUrl("\143\154\160\137\x73\x69\164\145\x5f\x76\141\162\156\151\x73\150\137\143\x61\143\150\145", ["\x64\x6f\x6d\141\x69\x6e\116\141\x6d\145" => $site->getDomainName()])); goto fb392; c048d: goto D110b; goto D4399; Bede7: return $response; goto cc05f; beb43: $session = $request->getSession(); goto C5b62; fb392: D110b: goto Bede7; baafd: $response = $this->redirect($this->generateUrl("\143\154\x70\137\163\151\164\x65\x73")); goto c048d; d5687: foreach ($purgeValues as $purgeValue) { goto f1761; c39b7: $varnishCacheClient->purgeTag($purgeValue); goto F349b; Bf693: $varnishCacheClient->purgeUrl($purgeValue); goto e62a8; a2967: if (true === str_starts_with($purgeValue, "\x68\x74\164\x70")) { goto e9762; } goto c39b7; f1761: $purgeValue = trim($purgeValue); goto d4c0e; Eb8b4: A144f: goto d4153; F349b: goto E7d68; goto a465b; d4153: C7c26: goto B190a; d4c0e: if (!(false === empty($purgeValue))) { goto A144f; } goto a2967; a465b: e9762: goto Bf693; e62a8: E7d68: goto Eb8b4; B190a: } goto c75a6; b610c: $user = $this->getUser(); goto f6ed4; Bf02d: $siteEntity = $this->getSiteEntity($domainName); goto A36f6; c251a: $varnishCacheClient = new VarnishCacheClient(); goto B5262; C5b62: $domainName = $site->getDomainName(); goto Bf02d; bc2e0: b3a6c: goto B8d0a; c75a6: A2264: goto bc2e0; D4399: bbb6f: goto b610c; B8d0a: $eventData = ["\x73\x69\x74\x65" => $domainName, "\166\141\154\165\145\x73" => implode("\x2c", $purgeValues)]; goto f81f5; d140d: throw new \Exception("\x56\x61\162\156\x69\x73\150\x20\103\x61\x63\x68\x65\x20\123\x65\x74\x74\x69\x6e\147\x73\40\x63\141\x6e\x6e\x6f\x74\40\142\145\40\145\155\160\x74\x79\56"); goto Ba89a; Ff08d: $purgeValues = array_map("\164\x72\x69\155", array_filter(explode("\54", trim($form->get("\x76\x61\x6c\x75\x65")->getData())))); goto F8c42; cc05f: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\x6e\x67\x65\x72", $this->translator->trans("\x41\156\40\145\162\162\157\x72\40\x68\141\163\x20\x6f\143\143\x75\x72\x72\x65\x64\x2c\x20\x65\162\x72\157\162\x20\x6d\145\163\163\141\x67\145\72\x20\x25\145\162\x72\157\x72\x4d\145\x73\x73\141\147\145\x25", ["\45\145\x72\x72\157\162\115\x65\x73\163\141\147\x65\x25" => $e->getMessage()])); } goto e464d; B4e34: } public function purgeVarnishCache(Request $request) : Response { goto Bd0d0; Bd0d0: $site = $this->getSite($request); goto c1428; d9598: goto bd189; goto A54f1; F7746: return $response; goto Fceaa; c1428: if (false === is_null($site)) { goto b7f56; } goto ed392; d7adf: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\x73\x69\164\145\137\166\x61\x72\x6e\151\x73\x68\137\x63\x61\143\150\145", ["\144\157\x6d\x61\151\x6e\x4e\x61\155\x65" => $site->getDomainName()])); goto B08c3; A54f1: b7f56: goto Ac271; B08c3: return $response; goto Bf65c; ed392: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\x73\x69\x74\145\163")); goto d9598; Ac271: try { goto b1ac6; ed514: $session->getFlashBag()->set("\x73\165\x63\143\145\163\x73", $this->translator->trans("\126\141\x72\156\x69\x73\150\x20\103\141\x63\x68\x65\x20\150\x61\x73\x20\142\145\145\156\40\160\165\162\x67\x65\x64\x2e")); goto b5854; fbee4: $domainName = $site->getDomainName(); goto B7ef9; ebacb: $cacheTagPrefix = $varnishCacheSettings["\143\x61\x63\x68\145\x54\141\x67\x50\162\x65\x66\151\x78"]; goto Aa058; Fdedd: $varnishCacheClient->purgeHost($domainName); goto B1b08; B1b08: e036c: goto D29cf; b1ac6: $user = $this->getUser(); goto D21e8; bfac6: $varnishCacheClient->purgeTag($cacheTagPrefix); goto Fdedd; D21e8: $session = $request->getSession(); goto fbee4; B69ee: $varnishCacheClient->setServer($varnishCacheSettings["\x73\145\162\166\145\162"]); goto bfac6; Aa058: $varnishCacheClient = new VarnishCacheClient(); goto B69ee; D29cf: $eventData = ["\x73\x69\164\145" => $domainName, "\x70\165\162\x67\145" => "\x66\x75\154\x6c"]; goto F03e0; B4b10: if (!(true === isset($varnishCacheSettings["\163\x65\162\166\x65\x72"]) && true === isset($varnishCacheSettings["\143\141\x63\x68\x65\124\x61\x67\120\x72\x65\x66\151\x78"]) && false === empty($varnishCacheSettings["\x63\x61\143\x68\145\x54\141\x67\120\162\145\x66\x69\170"]))) { goto e036c; } goto ebacb; B7ef9: $varnishCacheSettings = $site->getVarnishCacheSettings(); goto B4b10; F03e0: EventQueue::addEvent(EventQueue::EVENT_SITE_VARNISH_CACHE_PURGE, $user, $eventData, $request); goto ed514; b5854: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\x6e\147\x65\162", $this->translator->trans("\x41\156\40\145\x72\162\157\x72\x20\x68\x61\x73\x20\x6f\x63\143\165\162\x72\145\x64\x2c\40\x65\x72\x72\157\162\40\155\x65\x73\x73\141\x67\145\x3a\40\45\x65\x72\162\x6f\x72\115\145\x73\x73\x61\x67\145\45", ["\x25\145\x72\x72\157\x72\x4d\145\x73\163\x61\x67\145\x25" => $e->getMessage()])); } goto d7adf; Bf65c: bd189: goto F7746; Fceaa: } public function vhost(Request $request) : Response { goto aa3db; E9b3f: $site->setVhostTemplate($vhostTemplate); goto F688c; Fe2cd: aac84: goto Adf7a; B1e58: ccfa1: goto fb89d; e6fab: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\x73\151\164\x65\163")); goto De943; ca0f4: Fef89: goto cce63; C0ba7: if (!(false === empty($vhostTemplate))) { goto Fef89; } goto b39e6; De943: goto aac84; goto B1e58; aa3db: $site = $this->getSite($request); goto d918b; d918b: if (false === is_null($site)) { goto ccfa1; } goto e6fab; F688c: $response = $this->handleVhostUpdate($request, $site, $siteEntity, $oldVhostTemplate); goto ce6f2; b4564: $oldVhostTemplate = $siteEntity->getVhostTemplate(); goto E9b3f; b39e6: $domainName = $site->getDomainName(); goto b9329; b9946: $response = $this->render("\x46\x72\x6f\x6e\x74\x65\x6e\144\x2f\x53\151\x74\x65\57\x76\x68\x6f\x73\x74\x2e\x68\x74\155\x6c\56\x74\x77\151\x67", ["\163\x69\164\x65" => $site]); goto Fe2cd; b9329: $siteEntity = $this->getSiteEntity($domainName); goto b4564; c6da3: E8a1d: goto ca0f4; F30da: $vhostTemplate = trim($request->get("\166\150\157\163\x74\x2d\164\x65\x6d\160\x6c\x61\164\145")); goto C0ba7; cce63: Ec58a: goto b9946; Ad79a: return $response; goto c6da3; Adf7a: return $response; goto Cca87; ce6f2: if (!(false === is_null($response))) { goto E8a1d; } goto Ad79a; fb89d: if (!(true === $request->isMethod("\120\x4f\123\124"))) { goto Ec58a; } goto F30da; Cca87: } private function handleVhostUpdate(Request $request, Site $site, SiteEntity $siteEntity, string $oldVhostTemplate) { try { goto Bbac9; E06fa: $siteUpdater = $this->getSiteUpdater($site); goto Ee42e; Cc453: EventQueue::addEvent(EventQueue::EVENT_SITE_VHOST_UPDATE, $user, $eventData, $request); goto D45c1; B2ce4: $vhostTemplate = $site->getVhostTemplate(); goto E06fa; c43e2: $domainName = $site->getDomainName(); goto B2ce4; e126d: $siteEntity->setVhostTemplate($vhostTemplate); goto f2afb; d4d1c: $session = $request->getSession(); goto c43e2; Abeff: $session->getFlashBag()->set("\163\165\143\143\x65\163\x73", $this->translator->trans("\x56\150\157\163\164\40\x68\x61\x73\40\142\x65\x65\156\40\x73\141\x76\x65\144\56")); goto Cb696; Cb696: $eventData = ["\x73\x69\164\x65" => $domainName, "\166\150\x6f\x73\x74" => $vhostTemplate, "\x6f\x6c\x64\x56\x68\157\163\164" => $oldVhostTemplate]; goto Cc453; d63ca: return $response; goto fcd4b; Ee42e: $siteUpdater->updateNginxVhostWithRollback(); goto e126d; D45c1: $response = $this->redirect($this->generateUrl("\x63\x6c\x70\x5f\163\x69\x74\x65\x5f\166\x68\157\x73\164", ["\x64\157\155\x61\x69\156\116\141\155\145" => $domainName])); goto d63ca; Bbac9: $user = $this->getUser(); goto d4d1c; f2afb: $this->siteEntityManager->updateEntity($siteEntity); goto Abeff; fcd4b: } catch (InvalidVhostException $e) { $session->getFlashBag()->set("\144\141\156\147\x65\x72", $this->translator->trans("\126\x68\157\163\164\x20\x69\163\40\156\157\x74\40\166\x61\154\151\144\54\40\x65\162\x72\x6f\162\x20\x6d\x65\163\163\x61\147\145\x3a\40\45\x65\x72\x72\157\x72\115\x65\163\163\x61\147\x65\x25", ["\x25\145\162\x72\x6f\162\115\145\x73\163\x61\147\145\45" => $e->getMessage()])); } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\x6e\147\145\x72", $this->translator->trans("\x41\x6e\x20\145\x72\162\x6f\x72\x20\150\141\163\x20\157\143\x63\x75\162\162\x65\144\x2c\x20\145\162\162\157\162\40\x6d\x65\x73\x73\x61\147\145\72\x20\45\x65\x72\x72\x6f\162\115\145\163\163\141\147\x65\x25", ["\45\x65\x72\162\157\x72\115\x65\163\163\141\147\145\45" => $e->getMessage()])); } } public function settings(Request $request) : Response { goto e3206; aa0dd: $response = $this->handlePageSpeedSettingsForm($request, $pageSpeedSettingsForm, $site); goto a78c9; dd056: b665f: goto A4a8b; E4522: $pageSpeedSettingsForm->handleRequest($request); goto cd57a; cd57a: $response = null; goto cf72d; Cd7b6: $siteDeleteForm->handleRequest($request); goto E4522; a0a20: $pythonSettings = $site->getPythonSettings(); goto a7049; B418b: if (false === is_null($site)) { goto F68df; } goto Fbbb9; A4a8b: Bf1f7: goto b9c70; f8731: f9357: goto A2821; Dff96: daa18: goto B96e4; f6e62: return $response; goto dd056; A2821: $parameters = ["\163\151\x74\x65" => $site, "\x64\157\155\x61\x69\156\123\x65\x74\x74\151\156\x67\x73\x46\157\162\x6d" => $domainSettingsForm->createView(), "\x73\x69\x74\x65\x55\x73\x65\x72\x53\145\x74\164\x69\156\147\163\x46\157\162\155" => $siteUserSettingsForm->createView(), "\x70\x61\x67\x65\123\x70\x65\145\144\x53\x65\x74\x74\x69\x6e\147\163\106\x6f\162\x6d" => $pageSpeedSettingsForm->createView(), "\163\151\164\145\x44\x65\x6c\x65\x74\145\106\157\x72\x6d" => $siteDeleteForm->createView()]; goto D63e7; e8d0f: $phpSettingsForm = $this->createPhpSettingsForm($site, $phpSettings); goto fd032; a7049: $pythonSettingsForm = $this->createPythonSettingsForm($site, $pythonSettings); goto b2bbe; b48ab: $domainSettingsData = ["\x64\x6f\155\141\151\x6e\116\x61\155\x65" => $site->getDomainName(), "\162\157\157\164\x44\x69\x72\145\143\x74\x6f\x72\171" => $site->getRootDirectory()]; goto b43e0; e17d3: unset($parameters["\160\x61\x67\145\123\160\x65\145\x64\123\x65\x74\164\x69\156\147\x73\x46\x6f\x72\x6d"]); goto A75d6; b2bbe: if (!(true === $request->isMethod("\x50\117\x53\x54"))) { goto f8951; } goto A3cd6; fe73d: $siteDeleteForm = $this->createSiteDeleteForm($site, $siteDeleteData); goto b5246; F2ab3: c91fd: goto ae3f3; dc79f: $nodejsSettings = $site->getNodejsSettings(); goto cb0f5; Ae923: $domainSettingsForm = $this->createDomainSettingsForm($site, $domainSettingsData); goto d73cb; Fb8b9: if (!(false === is_null($response))) { goto b665f; } goto f6e62; cf197: $phpSettings = $site->getPhpSettings(); goto e8d0f; F9f36: $response = $this->render("\x46\162\x6f\156\x74\145\x6e\144\57\123\151\164\x65\x2f\163\x65\164\x74\151\x6e\147\163\x2e\x68\164\155\154\x2e\x74\167\x69\147", $parameters); goto fc753; d0f83: unset($parameters["\160\141\x67\145\x53\160\145\145\x64\x53\x65\x74\x74\x69\x6e\147\x73\x46\x6f\162\155"]); goto Bcf04; Cbcbb: C059a: goto Fff0f; fc753: b6992: goto af0eb; E686e: F6fb8: goto B1270; cf72d: if (!(true === $domainSettingsForm->isSubmitted())) { goto a64a1; } goto A9d02; e7487: C2d02: goto Cbcbb; ae3f3: b00dd: goto b33e4; Fc6ec: if (!(true === $siteUserSettingsForm->isSubmitted())) { goto cd8ba; } goto B4117; D1873: goto b6992; goto Ceac1; a78c9: a9ce4: goto Ba92a; cb0f5: $nodejsSettingsForm = $this->createNodejsSettingsForm($site, $nodejsSettings); goto b8795; B1270: if (!(SiteEntity::TYPE_REVERSE_PROXY == $site->getType())) { goto c9c81; } goto e5b02; B96e4: ed267: goto Edf8e; c201c: $phpSettingsForm->handleRequest($request); goto ef38a; cc735: Effa2: goto e7487; d9e97: $parameters["\x70\171\164\x68\x6f\156\x53\145\164\x74\x69\x6e\x67\x73\106\157\162\155"] = $pythonSettingsForm->createView(); goto E686e; A1984: $parameters["\160\x68\x70\x53\145\x74\x74\151\x6e\147\x73\x46\157\x72\x6d"] = $phpSettingsForm->createView(); goto Bef28; Cfe21: return $response; goto E7bc3; A0451: $response = $this->handleNodejsSettingsForm($request, $nodejsSettingsForm, $currentNodeSettings, $site); goto C7c52; Ac6f5: if (!(false === is_null($response))) { goto c83fa; } goto Cfe21; F2cbc: return $response; goto Dff96; Fbbb9: $response = $this->redirect($this->generateUrl("\143\x6c\x70\137\x73\x69\x74\x65\163")); goto D1873; ff749: $siteDeleteData = ["\144\x6f\155\x61\151\x6e\116\x61\155\x65" => $site->getDomainName()]; goto F3be4; C7c52: if (!(false === is_null($response))) { goto Effa2; } goto F9866; A75d6: bd340: goto D511f; Edf8e: c4b2b: goto ebd7a; Bcf04: c9c81: goto E13e7; e3206: $site = $this->getSite($request); goto B418b; fa5b1: if (!(false === is_null($response))) { goto c91fd; } goto dcfa7; Ac6be: if (!(false === is_null($response))) { goto daa18; } goto F2cbc; Ceac1: F68df: goto b48ab; A9d02: $response = $this->handleDomainSettingsForm($request, $domainSettingsForm, $site); goto f3cef; Cb813: $response = $this->handlePhpSettingsForm($request, $phpSettingsForm, $currentPhpSettings, $site); goto fa5b1; e9635: $response = $this->handleSiteDeleteForm($request, $siteDeleteForm, $site); goto F8fa8; F9866: return $response; goto cc735; d2bba: $reverseProxySettingsForm->handleRequest($request); goto C2fc3; D511f: if (!(SiteEntity::TYPE_PHP == $site->getType())) { goto a23f6; } goto cf197; b5246: if (!(true === $request->isMethod("\x50\117\x53\124"))) { goto f9357; } goto F41e3; b8795: if (!(true === $request->isMethod("\x50\x4f\x53\x54"))) { goto C059a; } goto D642b; C2fc3: if (!(true === $reverseProxySettingsForm->isSubmitted())) { goto ed267; } goto E3fd2; ef38a: if (!(true === $phpSettingsForm->isSubmitted())) { goto b00dd; } goto Cb813; e2e52: cd8ba: goto C0ffb; F3be4: $pageSpeedSettingsData = ["\x69\163\105\156\x61\142\x6c\x65\144" => $site->getPageSpeedEnabled(), "\163\145\x74\x74\151\x6e\x67\x73" => $site->getPageSpeedSettings()]; goto Ae923; f3cef: a64a1: goto Fc6ec; F41e3: $domainSettingsForm->handleRequest($request); goto e1c7b; D63e7: if (!(SiteEntity::TYPE_NODEJS == $site->getType())) { goto bd340; } goto dc79f; A3cd6: $pythonSettingsForm->handleRequest($request); goto A9503; C0ffb: if (!(true === $pageSpeedSettingsForm->isSubmitted())) { goto a9ce4; } goto aa0dd; B4117: $response = $this->handleSiteUserSettingsForm($request, $siteUserSettingsForm, $site); goto e2e52; Dd77a: $nodejsSettingsForm->handleRequest($request); goto Df7a7; A9503: if (!(true === $pythonSettingsForm->isSubmitted())) { goto Bf1f7; } goto C24fe; D642b: $currentNodeSettings = clone $nodejsSettings; goto Dd77a; D7f6a: $currentPhpSettings = clone $phpSettings; goto c201c; Bef28: a23f6: goto f7184; E13e7: $parameters["\146\x6f\x72\x6d\x45\162\162\x6f\162\x73"] = $this->formErrors; goto F9f36; Df7a7: if (!(true === $nodejsSettingsForm->isSubmitted())) { goto C2d02; } goto A0451; Ba92a: if (!(true === $siteDeleteForm->isSubmitted())) { goto C05d1; } goto e9635; F8fa8: C05d1: goto Ac6f5; E3fd2: $response = $this->handleReverseProxySettingsForm($request, $reverseProxySettingsForm, $site); goto Ac6be; f7184: if (!(SiteEntity::TYPE_PYTHON == $site->getType())) { goto F6fb8; } goto a0a20; Bc15a: if (!(true === $request->isMethod("\x50\117\123\x54"))) { goto c4b2b; } goto d2bba; e5b02: $reverseProxySettingsForm = $this->createReverseProxySettingsForm($site); goto Bc15a; d73cb: $siteUserSettingsForm = $this->createSiteUserSettingsForm($site, $siteUserSettingsData); goto C6ebe; b33e4: dcf1d: goto A1984; dcfa7: return $response; goto F2ab3; b9c70: f8951: goto d9e97; af0eb: return $response; goto B3f9d; b43e0: $siteUserSettingsData = ["\163\151\164\x65\x55\163\x65\162" => $site->getUser(), "\x73\x73\x68\x4b\x65\x79\163" => $site->getSshKeys()]; goto ff749; Fff0f: $parameters["\156\x6f\x64\x65\152\x73\123\x65\164\x74\151\156\147\x73\106\157\162\155"] = $nodejsSettingsForm->createView(); goto e17d3; C6ebe: $pageSpeedSettingsForm = $this->createPageSpeedSettingsForm($site, $pageSpeedSettingsData); goto fe73d; e1c7b: $siteUserSettingsForm->handleRequest($request); goto Cd7b6; ebd7a: $parameters["\x72\x65\x76\x65\x72\163\145\120\162\157\170\171\x53\145\x74\164\x69\156\x67\163\x46\157\162\x6d"] = $reverseProxySettingsForm->createView(); goto d0f83; E7bc3: c83fa: goto f8731; fd032: if (!(true === $request->isMethod("\120\x4f\x53\x54"))) { goto dcf1d; } goto D7f6a; C24fe: $response = $this->handlePythonSettingsForm($request, $pythonSettingsForm, $site); goto Fb8b9; B3f9d: } public function purgePageSpeedCache(Request $request) : Response { goto Eb414; C9088: d596e: goto f6267; Add0d: return $response; goto db936; db936: cc9b4: goto B1103; Eb414: $site = $this->getSite($request); goto A1478; f6267: try { goto c1539; E34a7: $siteUpdater->purgePageSpeedCache(); goto b390d; b390d: $eventData = ["\x73\x69\164\x65" => $site->getDomainName()]; goto dd1da; A0a54: $session = $request->getSession(); goto C90ab; C90ab: $siteUpdater = $this->getSiteUpdater($site); goto E34a7; dd1da: EventQueue::addEvent(EventQueue::EVENT_SITE_PAGE_SPEED_CACHE_PURGE, $user, $eventData, $request); goto F1fb4; c1539: $user = $this->getUser(); goto A0a54; F1fb4: $session->getFlashBag()->set("\163\165\x63\x63\145\x73\163", $this->translator->trans("\x50\141\147\x65\40\123\160\145\145\x64\x20\103\141\x63\x68\145\x20\150\141\x73\x20\142\145\x65\156\x20\x70\165\x72\x67\145\144\56")); goto F07b3; F07b3: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\x6e\x67\x65\162", $this->translator->trans("\x41\156\40\x65\162\x72\x6f\162\40\x68\141\163\40\157\143\x63\x75\162\x72\145\144\54\40\145\x72\162\x6f\x72\40\x6d\145\163\163\x61\x67\145\72\40\x25\x65\x72\162\x6f\162\x4d\145\163\x73\141\147\145\x25", ["\x25\x65\x72\162\157\x72\x4d\x65\163\x73\141\x67\145\45" => $e->getMessage()])); } goto e734d; d2502: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\x73\x69\x74\145\x73")); goto cb698; cb698: goto cc9b4; goto C9088; e734d: $response = $this->redirect($this->generateUrl("\143\x6c\x70\137\x73\151\x74\x65\137\x73\x65\164\x74\x69\x6e\147\x73", ["\x64\x6f\155\141\151\156\116\141\x6d\145" => $site->getDomainName()])); goto Add0d; A1478: if (false === is_null($site)) { goto d596e; } goto d2502; B1103: return $response; goto dc729; dc729: } private function createDomainSettingsForm(Site $site, array $data) : Form { goto A33e6; A33e6: $form = $this->createForm("\101\160\x70\x5c\106\x6f\162\x6d\x5c\x53\151\164\x65\104\x6f\155\x61\151\156\x53\145\x74\x74\x69\156\x67\x73\124\x79\160\145", $data, ["\141\143\164\151\x6f\x6e" => $this->generateUrl("\x63\154\x70\x5f\x73\x69\164\x65\137\163\x65\164\x74\151\156\x67\x73", ["\x64\x6f\x6d\141\151\x6e\x4e\141\155\x65" => $site->getDomainName()]), "\155\145\x74\150\157\x64" => "\x50\x4f\123\x54", "\x61\x74\164\x72" => []]); goto fff62; fff62: $form->add("\x73\165\x62\155\x69\164", SubmitType::class, ["\x61\x74\164\x72" => ["\x63\154\141\163\x73" => "\x62\x74\x6e\40\142\164\156\55\142\x6c\165\145\40\x62\x74\156\x2d\154\x67"], "\x6c\141\x62\x65\x6c" => "\123\x61\166\x65"]); goto b4552; b4552: return $form; goto aeb68; aeb68: } private function createSiteUserSettingsForm(Site $site, array $data) : Form { goto D6949; e0757: $form->add("\x73\165\x62\x6d\151\x74", SubmitType::class, ["\x61\164\164\x72" => ["\x63\154\141\x73\163" => "\142\164\x6e\40\x62\164\x6e\x2d\142\x6c\x75\145\x20\x62\164\156\x2d\154\147"], "\x6c\141\142\145\x6c" => "\x53\x61\x76\x65"]); goto C8a0d; D6949: $form = $this->createForm("\x41\160\x70\x5c\x46\157\162\155\x5c\123\x69\x74\x65\125\x73\145\x72\x53\145\164\x74\151\x6e\x67\x73\124\171\x70\x65", $data, ["\x61\143\x74\151\x6f\156" => $this->generateUrl("\143\154\160\x5f\x73\x69\164\145\137\163\145\x74\164\151\156\x67\163", ["\x64\157\x6d\141\x69\156\116\x61\155\145" => $site->getDomainName()]), "\155\x65\164\150\157\x64" => "\120\117\123\x54", "\141\164\x74\162" => []]); goto e0757; C8a0d: return $form; goto C3f38; C3f38: } private function createPageSpeedSettingsForm(Site $site, array $data) : Form { goto Da839; b4c4b: return $form; goto eb9c2; Da839: $form = $this->createForm("\101\x70\x70\134\x46\157\x72\155\x5c\123\x69\x74\145\x50\141\x67\145\x53\160\145\145\x64\123\x65\164\x74\151\x6e\147\163\124\171\x70\145", $data, ["\x61\x63\x74\x69\157\156" => $this->generateUrl("\143\154\x70\137\x73\151\x74\145\137\x73\x65\164\x74\151\x6e\x67\163", ["\x64\x6f\x6d\x61\x69\156\x4e\x61\x6d\145" => $site->getDomainName()]), "\x6d\x65\164\150\157\x64" => "\120\x4f\x53\124", "\x61\x74\164\162" => []]); goto F452a; F452a: $form->add("\163\165\x62\x6d\x69\164", SubmitType::class, ["\141\164\x74\162" => ["\143\154\x61\x73\163" => "\x62\164\156\40\x62\x74\x6e\55\142\x6c\x75\x65\x20\x62\x74\x6e\55\154\147"], "\x6c\x61\x62\x65\x6c" => "\123\141\x76\x65"]); goto b4c4b; eb9c2: } private function createReverseProxySettingsForm(Site $site) : Form { goto e8b3b; Cb435: $form = $this->createForm("\101\x70\x70\x5c\x46\157\162\155\134\123\151\x74\145\122\x65\x76\145\x72\163\145\x50\x72\x6f\170\171\123\x65\x74\164\x69\x6e\147\163\x54\x79\160\x65", $data, ["\x61\143\164\x69\x6f\x6e" => $this->generateUrl("\x63\154\160\x5f\163\151\x74\145\x5f\163\145\x74\x74\151\x6e\x67\163", ["\144\157\x6d\x61\x69\156\116\141\x6d\x65" => $site->getDomainName()]), "\x6d\145\x74\150\157\144" => "\120\117\123\124", "\x61\x74\164\162" => ["\x69\x64" => "\x72\145\166\x65\162\x73\x65\55\x70\x72\x6f\x78\x79\x2d\x73\145\164\x74\x69\156\x67\163\x2d\146\157\162\x6d"]]); goto E37f6; C782c: return $form; goto e6a31; e8b3b: $data = ["\x72\145\166\145\x72\163\x65\x50\162\x6f\170\171\125\x72\154" => $site->getReverseProxyUrl()]; goto Cb435; E37f6: $form->add("\163\165\x62\x6d\x69\x74", SubmitType::class, ["\141\164\164\x72" => ["\x63\154\141\x73\x73" => "\x62\164\156\x20\x62\x74\156\55\142\x6c\165\x65\40\142\164\x6e\55\x6c\147"], "\x6c\141\142\x65\x6c" => "\x53\141\166\145"]); goto C782c; e6a31: } private function createNodejsSettingsForm(Site $site, NodejsSettings $nodejsSettings) : Form { goto fd087; b727f: return $form; goto dcb93; fd087: $form = $this->createForm("\101\x70\160\x5c\x46\157\162\155\x5c\x53\x69\x74\145\x4e\157\x64\x65\152\163\123\x65\164\164\x69\x6e\147\x73\124\171\x70\x65", $nodejsSettings, ["\x61\x63\164\151\157\x6e" => $this->generateUrl("\143\x6c\160\137\163\x69\164\x65\137\163\x65\164\x74\x69\x6e\x67\163", ["\x64\157\x6d\x61\x69\x6e\x4e\141\155\x65" => $site->getDomainName()]), "\155\x65\x74\x68\157\144" => "\120\x4f\x53\x54", "\141\164\x74\162" => ["\151\144" => "\156\x6f\144\x65\152\163\x2d\163\145\164\x74\151\x6e\147\x73\x2d\146\x6f\x72\155"]]); goto b28a9; b28a9: $form->add("\163\165\x62\155\151\164", SubmitType::class, ["\x61\x74\x74\x72" => ["\143\154\141\x73\x73" => "\x62\164\x6e\40\142\164\x6e\x2d\142\154\165\x65\40\142\x74\156\55\154\x67"], "\154\x61\x62\x65\154" => "\123\141\166\145"]); goto b727f; dcb93: } private function createPhpSettingsForm(Site $site, PhpSettings $phpSettings) : Form { goto a36cb; cf671: return $form; goto Bae52; a36cb: $form = $this->createForm("\x41\x70\x70\134\x46\157\162\155\x5c\x53\151\164\145\x50\x68\160\x53\145\x74\x74\x69\156\147\x73\x54\171\x70\x65", $phpSettings, ["\x61\143\x74\151\x6f\x6e" => $this->generateUrl("\x63\154\160\137\x73\x69\x74\x65\137\163\145\164\164\151\x6e\147\x73", ["\x64\157\x6d\x61\151\x6e\x4e\x61\x6d\145" => $site->getDomainName()]), "\155\x65\x74\x68\157\144" => "\120\117\123\x54", "\x61\x74\164\x72" => []]); goto De93f; De93f: $form->add("\x73\165\142\x6d\x69\x74", SubmitType::class, ["\141\164\164\x72" => ["\143\x6c\x61\163\x73" => "\x62\164\156\x20\x62\x74\156\55\x62\154\x75\145\x20\x62\x74\156\55\154\x67"], "\154\x61\142\145\x6c" => "\123\x61\x76\145"]); goto cf671; Bae52: } private function createPythonSettingsForm(Site $site, PythonSettings $pythonSettings) : Form { goto C83e0; F280c: return $form; goto A1801; a2dd1: $form->add("\163\x75\142\155\x69\164", SubmitType::class, ["\141\x74\164\x72" => ["\143\154\x61\x73\x73" => "\x62\x74\x6e\x20\x62\164\x6e\x2d\x62\154\x75\145\x20\142\164\x6e\x2d\x6c\x67"], "\x6c\141\x62\x65\x6c" => "\123\141\x76\145"]); goto F280c; C83e0: $form = $this->createForm("\101\x70\160\134\x46\x6f\x72\155\134\123\151\x74\145\x50\x79\164\x68\157\x6e\123\x65\x74\164\151\156\147\163\124\171\x70\145", $pythonSettings, ["\141\143\x74\x69\x6f\156" => $this->generateUrl("\x63\154\160\137\x73\151\164\x65\x5f\x73\x65\164\x74\151\x6e\147\x73", ["\144\157\x6d\141\151\156\x4e\x61\x6d\x65" => $site->getDomainName()]), "\x6d\145\x74\x68\157\144" => "\x50\117\x53\124", "\x61\x74\x74\162" => []]); goto a2dd1; A1801: } private function createSiteDeleteForm(Site $site, array $data) : Form { goto D561c; Ce162: $form->add("\x73\165\x62\x6d\151\x74", SubmitType::class, ["\141\x74\164\x72" => ["\143\154\x61\x73\163" => "\x62\x74\x6e\x20\x62\x74\x6e\55\x62\154\165\145\x20\142\164\x6e\55\x6c\147", "\144\151\x73\141\142\154\145\x64" => "\144\x69\163\x61\x62\x6c\145\144"], "\x6c\x61\142\145\x6c" => "\104\145\154\x65\164\145\x20\x53\x69\x74\145"]); goto b7091; b7091: return $form; goto b9867; D561c: $form = $this->createForm("\101\x70\x70\x5c\106\157\x72\x6d\134\123\x69\x74\145\x44\x65\154\145\164\x65\x54\x79\x70\145", $data, ["\141\143\x74\151\157\156" => $this->generateUrl("\x63\154\160\137\x73\x69\164\145\x5f\x73\145\164\x74\x69\156\x67\x73", ["\144\x6f\155\x61\x69\156\x4e\x61\x6d\145" => $site->getDomainName()]), "\x6d\x65\164\150\x6f\144" => "\120\117\123\124", "\141\x74\x74\x72" => []]); goto Ce162; b9867: } private function handleDomainSettingsForm(Request $request, Form $form, Site $site) { goto e52dc; Ae0e0: Fafef: goto d2095; Bbde6: goto c19ec; goto Ae0e0; fe893: $this->formErrors = $this->getErrorMessages($form); goto Bbde6; d2095: try { goto A949c; Ebc04: $this->siteEntityManager->updateEntity($siteEntity); goto d4d93; abe8e: $site->setRootDirectory($rootDirectory); goto B7682; d0fe4: return $response; goto D7820; F1f09: $response = $this->redirect($this->generateUrl("\143\x6c\x70\x5f\x73\151\164\145\x5f\x73\x65\x74\164\151\x6e\x67\163", ["\x64\x6f\155\141\151\156\116\x61\x6d\145" => $site->getDomainName()])); goto d0fe4; bd0d5: $domainName = $site->getDomainName(); goto b4b03; E3307: $session->getFlashBag()->set("\163\165\143\143\x65\163\163", $this->translator->trans("\122\157\x6f\164\40\104\151\x72\145\x63\164\x6f\162\x79\40\x68\141\x73\40\142\145\x65\156\40\163\141\x76\x65\144\56")); goto f94eb; f94eb: Ccc63: goto F1f09; B7682: $siteEntity->setRootDirectory($rootDirectory); goto Ebc04; C576b: EventQueue::addEvent(EventQueue::EVENT_SITE_ROOT_DIRECTORY_UPDATE, $user, $eventData, $request); goto E3307; A949c: $user = $this->getUser(); goto df1cf; b4b03: $siteEntity = $this->getSiteEntity($domainName); goto a816c; b0a98: $eventData = ["\163\x69\164\145" => $domainName, "\x72\x6f\157\164\x44\x69\x72\x65\143\164\x6f\162\x79" => $rootDirectory]; goto C576b; d4d93: $siteUpdater = $this->getSiteUpdater($site); goto F5a12; a816c: if (!(false === is_null($siteEntity))) { goto Ccc63; } goto a81c0; df1cf: $session = $request->getSession(); goto bd0d5; F5a12: $siteUpdater->domainSettings(); goto b0a98; a81c0: $rootDirectory = rtrim($form->get("\162\157\157\x74\104\151\x72\145\x63\164\157\x72\171")->getData(), "\57"); goto abe8e; D7820: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\147\x65\162", $this->translator->trans("\101\x6e\x20\x65\x72\x72\x6f\x72\40\x68\141\x73\x20\157\143\x63\165\x72\x72\x65\x64\54\40\x65\x72\x72\x6f\x72\40\x6d\x65\163\163\x61\x67\145\x3a\x20\45\x65\x72\162\x6f\162\115\x65\163\x73\x61\x67\x65\x25", ["\x25\145\162\x72\x6f\x72\115\x65\163\163\141\x67\x65\x25" => $e->getMessage()])); } goto d58b4; d58b4: c19ec: goto F5ee1; e52dc: if (true === $form->isValid()) { goto Fafef; } goto fe893; F5ee1: } private function handleSiteUserSettingsForm(Request $request, Form $form, Site $site) { goto efc70; ce520: Dd3c3: goto ccb84; fae67: goto Dd3c3; goto dc923; ee639: $this->formErrors = $this->getErrorMessages($form); goto fae67; a71da: try { goto ee6a0; a07f3: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\x73\151\x74\x65\x5f\x73\x65\164\x74\x69\x6e\x67\x73", ["\144\157\155\x61\x69\x6e\x4e\141\x6d\x65" => $site->getDomainName()])); goto E2c00; E2c00: return $response; goto D9a2c; A28f0: if (!(false === is_null($siteEntity))) { goto f715c; } goto e6b53; E119f: $password = trim($form->get("\160\x61\x73\163\167\x6f\162\x64")->getData()); goto f5509; E7445: $this->siteEntityManager->updateEntity($siteEntity); goto c0d06; f5509: $siteEntity->setSshKeys($sshKeys); goto E7445; e5294: $session = $request->getSession(); goto d15d5; Eae4c: if (!(false === empty($password))) { goto Ba18e; } goto ebe15; b4883: $eventData = ["\163\x69\x74\145" => $domainName, "\163\163\x68\x4b\145\171\163" => $sshKeys]; goto Dd2a7; Dd2a7: EventQueue::addEvent(EventQueue::EVENT_SITE_USER_SETTINGS_UPDATE, $user, $eventData, $request); goto E558f; E558f: $session->getFlashBag()->set("\163\x75\143\143\x65\163\x73", $this->translator->trans("\123\x69\164\x65\x20\125\x73\x65\162\40\123\x65\x74\x74\x69\x6e\x67\x73\x20\150\x61\166\145\40\x62\145\145\x6e\40\x73\141\x76\x65\x64\x2e")); goto b1eca; e6b53: $siteUser = $site->getUser(); goto A1622; A1622: $sshKeys = trim($form->get("\163\163\150\x4b\x65\171\163")->getData()); goto E119f; Ee05b: $siteUpdater->updateUserSShKeys($siteUser, $sshKeys); goto Eae4c; b1eca: f715c: goto a07f3; c0d06: $siteUpdater = $this->getSiteUpdater($site); goto Ee05b; ebe15: $siteUpdater->changeUserPassword($siteUser, $password); goto a892b; ee6a0: $user = $this->getUser(); goto e5294; d2026: $siteEntity = $this->getSiteEntity($domainName); goto A28f0; a892b: Ba18e: goto b4883; d15d5: $domainName = $site->getDomainName(); goto d2026; D9a2c: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\x6e\x67\145\x72", $this->translator->trans("\x41\x6e\x20\145\x72\162\157\162\x20\x68\x61\x73\x20\x6f\x63\143\165\162\162\145\144\54\40\x65\x72\162\x6f\162\40\x6d\145\163\x73\141\147\145\72\x20\x25\145\x72\162\x6f\162\x4d\145\x73\x73\141\147\145\45", ["\x25\x65\162\x72\x6f\x72\x4d\x65\x73\x73\x61\147\x65\x25" => $e->getMessage()])); } goto ce520; dc923: c0dd0: goto a71da; efc70: if (true === $form->isValid()) { goto c0dd0; } goto ee639; ccb84: } private function handlePageSpeedSettingsForm(Request $request, Form $form, Site $site) { goto a9924; f0f00: goto C6017; goto a0167; a0167: A6956: goto Ceba5; a9924: if (true === $form->isValid()) { goto A6956; } goto f1994; Ceba5: try { goto Fd27f; ddd11: EventQueue::addEvent(EventQueue::EVENT_SITE_PAGE_SPEED_SETTINGS_UPDATE, $user, $eventData, $request); goto Be92e; Fd27f: $user = $this->getUser(); goto E2cb5; b6221: $siteUpdater = $this->getSiteUpdater($site); goto A8955; b4c4e: $siteEntity = $this->getSiteEntity($domainName); goto d5075; E2cb5: $session = $request->getSession(); goto Af709; Db578: $eventData = ["\163\151\164\x65" => $domainName, "\x70\141\147\145\123\x70\x65\x65\144\105\x6e\141\x62\x6c\145\x64" => $isEnabled, "\x70\x61\147\x65\123\x70\145\145\144\x53\145\164\x74\x69\x6e\x67\x73" => $settings]; goto ddd11; d5075: if (!(false === is_null($siteEntity))) { goto B33ba; } goto bd827; A8955: $siteUpdater->updateNginxVhostWithRollback(); goto C0b4c; f7b93: $settings = trim($form->get("\x73\145\164\164\151\156\147\x73")->getData()); goto A2a04; b1af6: $siteEntity->setPageSpeedEnabled($isEnabled); goto E6231; Be92e: $session->getFlashBag()->set("\163\165\143\143\x65\x73\x73", $this->translator->trans("\x50\141\x67\145\x20\123\x70\145\145\x64\x20\123\145\164\164\151\x6e\x67\163\x20\x68\x61\x76\x65\x20\x62\145\x65\156\x20\163\141\x76\145\144\56")); goto A37b8; e481a: $response = $this->redirect($this->generateUrl("\x63\x6c\160\137\163\x69\x74\145\137\163\145\x74\x74\151\156\147\163", ["\144\x6f\x6d\x61\151\156\116\141\x6d\145" => $site->getDomainName()])); goto C5962; C5962: return $response; goto db2e7; F19b3: $this->siteEntityManager->updateEntity($siteEntity); goto Db578; A2a04: $site->setPageSpeedEnabled($isEnabled); goto d0daf; Af709: $domainName = $site->getDomainName(); goto b4c4e; bd827: $isEnabled = $form->get("\x69\x73\105\x6e\141\x62\154\x65\144")->getData(); goto f7b93; C0b4c: $siteUpdater->purgePageSpeedCache(); goto b1af6; E6231: $siteEntity->setPageSpeedSettings($settings); goto F19b3; A37b8: B33ba: goto e481a; d0daf: $site->setPageSpeedSettings($settings); goto b6221; db2e7: } catch (InvalidVhostException $e) { $session->getFlashBag()->set("\144\x61\156\x67\145\162", $this->translator->trans("\120\x61\147\145\123\x70\145\x65\x64\x20\123\145\164\164\x69\156\147\40\141\162\145\40\x6e\157\164\x20\x76\141\x6c\151\144\x2c\x20\145\x72\x72\x6f\x72\x20\x6d\x65\163\163\141\147\x65\72\x20\45\145\x72\x72\x6f\x72\115\145\163\x73\141\147\145\x25", ["\45\x65\x72\x72\x6f\162\115\145\163\x73\141\x67\x65\45" => $e->getMessage()])); } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\156\147\145\x72", $this->translator->trans("\101\156\40\145\x72\162\157\x72\40\x68\x61\x73\40\x6f\x63\x63\165\x72\162\145\x64\x2c\40\x65\162\162\157\x72\40\155\x65\x73\x73\x61\x67\x65\x3a\40\45\145\x72\x72\157\162\115\145\x73\163\x61\147\145\45", ["\x25\145\x72\x72\157\162\x4d\145\x73\x73\141\x67\x65\45" => $e->getMessage()])); } goto D4a09; D4a09: C6017: goto dc7b0; f1994: $this->formErrors = $this->getErrorMessages($form); goto f0f00; dc7b0: } private function handleSiteDeleteForm(Request $request, Form $form, Site $site) { goto A2b62; A2b62: if (true === $form->isValid()) { goto ceeef; } goto dc7a1; D8775: try { goto de5f1; D910a: $session = $request->getSession(); goto bde86; bde86: $domainName = $site->getDomainName(); goto b7a1b; Bea80: E19d1: goto b212f; cd334: $session->getFlashBag()->set("\x73\x75\x63\x63\145\x73\x73", $this->translator->trans("\x53\151\x74\145\40\150\x61\163\40\142\145\x65\x6e\40\144\x65\x6c\x65\x74\x65\x64\56")); goto Bea80; b212f: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\163\x69\x74\x65\163")); goto E25ca; E25ca: return $response; goto ad220; de5f1: $user = $this->getUser(); goto D910a; F89fc: $siteDeleter = $this->getSiteDeleter($site); goto A9174; Ed1fa: EventQueue::addEvent(EventQueue::EVENT_SITE_DELETE, $user, $eventData, $request); goto cd334; b3702: $this->siteEntityManager->deleteEntity($siteEntity); goto C706b; D2385: if (!(false === is_null($siteEntity))) { goto E19d1; } goto F89fc; A9174: $siteDeleter->delete(); goto b3702; b7a1b: $siteEntity = $this->getSiteEntity($domainName); goto D2385; C706b: $eventData = ["\x73\x69\x74\x65" => $domainName, "\164\x79\160\x65" => $site->getType()]; goto Ed1fa; ad220: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\147\145\x72", $this->translator->trans("\x41\156\40\145\x72\x72\x6f\162\40\150\x61\x73\x20\157\x63\143\165\x72\162\145\x64\x2c\x20\x65\x72\162\157\x72\x20\x6d\x65\x73\163\x61\147\x65\72\x20\x25\x65\x72\162\x6f\x72\115\145\163\x73\141\x67\145\45", ["\x25\x65\162\x72\x6f\162\115\x65\163\163\x61\x67\x65\45" => $e->getMessage()])); } goto f575d; dc7a1: $this->formErrors = $this->getErrorMessages($form); goto a4c88; f575d: F1ddf: goto Ac4d8; E3778: ceeef: goto D8775; a4c88: goto F1ddf; goto E3778; Ac4d8: } private function handleNodejsSettingsForm(Request $request, Form $form, NodejsSettings $currentNodejsSettings, Site $site) { goto a3b2e; e416b: ae52a: goto A2565; ddce5: goto ae52a; goto a23e2; f8ee4: $this->formErrors = $this->getErrorMessages($form); goto ddce5; e5b43: try { goto d05f8; ab3bb: $eventData = ["\163\x69\164\x65" => $domainName, "\x6e\x6f\x64\145\x6a\x73\x56\x65\162\163\x69\157\156" => $nodejsVersion, "\x70\157\x72\x74" => $nodejsSettings->getPort()]; goto E9587; b66a3: $siteUpdater->nodejsSettings(); goto B1f9d; b04b2: D8d56: goto b66a3; d05f8: $user = $this->getUser(); goto b16ea; Dc8ef: $domainName = $site->getDomainName(); goto d5338; A0e91: $siteUpdater->installNodejsVersion(); goto b04b2; Ddaad: e0986: goto B1000; b16ea: $session = $request->getSession(); goto Dc8ef; eaaa8: if (!(true === $hasNodejsVersionChanged)) { goto D8d56; } goto A0e91; bb236: if (!(false === is_null($siteEntity))) { goto e0986; } goto A5fa4; d5338: $siteEntity = $this->getSiteEntity($domainName); goto bb236; f6d93: $session->getFlashBag()->set("\x73\165\x63\143\145\163\x73", $this->translator->trans("\116\157\x64\145\56\x6a\x73\40\123\145\164\x74\151\x6e\x67\x73\40\x68\141\166\145\x20\142\145\x65\x6e\x20\x73\x61\166\145\x64\56")); goto Ddaad; aeeaa: $hasNodejsVersionChanged = $currentNodejsSettings->getNodejsVersion() != $nodejsVersion; goto d6955; Ac655: $nodejsVersion = $nodejsSettings->getNodejsVersion(); goto aeeaa; B1f9d: $this->siteEntityManager->updateEntity($siteEntity); goto ab3bb; A5fa4: $nodejsSettings = $form->getData(); goto Ac655; B1000: $response = $this->redirect($this->generateUrl("\143\154\160\x5f\x73\x69\x74\145\137\x73\x65\x74\x74\x69\156\147\x73", ["\144\157\155\x61\151\156\116\x61\x6d\145" => $site->getDomainName()])); goto d9401; d6955: $siteUpdater = $this->getSiteUpdater($site); goto eaaa8; d9401: return $response; goto C8dea; E9587: EventQueue::addEvent(EventQueue::EVENT_SITE_NODEJS_SETTINGS_UPDATE, $user, $eventData, $request); goto f6d93; C8dea: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\x61\156\147\145\162", $this->translator->trans("\101\156\x20\x65\x72\162\x6f\x72\x20\150\141\163\40\157\x63\x63\165\x72\162\x65\144\x2c\x20\145\x72\162\x6f\x72\40\155\x65\x73\x73\141\x67\145\x3a\40\45\x65\x72\162\x6f\x72\115\x65\x73\x73\x61\x67\x65\45", ["\x25\x65\162\162\157\162\115\145\x73\163\x61\x67\x65\45" => $e->getMessage()])); } goto e416b; a23e2: d7efa: goto e5b43; a3b2e: if (true === $form->isValid()) { goto d7efa; } goto f8ee4; A2565: } private function handlePythonSettingsForm(Request $request, Form $form, Site $site) { goto Af326; ac730: goto A0b08; goto D90cf; D90cf: Dfbef: goto F0e7c; F115c: $this->formErrors = $this->getErrorMessages($form); goto ac730; bc57e: A0b08: goto D201d; Af326: if (true === $form->isValid()) { goto Dfbef; } goto F115c; F0e7c: try { goto Df475; fd778: EventQueue::addEvent(EventQueue::EVENT_SITE_PYTHON_SETTINGS_UPDATE, $user, $eventData, $request); goto B9a5b; fa16e: $session = $request->getSession(); goto fdbc7; aadbe: A856f: goto ef6e6; B9a5b: $session->getFlashBag()->set("\163\x75\143\x63\x65\163\x73", $this->translator->trans("\120\171\164\150\x6f\x6e\x20\x53\x65\164\164\x69\x6e\x67\x73\x20\150\x61\x76\145\x20\x62\x65\x65\x6e\x20\163\141\x76\145\144\x2e")); goto aadbe; B6365: $siteUpdater = $this->getSiteUpdater($site); goto Bf45b; d81e7: $this->siteEntityManager->updateEntity($siteEntity); goto b8515; b50e8: if (!(false === is_null($siteEntity))) { goto A856f; } goto A16c8; ef6e6: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\163\x69\164\x65\x5f\x73\x65\x74\x74\x69\x6e\147\x73", ["\x64\157\155\141\x69\156\x4e\x61\x6d\x65" => $site->getDomainName()])); goto F34b8; A16c8: $pythonSettings = $form->getData(); goto B6d8b; d3104: $siteEntity = $this->getSiteEntity($domainName); goto b50e8; F34b8: return $response; goto d853b; c4680: $siteUpdater->pythonSettings(); goto d81e7; Df475: $user = $this->getUser(); goto fa16e; Bf45b: $siteUpdater->writePythonVersionFile(); goto c4680; fdbc7: $domainName = $site->getDomainName(); goto d3104; B6d8b: $pythonVersion = $pythonSettings->getPythonVersion(); goto B6365; b8515: $eventData = ["\x73\151\164\x65" => $domainName, "\160\x79\x74\x68\157\156\x56\x65\x72\x73\151\x6f\156" => $pythonVersion, "\x70\157\162\x74" => $pythonSettings->getPort()]; goto fd778; d853b: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\141\156\x67\x65\162", $this->translator->trans("\x41\156\x20\x65\162\162\157\162\40\150\141\163\x20\x6f\143\x63\165\x72\x72\x65\x64\54\x20\145\x72\162\x6f\x72\40\155\x65\163\163\x61\x67\x65\x3a\40\x25\145\162\x72\157\162\115\x65\x73\163\x61\x67\x65\45", ["\x25\x65\x72\x72\157\162\x4d\145\x73\x73\141\147\x65\45" => $e->getMessage()])); } goto bc57e; D201d: } private function handleReverseProxySettingsForm(Request $request, Form $form, Site $site) { goto c3fe5; d4a0d: try { goto Dbd09; A561a: $session->getFlashBag()->set("\163\x75\x63\143\x65\x73\163", $this->translator->trans("\x52\x65\166\145\162\163\x65\x20\120\x72\157\x78\171\40\123\x65\x74\x74\151\156\147\x73\40\x68\141\166\145\x20\142\145\x65\x6e\40\x73\141\166\145\144\56")); goto Db5a0; Cc0a8: return $response; goto C7787; Ece75: $this->siteEntityManager->updateEntity($siteEntity); goto f4310; b3780: $reverseProxyUrl = $form->get("\162\x65\166\145\162\x73\145\x50\162\x6f\170\x79\x55\162\x6c")->getData(); goto c874c; Cd26a: $response = $this->redirect($this->generateUrl("\x63\x6c\160\137\163\x69\164\x65\x5f\163\x65\x74\164\151\x6e\147\163", ["\x64\x6f\155\141\151\x6e\x4e\x61\155\x65" => $site->getDomainName()])); goto Cc0a8; f4310: $eventData = ["\163\x69\164\x65" => $domainName, "\162\x65\x76\x65\162\163\145\x50\x72\x6f\170\x79\125\162\x6c" => $reverseProxyUrl]; goto c9033; e29ac: if (!(false === is_null($siteEntity))) { goto dc1ba; } goto b3780; Db5a0: dc1ba: goto Cd26a; Dbd09: $user = $this->getUser(); goto ce921; eacef: $siteUpdater = $this->getSiteUpdater($site); goto C3bae; c9033: EventQueue::addEvent(EventQueue::EVENT_SITE_REVERSE_PROXY_SETTINGS_UPDATE, $user, $eventData, $request); goto A561a; ce921: $session = $request->getSession(); goto f3eb5; C3bae: $siteUpdater->updateNginxVhostWithRollback(); goto Ece75; c874c: $site->setReverseProxyUrl($reverseProxyUrl); goto A359e; f3eb5: $domainName = $site->getDomainName(); goto Ceb8d; A359e: $siteEntity->setReverseProxyUrl($reverseProxyUrl); goto eacef; Ceb8d: $siteEntity = $this->getSiteEntity($domainName); goto e29ac; C7787: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\x61\x6e\147\145\x72", $this->translator->trans("\101\156\40\145\x72\162\157\162\40\x68\x61\x73\40\157\143\x63\165\162\x72\145\x64\x2c\x20\x65\x72\x72\x6f\162\x20\155\145\163\x73\x61\147\x65\x3a\40\x25\x65\162\x72\157\162\115\145\x73\x73\141\147\145\x25", ["\45\145\x72\162\157\x72\115\x65\163\x73\141\x67\x65\x25" => $e->getMessage()])); } goto B96a3; B96a3: f2def: goto fb0e9; c3fe5: if (true === $form->isValid()) { goto f8372; } goto Fcee6; ed490: f8372: goto d4a0d; B58ac: goto f2def; goto ed490; Fcee6: $this->formErrors = $this->getErrorMessages($form); goto B58ac; fb0e9: } private function handlePhpSettingsForm(Request $request, Form $form, PhpSettings $currentPhpSettings, Site $site) { goto Ff69c; Fe9f6: goto f753a; goto E3c81; E3c81: c1d5c: goto d5fac; B8e80: f753a: goto E8b8f; b0195: $this->formErrors = $this->getErrorMessages($form); goto Fe9f6; Ff69c: if (true === $form->isValid()) { goto c1d5c; } goto b0195; d5fac: try { goto D3b45; e58c9: EventQueue::addEvent(EventQueue::EVENT_SITE_PHP_SETTINGS_UPDATE, $user, $eventData, $request); goto C7234; d727b: $siteEntity = $this->getSiteEntity($domainName); goto d10fb; c983e: $siteUpdater->phpSettings(); goto Fa3a4; Bf0a9: $phpSettings = $form->getData(); goto Be2ee; D3b45: $user = $this->getUser(); goto fc394; Fa3a4: $this->siteEntityManager->updateEntity($siteEntity); goto ab2ab; F7c1b: c95d2: goto Be7f5; d10fb: if (!(false === is_null($siteEntity))) { goto c95d2; } goto Bf0a9; fc394: $session = $request->getSession(); goto d005a; C7234: $session->getFlashBag()->set("\x73\165\143\x63\x65\x73\x73", $this->translator->trans("\120\110\120\x20\x53\x65\x74\164\151\156\x67\x73\x20\150\141\x76\145\x20\x62\145\145\156\x20\163\141\166\x65\x64\x2e")); goto F7c1b; Be7f5: $response = $this->redirect($this->generateUrl("\143\x6c\160\137\x73\151\164\x65\x5f\163\145\x74\164\x69\x6e\147\x73", ["\144\x6f\x6d\x61\151\x6e\116\x61\155\145" => $site->getDomainName()])); goto f81d1; Be2ee: $hasPhpVersionChanged = $currentPhpSettings->getPhpVersion() != $phpSettings->getPhpVersion(); goto ad8fb; d7f2c: if (!(true === $hasPhpVersionChanged)) { goto C6b7b; } goto Caac1; ab2ab: $eventData = ["\163\151\x74\145" => $domainName, "\x70\150\160\x56\145\x72\x73\151\x6f\x6e" => $phpSettings->getPhpVersion(), "\155\x65\x6d\x6f\x72\171\137\154\151\x6d\x69\x74" => $phpSettings->getMemoryLimit(), "\155\x61\170\137\x65\170\x65\x63\x75\x74\151\157\156\x5f\x74\151\x6d\x65" => $phpSettings->getMaxExecutionTime(), "\x6d\x61\170\137\x69\x6e\x70\x75\x74\137\x74\151\x6d\x65" => $phpSettings->getMaxInputTime(), "\155\x61\170\137\x69\156\x70\x75\164\x5f\x76\141\x72\163" => $phpSettings->getMaxInputVars(), "\160\x6f\x73\x74\137\155\141\x78\137\x73\x69\x7a\145" => $phpSettings->getPostMaxSize(), "\x75\160\x6c\x6f\x61\x64\137\155\x61\170\x5f\x66\x69\154\x65\x73\151\172\x65" => $phpSettings->getUploadMaxFileSize()]; goto e58c9; bf607: C6b7b: goto c983e; ad8fb: $siteUpdater = $this->getSiteUpdater($site); goto d7f2c; d005a: $domainName = $site->getDomainName(); goto d727b; f81d1: return $response; goto Dd11f; Caac1: $siteUpdater->changePhpVersion($currentPhpSettings->getPhpVersion(), $phpSettings->getPhpVersion()); goto bf607; Dd11f: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\x61\156\147\145\x72", $this->translator->trans("\x41\x6e\x20\x65\x72\162\x6f\x72\40\150\x61\163\40\x6f\x63\x63\x75\162\x72\x65\x64\x2c\40\145\x72\x72\157\162\40\155\145\x73\163\x61\147\x65\x3a\x20\x25\145\x72\x72\157\x72\x4d\x65\163\163\141\x67\145\45", ["\45\x65\x72\162\x6f\x72\x4d\x65\x73\x73\141\147\145\x25" => $e->getMessage()])); } goto B8e80; E8b8f: } private function getSite(Request $request) : ?Site { goto F463e; Cfac4: $subdomain = $resolvedDomainName->subDomain()->toString(); goto bfa36; Ce4e5: $registrableDomain = $resolvedDomainName->registrableDomain()->toString(); goto Cfac4; C027c: $siteEntity = $this->getSiteEntity($domainName); goto d2cc0; E77c9: $site->setCronJobs($siteEntity->getCronJobs()); goto E60e5; Daa55: $site->setDatabases($siteDatabases); goto f2bf6; Baa01: $site->setCertificates($siteEntity->getCertificates()); goto E77c9; Bbdeb: $site->setRegistrableDomain($registrableDomain); goto e0396; F29e8: $site->setUser($siteEntity->getUser()); goto Ddaf2; a4482: f6cd7: goto D87cf; b0988: $site->setPageSpeedEnabled($siteEntity->getPageSpeedEnabled()); goto B0a4a; D56e8: $site->setSshUsers($siteEntity->getSshUsers()); goto Cac86; A3581: $site->setBasicAuth($siteEntity->getBasicAuth()); goto E278b; d498a: b8c55: goto Dc757; bfa36: $subdomain = false === empty($subdomain) ? $subdomain : null; goto e6b78; ed0e8: if (!(UserEntity::ROLE_USER == $user->getRole() && false === $user->hasSite($siteEntity))) { goto C1602; } goto f9b6e; f9b6e: return null; goto Eb4d3; Dc757: if (!(false === is_null($site))) { goto c9512; } goto Fb03a; F24c0: switch ($siteType) { case SiteEntity::TYPE_NODEJS: goto d2acc; a49f7: goto b8c55; goto Aa040; d2acc: $site = new NodejsSite(); goto C235d; C235d: $site->setNodejsSettings($siteEntity->getNodejsSettings()); goto a49f7; Aa040: case SiteEntity::TYPE_STATIC: $site = new StaticSite(); goto b8c55; case SiteEntity::TYPE_PHP: goto E63ff; E63ff: $site = new PhpSite(); goto C2560; c4630: $site->setVarnishCache($siteEntity->getVarnishCache()); goto c571c; C2560: $site->setPhpSettings($siteEntity->getPhpSettings()); goto c4630; c571c: goto b8c55; goto bbfa3; bbfa3: case SiteEntity::TYPE_PYTHON: goto E685c; D0755: $site->setPythonSettings($siteEntity->getPythonSettings()); goto A40cc; E685c: $site = new PythonSite(); goto D0755; A40cc: goto b8c55; goto b3631; b3631: case SiteEntity::TYPE_REVERSE_PROXY: goto E0b76; Cb58b: $site->setReverseProxyUrl($siteEntity->getReverseProxyUrl()); goto D0d2f; D0d2f: goto b8c55; goto Cec5b; E0b76: $site = new ReverseProxySite(); goto Cb58b; Cec5b: } goto A3d87; d2cc0: $site = null; goto B1278; Fb03a: $resolvedDomainName = $this->domainNameParser->resolveDomainName($domainName); goto Ce4e5; E278b: $site->setBlockedBots($siteEntity->getBlockedBots()); goto Ead31; D87cf: return $site; goto e3f4a; f7ff6: $site->setAllowTrafficFromCloudflareOnly($siteEntity->allowTrafficFromCloudflareOnly()); goto b0988; a89fb: $domainName = $request->get("\144\x6f\155\141\151\156\x4e\x61\155\145"); goto C027c; Eb4d3: C1602: goto B9326; F463e: $user = $this->getUser(); goto a89fb; b1666: c9512: goto a4482; e6b78: $siteDatabases = $this->getSiteDatabases($siteEntity); goto F29e8; Cac86: $site->setSshKeys($siteEntity->getSshKeys()); goto de782; A3d87: Accb3: goto d498a; de782: $site->setVhostTemplate($siteEntity->getVhostTemplate()); goto f7ff6; f2bf6: $site->setCertificate($siteEntity->getCertificate()); goto Baa01; e0396: $site->setSubdomain($subdomain); goto Ba301; Ddaf2: $site->setDomainName($siteEntity->getDomainName()); goto Bbdeb; Ba301: $site->setRootDirectory($siteEntity->getRootDirectory()); goto A3581; B1278: if (!(false === is_null($siteEntity))) { goto f6cd7; } goto ed0e8; B0a4a: $site->setPageSpeedSettings($siteEntity->getPageSpeedSettings()); goto b1666; E60e5: $site->setFtpUsers($siteEntity->getFtpUsers()); goto D56e8; Ead31: $site->setBlockedIps($siteEntity->getBlockedIps()); goto Daa55; B9326: $siteType = $siteEntity->getType(); goto F24c0; e3f4a: } private function getSiteDatabases(SiteEntity $siteEntity) : ?ArrayCollection { goto C5387; c9c1f: $databaseEntities = $siteEntity->getDatabases(); goto fa0b7; C5387: $siteDatabases = new ArrayCollection(); goto A5959; A5959: $activeDatabaseServerEntity = $this->databaseServerEntityManager->getActiveDatabaseServer(); goto c9c1f; Ae10a: return $siteDatabases; goto B3d66; F9a3e: Bf79c: goto Ae10a; fa0b7: foreach ($databaseEntities as $databaseEntity) { goto Ac7b3; E6c07: if (!($databaseServerEntity->getId() == $activeDatabaseServerEntity->getId())) { goto b1a8c; } goto D8315; Ac7b3: $databaseServerEntity = $databaseEntity->getDatabaseServer(); goto E6c07; D8315: $siteDatabases->add($databaseEntity); goto f95c5; f95c5: b1a8c: goto Abf90; Abf90: a4df9: goto Bd633; Bd633: } goto F9a3e; B3d66: } private function getSiteUpdater(Site $site) : ?SiteUpdater { goto F11ad; c820b: return $siteUpdater; goto c3b78; cfb74: switch ($siteType) { case SiteEntity::TYPE_NODEJS: $siteUpdater = new NodejsSiteUpdater($site); goto db92a; case SiteEntity::TYPE_STATIC: $siteUpdater = new StaticSiteUpdater($site); goto db92a; case SiteEntity::TYPE_PHP: $siteUpdater = new PhpSiteUpdater($site); goto db92a; case SiteEntity::TYPE_PYTHON: $siteUpdater = new PythonSiteUpdater($site); goto db92a; case SiteEntity::TYPE_REVERSE_PROXY: $siteUpdater = new ReverseProxySiteUpdater($site); goto db92a; } goto afa59; F11ad: $siteUpdater = null; goto eb902; afa59: E5064: goto b6388; eb902: $siteType = $site->getType(); goto cfb74; b6388: db92a: goto c820b; c3b78: } protected function getSiteDeleter(Site $site) : ?SiteDeleter { goto Edf8c; ace65: $siteType = $site->getType(); goto d5102; d5102: switch ($siteType) { case SiteEntity::TYPE_NODEJS: $siteDeleter = new NodejsSiteDeleter($site); goto Cc862; case SiteEntity::TYPE_STATIC: $siteDeleter = new StaticSiteDeleter($site); goto Cc862; case SiteEntity::TYPE_PHP: $siteDeleter = new PhpSiteDeleter($site); goto Cc862; case SiteEntity::TYPE_PYTHON: $siteDeleter = new PythonSiteDeleter($site); goto Cc862; case SiteEntity::TYPE_REVERSE_PROXY: $siteDeleter = new ReverseProxySiteDeleter($site); goto Cc862; } goto Df229; Edf8c: $siteDeleter = null; goto ace65; aac76: Cc862: goto D3523; D3523: return $siteDeleter; goto c6b0d; Df229: Da03c: goto aac76; c6b0d: } private function getSiteEntity(string $domainName) : ?SiteEntity { $siteEntity = $this->siteEntityManager->findOneByDomainName($domainName); return $siteEntity; } }
