<?php
 namespace App\Controller\Frontend; use Symfony\Component\HttpFoundation\Request; use Symfony\Component\HttpFoundation\Response; use Symfony\Component\Security\Http\Authentication\AuthenticationUtils; use Symfony\Component\Form\Extension\Core\Type\SubmitType; use Symfony\Component\Form\Form; use App\Controller\Controller; use App\Entity\User; class LoginController extends Controller { public function login(Request $request, AuthenticationUtils $authenticationUtils) : Response { goto f663f; f663f: $authenticationError = $authenticationUtils->getLastAuthenticationError(); goto D3204; f7da0: return $response; goto Afa51; D3204: $response = $this->render("\x46\162\x6f\x6e\x74\x65\x6e\144\x2f\x4c\157\147\x69\156\57\154\x6f\x67\151\x6e\x2e\150\164\x6d\x6c\56\x74\x77\151\x67", ["\141\165\164\x68\x65\156\x74\x69\143\x61\x74\x69\x6f\156\x45\162\162\157\x72" => $authenticationError]); goto f7da0; Afa51: } public function loginMfa(Request $request) : Response { goto Dd620; dbc47: Cc72a: goto ca331; a4ea7: $response = $this->redirect($this->generateUrl("\143\154\x70\x5f\x6c\x6f\147\x69\156")); goto e1308; fa127: D3fca: goto D2d99; Fbd26: if (!(true === $request->isMethod("\x50\117\123\124"))) { goto fe0cf; } goto F76ea; F76ea: $form->handleRequest($request); goto d10c8; d10c8: $isSubmitted = $form->isSubmitted(); goto E9a2b; b569c: fe0cf: goto b0a8c; c0cf0: $session = $request->getSession(); goto C972a; C9581: if (!(false === $user->hasMfaEnabled() || $mfaAuthenticated !== false)) { goto D3fca; } goto a0e58; e1308: return $response; goto fa127; ca331: fa19f: goto b569c; Ac138: $response = $this->handleLoginMfaCodeForm($request, $form); goto B4c40; b0a8c: $response = $this->render("\x46\162\157\x6e\164\x65\x6e\144\57\x4c\x6f\x67\x69\x6e\57\154\x6f\x67\151\156\55\155\146\x61\x2e\150\164\x6d\x6c\x2e\x74\167\x69\x67", ["\x66\157\162\155\x45\x72\x72\x6f\162\x73" => $this->formErrors, "\x66\x6f\162\x6d" => $form->createView()]); goto Df71a; E9a2b: if (!(true === $isSubmitted)) { goto fa19f; } goto Ac138; B4c40: if (!(false === is_null($response))) { goto Cc72a; } goto d15a5; a0e58: $session->remove("\x6d\x66\x61\101\165\164\x68\x65\156\x74\151\143\x61\x74\145\144"); goto a4ea7; d15a5: return $response; goto dbc47; Dd620: $user = $this->getUser(); goto c0cf0; Df71a: return $response; goto b0d93; D2d99: $form = $this->createLoginMfaForm($user); goto Fbd26; C972a: $mfaAuthenticated = $session->get("\155\x66\141\101\165\x74\x68\x65\x6e\164\x69\143\141\164\145\144"); goto C9581; b0d93: } private function createLoginMfaForm(User $user) : Form { goto Ab1d8; Eb9ad: return $form; goto D46e4; Ab1d8: $form = $this->createForm("\101\160\160\134\106\x6f\x72\155\x5c\114\x6f\147\151\156\x4d\146\x61\124\x79\x70\145", $user, ["\x61\143\164\x69\x6f\x6e" => $this->generateUrl("\x63\x6c\160\137\x6c\x6f\x67\151\x6e\137\x6d\146\x61"), "\x6d\x65\164\x68\x6f\x64" => "\120\x4f\x53\x54", "\141\164\x74\162" => []]); goto f722f; f722f: $form->add("\x73\165\142\x6d\x69\x74", SubmitType::class, ["\141\x74\x74\162" => ["\143\x6c\x61\163\x73" => "\142\x74\x6e\40\142\164\x6e\x2d\x62\154\x75\145\x20\x62\164\156\55\x6c\x6f\147\x69\x6e"], "\154\x61\142\145\154" => "\123\165\142\155\x69\x74"]); goto Eb9ad; D46e4: } private function handleLoginMfaCodeForm(Request $request, Form $form) { goto F2350; F2350: if (true === $form->isValid()) { goto cd5af; } goto eb117; E9c76: goto efd59; goto d7167; d7167: cd5af: goto b676c; eb117: $this->formErrors = $this->getErrorMessages($form); goto E9c76; c6c13: efd59: goto D2299; b676c: try { goto C0dff; ed8cf: $response = $this->redirect($this->generateUrl("\x63\154\160\x5f\163\x69\164\x65\163")); goto E4a0a; E4a0a: return $response; goto D808f; C0dff: $session = $request->getSession(); goto C5f95; C5f95: $session->set("\155\146\141\101\x75\164\x68\145\156\x74\151\143\x61\x74\x65\x64", true); goto ed8cf; D808f: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\156\147\145\162", $this->translator->trans("\x41\x6e\x20\x65\162\162\157\x72\40\x68\141\x73\x20\157\143\x63\x75\x72\x72\x65\x64\x2c\40\x65\162\x72\x6f\x72\40\155\145\x73\x73\x61\147\145\x3a\x20\45\145\x72\162\157\x72\115\145\163\x73\x61\x67\x65\45", ["\45\145\x72\x72\x6f\x72\x4d\145\163\x73\x61\147\145\x25" => $e->getMessage()])); } goto c6c13; D2299: } public function logout() : void { } }
