<?php
 namespace App\Controller\Admin; use Symfony\Component\HttpFoundation\Request; use Symfony\Component\HttpFoundation\Response; use Symfony\Component\Form\Extension\Core\Type\SubmitType; use Symfony\Component\Form\Form; use App\Entity\Manager\ConfigManager; use App\Entity\Manager\TimezoneManager; use App\Controller\Controller; use App\Event\EventQueue; class InstanceController extends Controller { public function services(Request $request) : Response { goto C82d0; C82d0: $instance = $request->attributes->get("\151\x6e\163\164\x61\156\x63\x65"); goto f2375; dd0bf: $response = $this->render("\101\144\x6d\151\156\x2f\x49\x6e\x73\x74\x61\x6e\143\x65\57\163\145\162\166\x69\143\145\x73\x2e\x68\x74\x6d\154\56\x74\167\x69\147", ["\x73\x65\x72\x76\x69\x63\145\x73" => $services]); goto A77e6; A77e6: return $response; goto Ff814; f2375: $services = $instance->getServices(); goto dd0bf; Ff814: } public function restartService(Request $request) : Response { goto E4917; e1529: try { goto ad3af; a5d97: $session = $request->getSession(); goto dc403; fcd71: $instance->restartService($service); goto B19f7; B19f7: $eventData = ["\x73\145\x72\166\x69\143\x65" => $serviceName]; goto A71c2; A71c2: EventQueue::addEvent(EventQueue::EVENT_SERVICE_RESTART, $user, $eventData, $request); goto B1184; ad3af: $user = $this->getUser(); goto a5d97; dc403: $service = $services[$serviceName]; goto fcd71; B1184: $session->getFlashBag()->set("\x73\165\143\x63\145\x73\x73", $this->translator->trans("\123\x65\x72\x76\x69\143\x65\40\167\x69\x6c\154\40\162\145\163\164\x61\x72\164\x20\x73\x68\x6f\x72\164\154\171\x2e")); goto Eec94; Eec94: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\x6e\x67\145\x72", $this->translator->trans("\101\x6e\x20\145\x72\x72\x6f\162\x20\x68\x61\163\x20\157\143\143\x75\x72\162\x65\x64\54\x20\x65\x72\162\x6f\162\x20\x6d\145\x73\x73\141\x67\x65\x3a\x20\x25\145\x72\x72\157\x72\x4d\x65\x73\x73\x61\147\x65\45", ["\45\145\x72\x72\157\162\115\x65\x73\x73\141\147\x65\x25" => $e->getMessage()])); } goto e5629; e4b27: $response = $this->redirect($this->generateUrl("\x63\154\x70\x5f\x61\144\x6d\151\156\137\163\x65\x72\166\x69\x63\145\x73")); goto e3bd9; e5629: B498e: goto e4b27; b057b: if (!(true === isset($serviceName) && true === isset($services[$serviceName]))) { goto B498e; } goto e1529; e3bd9: return $response; goto dcd08; cef5f: $serviceName = trim($request->get("\x6e\x61\x6d\145")); goto ef400; E4917: $instance = $request->attributes->get("\151\x6e\163\x74\141\x6e\143\x65"); goto cef5f; ef400: $services = $instance->getServices(); goto b057b; dcd08: } public function settings(Request $request, ConfigManager $configManager, TimezoneManager $timezoneManager) : Response { goto cd8cb; cd8cb: $proftpdSettings = ["\x6d\x61\x73\161\x75\x65\x72\x61\x64\145\x41\144\144\x72\145\163\x73" => $configManager->get("\155\x61\x73\x71\165\145\162\x61\144\145\x5f\141\x64\144\162\x65\163\x73")]; goto C2de8; D8a3f: D725b: goto e8a13; C2de8: $timezoneConfigValue = $configManager->get("\164\151\155\145\x7a\157\x6e\x65"); goto e0365; e69ad: fdcb1: goto eb73e; c695e: if (!(true === $request->isMethod("\x50\x4f\123\x54"))) { goto D9819; } goto C019f; eb73e: if (!(false === is_null($response))) { goto D725b; } goto e3ff7; e8a13: D9819: goto Ed21e; B1f98: Ddb6e: goto c636e; f3251: $proftpdSettingsForm = $this->createProftpdSettingsForm($proftpdSettings); goto cfc73; e3ff7: return $response; goto D8a3f; Ac402: return $response; goto D31b4; Fa7a3: $instanceSettings = ["\x74\x69\x6d\145\172\x6f\x6e\145" => $timezone]; goto f3251; Be94b: $response = $this->handleInstanceSettingsForm($request, $instanceSettingsForm, $configManager); goto e69ad; C019f: $response = null; goto ffe8f; ffe8f: $proftpdSettingsForm->handleRequest($request); goto C7c79; Ed21e: $response = $this->render("\101\144\155\x69\x6e\x2f\x49\x6e\163\x74\141\x6e\143\145\x2f\x73\x65\164\x74\151\x6e\147\x73\56\150\x74\x6d\154\56\x74\x77\x69\147", ["\x70\162\x6f\x66\164\x70\144\x53\x65\x74\164\151\x6e\147\163\106\x6f\162\x6d" => $proftpdSettingsForm->createView(), "\x69\156\x73\x74\141\x6e\x63\x65\x53\x65\164\164\x69\x6e\x67\163\x46\157\x72\x6d" => $instanceSettingsForm->createView(), "\146\x6f\x72\155\x45\162\x72\x6f\162\163" => $this->formErrors]); goto Ac402; c636e: if (!(true === $instanceSettingsForm->isSubmitted())) { goto fdcb1; } goto Be94b; e0365: $timezone = $timezoneManager->findOneByName($timezoneConfigValue); goto Fa7a3; Bd7e2: $response = $this->handleProftpdSettingsForm($request, $proftpdSettingsForm, $configManager); goto B1f98; C7c79: $instanceSettingsForm->handleRequest($request); goto Ec851; cfc73: $instanceSettingsForm = $this->createInstanceSettingsForm($instanceSettings); goto c695e; Ec851: if (!(true === $proftpdSettingsForm->isSubmitted())) { goto Ddb6e; } goto Bd7e2; D31b4: } private function createProftpdSettingsForm(array $data) : Form { goto C8960; C8960: $form = $this->createForm("\x41\x70\160\134\x46\x6f\x72\x6d\x5c\101\144\x6d\151\x6e\x50\x72\x6f\146\x74\160\x64\123\145\x74\164\x69\156\147\163\x54\171\160\x65", $data, ["\141\143\x74\151\157\156" => $this->generateUrl("\143\x6c\160\137\141\x64\155\151\x6e\137\151\156\163\x74\x61\156\x63\145\x5f\x73\x65\164\x74\x69\x6e\147\x73"), "\155\145\x74\150\x6f\x64" => "\x50\117\x53\x54", "\x61\x74\164\162" => []]); goto bbc71; bbc71: $form->add("\163\165\142\155\x69\x74", SubmitType::class, ["\141\x74\164\x72" => ["\x63\154\141\163\163" => "\142\164\156\x20\x62\x74\156\55\142\154\165\145\40\x62\x74\x6e\55\154\147"], "\154\141\x62\145\x6c" => "\x53\141\x76\x65"]); goto e40e8; e40e8: return $form; goto C1bec; C1bec: } private function createInstanceSettingsForm(array $data) : Form { goto e1e60; b3c04: $form->add("\163\165\142\155\151\x74", SubmitType::class, ["\x61\164\x74\162" => ["\x63\x6c\x61\163\x73" => "\142\164\x6e\x20\x62\x74\156\55\142\x6c\x75\x65\40\x62\x74\x6e\55\x6c\147"], "\x6c\141\142\145\154" => "\x53\x61\x76\145"]); goto fc5ca; e1e60: $form = $this->createForm("\x41\x70\160\x5c\x46\x6f\162\155\x5c\x41\144\155\151\x6e\111\x6e\163\164\141\x6e\143\145\x53\x65\x74\164\x69\x6e\x67\x73\x54\171\160\x65", $data, ["\x61\143\x74\151\157\156" => $this->generateUrl("\x63\154\160\137\141\144\x6d\151\156\137\151\156\x73\164\x61\x6e\x63\x65\x5f\163\145\164\x74\x69\156\147\x73"), "\x6d\x65\164\x68\157\144" => "\120\x4f\x53\x54", "\x61\164\164\x72" => []]); goto b3c04; fc5ca: return $form; goto Ee4a0; Ee4a0: } private function handleProftpdSettingsForm(Request $request, Form $form, ConfigManager $configManager) { goto e7171; e54d1: a0e6f: goto B2899; c6b05: try { goto A9d11; F8732: $configManager->set("\x6d\x61\163\x71\x75\x65\x72\141\x64\x65\137\141\x64\x64\x72\145\163\163", $masqueradeAddress); goto Dd5bf; A9d11: $user = $this->getUser(); goto Ac12a; f5bd2: return $response; goto b243c; D6048: $response = $this->redirect($this->generateUrl("\x63\154\x70\x5f\141\144\x6d\x69\x6e\x5f\151\x6e\x73\164\141\156\x63\145\x5f\163\145\164\164\x69\156\x67\163")); goto f5bd2; Ac12a: $session = $request->getSession(); goto fa682; cb050: $instance->setProftpdMasqueradeAddress($masqueradeAddress); goto F8732; fa682: $masqueradeAddress = trim($form->get("\155\x61\x73\x71\165\145\162\141\x64\145\101\x64\x64\x72\x65\x73\x73")->getData()); goto F2d4e; b9962: $session->getFlashBag()->set("\163\165\143\x63\145\163\x73", $this->translator->trans("\x4d\141\x73\x71\x75\x65\x72\141\144\145\x41\144\144\162\x65\163\163\x20\x68\x61\x73\40\142\145\x65\156\x20\163\x61\166\x65\x64\56")); goto D6048; Dd5bf: $eventData = ["\x6d\141\x73\161\x75\145\162\x61\x64\145\x41\144\x64\x72\145\163\163" => $masqueradeAddress]; goto E4169; F2d4e: $instance = $request->attributes->get("\x69\x6e\x73\x74\x61\x6e\x63\x65"); goto cb050; E4169: EventQueue::addEvent(EventQueue::EVENT_PROFTPD_MASQUERADE_ADDRESS_UPDATE, $user, $eventData, $request); goto b9962; b243c: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\x64\141\156\x67\145\162", $this->translator->trans("\x41\156\x20\145\162\162\157\162\40\x68\x61\163\x20\157\x63\143\165\x72\x72\x65\144\54\x20\x65\162\162\157\162\x20\x6d\x65\163\x73\x61\147\145\x3a\x20\45\145\162\162\157\162\x4d\x65\163\163\141\147\145\45", ["\45\145\162\162\x6f\x72\115\x65\x73\163\x61\x67\145\x25" => $e->getMessage()])); } goto e54d1; bb320: goto a0e6f; goto B345e; e7171: if (true === $form->isValid()) { goto D5a44; } goto C521f; B345e: D5a44: goto c6b05; C521f: $this->formErrors = $this->getErrorMessages($form); goto bb320; B2899: } private function handleInstanceSettingsForm(Request $request, Form $form, ConfigManager $configManager) { goto cce59; bd6c9: goto Cf184; goto Acc20; Acc20: Cea39: goto F23ab; cce59: if (true === $form->isValid()) { goto Cea39; } goto E07e8; A369c: Cf184: goto Db3bd; F23ab: try { goto d6f2f; Cb30f: $session = $request->getSession(); goto cb79c; F14ad: EventQueue::addEvent(EventQueue::EVENT_INSTANCE_TIMEZONE_UPDATE, $user, $eventData, $request); goto C533a; d6f2f: $user = $this->getUser(); goto Cb30f; cb79c: $timezone = trim($form->get("\164\x69\155\145\x7a\157\x6e\x65")->getData()); goto E2571; F3599: $eventData = ["\x74\151\x6d\145\172\157\156\x65" => $timezone]; goto F14ad; E7568: $response = $this->redirect($this->generateUrl("\143\154\x70\137\x61\x64\155\151\156\x5f\151\156\163\x74\141\x6e\143\x65\137\x73\145\164\x74\151\x6e\147\163")); goto c4afe; E2571: $instance = $request->attributes->get("\151\x6e\x73\164\141\156\143\x65"); goto f062e; f062e: $instance->setTimezone($timezone); goto A7f9d; C533a: $session->getFlashBag()->set("\x73\x75\143\143\145\163\163", $this->translator->trans("\124\151\155\x65\172\x6f\156\x65\40\150\141\x73\x20\142\x65\145\156\40\x73\141\166\x65\x64\56")); goto E7568; c4afe: return $response; goto A8dc9; A7f9d: $configManager->set("\x74\151\x6d\145\x7a\157\156\x65", $timezone); goto F3599; A8dc9: } catch (\Exception $e) { $this->logger->exception($e); $session->getFlashBag()->set("\144\x61\156\147\145\x72", $this->translator->trans("\101\x6e\40\x65\162\x72\157\x72\40\150\x61\x73\40\157\143\x63\165\x72\x72\145\144\x2c\x20\x65\162\x72\157\x72\40\x6d\145\163\163\141\147\x65\x3a\x20\x25\145\x72\162\x6f\162\x4d\145\163\163\141\147\x65\45", ["\x25\145\162\162\157\162\x4d\145\x73\163\x61\x67\145\45" => $e->getMessage()])); } goto A369c; E07e8: $this->formErrors = $this->getErrorMessages($form); goto bd6c9; Db3bd: } public function restart(Request $request) : Response { goto Aab39; ddb10: $response = $this->redirectToReferer($request); goto b9c04; bccc6: $instance->reboot(); goto e22c9; b9c04: return $response; goto E0aba; d93c4: $session->getFlashBag()->set("\x73\165\x63\143\x65\x73\x73", $this->translator->trans("\111\156\x73\x74\141\156\143\x65\40\167\x69\154\154\40\x72\145\x62\x6f\x6f\x74\x20\163\x68\157\x72\x74\x6c\x79\56")); goto ddb10; b5668: $session = $request->getSession(); goto eb3d8; e22c9: EventQueue::addEvent(EventQueue::EVENT_INSTANCE_REBOOT, $user, [], $request); goto d93c4; Aab39: $user = $this->getUser(); goto b5668; eb3d8: $instance = $request->attributes->get("\151\x6e\x73\x74\x61\156\x63\145"); goto bccc6; E0aba: } }
