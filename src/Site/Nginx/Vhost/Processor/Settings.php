<?php
 namespace App\Site\Nginx\Vhost\Processor; class Settings extends Processor { private const NGINX_BASIC_AUTH_DIRECTORY = "\57\x65\x74\x63\x2f\x6e\x67\151\156\170\57\x62\x61\163\x69\143\55\x61\165\164\x68\x2f"; private const LETS_ENCRYPT_LOCATION = "\x6c\x6f\x63\141\x74\151\x6f\156\x20\176\40\x2f\56\167\x65\154\x6c\x2d\153\x6e\157\x77\x6e\x20\x7b\xa\x20\40\x20\40\141\165\164\x68\x5f\142\141\163\151\x63\40\157\x66\x66\x3b\12\40\x20\40\40\141\x6c\154\157\x77\40\141\154\154\73\12\x20\x20\x7d\x20\x20"; private array $elements = []; protected string $placeholder = "\x7b\173\163\145\x74\x74\x69\156\x67\163\x7d\x7d"; public function process(string $content) : string { goto Ab1ce; E21e9: $this->addBlockedIps(); goto e9b8c; dcdd2: $this->addCloudflareTrafficRestriction(); goto Adab2; Dd853: return $content; goto ef856; Ab1ce: $basicAuth = $this->site->getBasicAuth(); goto c4f62; Adab2: if (!(true === is_null($basicAuth) || false === $basicAuth->getIsActive())) { goto abf69; } goto C18d0; aee00: $this->addPageSpeed(); goto dcdd2; B8213: $placeholderValue = implode(str_repeat(PHP_EOL, 2), $this->elements); goto B26c3; C18d0: $this->addBlockedBots(); goto E21e9; B26c3: $content = $this->replace($placeholderValue, $content); goto Dd853; e9b8c: abf69: goto B8213; c4f62: $this->addBasicAuth(); goto aee00; ef856: } private function addLetsEncryptLocation() : void { $this->elements[] = self::LETS_ENCRYPT_LOCATION; } private function addBasicAuth() : void { goto B3cf9; Ef78a: e533f: goto bbc46; Ce2e0: $basicAuthContent .= "\40\x20\141\165\x74\x68\137\x62\141\163\x69\143\x20\x22\122\145\x73\x74\x72\151\143\x74\145\144\x20\x41\162\145\x61\42\73" . PHP_EOL; goto B404f; F7989: if (!(false === is_null($basicAuth) && true === $basicAuth->getIsActive())) { goto Fff2b; } goto f7d68; ed1f3: Defd3: goto Cbe65; bbc46: E125f: goto Ce2e0; db541: $this->elements[] = $basicAuthContent; goto baeda; B3cf9: $basicAuth = $this->site->getBasicAuth(); goto F7989; d1141: $basicAuthContent = ''; goto Fbf6b; a411a: $basicAuthFile = sprintf("\45\x73\57\45\163", rtrim(self::NGINX_BASIC_AUTH_DIRECTORY, "\57"), $this->site->getDomainName()); goto d1141; Bc0f1: foreach ($whitelistedIps as $ip) { $basicAuthContent .= sprintf("\40\x20\x61\x6c\154\157\167\40\45\x73\73", $ip) . PHP_EOL; E465c: } goto ed1f3; Ab9ae: $whitelistedIps = explode("\54", $whitelistedIps); goto A5571; Fbf6b: if (!(false === empty($whitelistedIps))) { goto E125f; } goto Ab9ae; baeda: Fff2b: goto A6776; Ad680: $basicAuthContent .= "\x20\40\x73\141\x74\x69\163\x66\171\x20\141\156\171\x3b" . PHP_EOL; goto Bc0f1; A5571: if (!count($whitelistedIps)) { goto e533f; } goto Ad680; f7d68: $whitelistedIps = $basicAuth->getWhitelistedIps(); goto a411a; B404f: $basicAuthContent .= sprintf("\40\x20\x61\x75\164\150\x5f\142\141\163\x69\x63\137\x75\163\x65\162\x5f\x66\151\154\x65\40\x25\x73\73", $basicAuthFile); goto db541; Cbe65: $basicAuthContent .= "\x20\40\144\145\156\x79\x20\141\154\x6c\73" . PHP_EOL; goto Ef78a; A6776: } private function addPageSpeed() : void { goto Dd99f; D4530: foreach ($pageSpeedSettingsExploded as $setting) { goto ced65; D1f5a: $pageSpeedSettingsContent .= sprintf("\40\x20\45\x73", $setting) . PHP_EOL; goto d53a0; ced65: $setting = trim($setting); goto C25bb; d1497: C6ad9: goto cd034; d53a0: bccdb: goto d1497; C25bb: if (!(false === empty($setting))) { goto bccdb; } goto D1f5a; cd034: } goto e0ee7; C5507: $pageSpeedSettingsContent = sprintf("\x20\x20\x70\x61\147\x65\163\160\145\x65\x64\40\45\163\73", true === $pageSpeedEnabled ? "\x6f\156" : "\157\x66\x66") . PHP_EOL; goto C1506; cdf0d: c93d1: goto bc59d; A7959: $this->elements[] = $pageSpeedSettingsContent; goto cdf0d; Dd99f: $pageSpeedEnabled = $this->site->getPageSpeedEnabled(); goto f6de7; C2cf8: C9279: goto A7959; f6de7: $pageSpeedSettings = $this->site->getPageSpeedSettings(); goto fdb7e; e8978: if (!(false === empty($pageSpeedSettingsExploded) && true === is_array($pageSpeedSettingsExploded))) { goto C9279; } goto D4530; c4cb5: $pageSpeedSettingsExploded = explode(PHP_EOL, $pageSpeedSettings); goto e8978; B7443: if (!(true === $pageSpeedEnabled && false === empty($pageSpeedSettings))) { goto c93d1; } goto C5507; e0ee7: aed14: goto C2cf8; C1506: $pageSpeedSettingsContent .= sprintf("\x20\40\160\141\147\145\163\x70\x65\145\x64\40\106\151\154\x65\103\x61\x63\x68\x65\120\x61\x74\x68\x20\x22\57\x68\x6f\x6d\x65\x2f\45\x73\57\x74\x6d\x70\57\x70\x61\x67\145\x73\160\145\145\x64\x5f\x63\x61\143\x68\x65\57\x22\73", $siteUser) . PHP_EOL; goto c4cb5; fdb7e: $siteUser = $this->site->getUser(); goto B7443; bc59d: } private function addCloudflareTrafficRestriction() : void { goto C0260; C8ab5: if (!(true === $allowTrafficFromCloudflareOnly)) { goto Ed8dc; } goto d5a9a; C0260: $allowTrafficFromCloudflareOnly = $this->site->allowTrafficFromCloudflareOnly(); goto C8ab5; d5a9a: $this->elements[] = "\x20\x20\x69\x6e\x63\154\165\x64\145\40\57\x65\164\143\x2f\156\147\151\x6e\170\57\x63\x6c\157\x75\x64\x66\x6c\141\x72\145\57\x69\160\x73\73"; goto b4fdd; b4fdd: Ed8dc: goto f935d; f935d: } private function addBlockedBots() : void { goto b6344; Ca42c: Fd272: goto C967d; b4e68: $blockedBotsContent = sprintf("\x20\40\151\x66\40\x28\x24\150\x74\164\160\x5f\165\163\x65\x72\x5f\x61\x67\x65\x6e\164\x20\x7e\52\40\50\45\x73\x29\x29\x20\173\xa\40\40\40\x20\x72\145\164\165\x72\156\x20\x34\x34\x34\73\xa\x20\40\x7d", implode("\174", $botsToBlock)); goto ae306; f28a1: $botsToBlock = array_unique($botsToBlock); goto b4e68; c0d27: if (!(false === is_null($blockedBots) && count($blockedBots))) { goto be38c; } goto Cf52a; b0f95: be38c: goto ff4b3; ca2c4: foreach ($blockedBots as $blockedBot) { $botsToBlock[] = strtolower($blockedBot->getName()); Dac3e: } goto Ca42c; b6344: $blockedBots = $this->site->getBlockedBots(); goto c0d27; C967d: if (!(false === empty($botsToBlock))) { goto Fe9bb; } goto f28a1; fe0d3: Fe9bb: goto b0f95; Cf52a: $botsToBlock = []; goto ca2c4; ae306: $this->elements[] = $blockedBotsContent; goto fe0d3; ff4b3: } private function addBlockedIps() : void { goto D7b17; d9d79: if (true === $allowTrafficFromCloudflareOnly) { goto D5e04; } goto c825b; cc24c: c1513: goto faa62; e7e1f: foreach ($blockedIps as $blockedIp) { $ipsToBlock[] = $blockedIp->getIp(); Fe19b: } goto cefaa; cefaa: a57a2: goto d11bc; B5c13: $ipsToBlock = []; goto e7e1f; c825b: $blockedIpsContent = sprintf("\40\40\x69\x66\40\x28\44\x72\145\155\x6f\x74\145\137\x61\x64\144\162\40\x7e\x20\42\136\50\45\163\51\44\42\51\x20\173", implode("\x7c", $ipsToBlock)) . PHP_EOL; goto c6651; b7fec: b3048: goto cc24c; B83a3: $this->elements[] = $blockedIpsContent; goto b7fec; b7d0f: $blockedIpsContent .= "\x20\40\x7d"; goto F1b2c; d1f86: $blockedIpsContent .= "\40\40\40\40\162\x65\164\165\162\156\x20\64\x30\x33\73" . PHP_EOL; goto Acbde; Df2d3: $ipsToBlock = array_unique($ipsToBlock); goto B7862; c6651: $blockedIpsContent .= "\40\40\40\x20\x72\145\x74\165\x72\156\40\64\60\63\x3b" . PHP_EOL; goto b7d0f; d11bc: if (!(false === empty($ipsToBlock))) { goto b3048; } goto Df2d3; D7b17: $blockedIps = $this->site->getBlockedIps(); goto Cf153; cad79: D5e04: goto a6835; B7862: $allowTrafficFromCloudflareOnly = $this->site->allowTrafficFromCloudflareOnly(); goto d9d79; F1b2c: goto F57ae; goto cad79; Eaa0b: F57ae: goto B83a3; a6835: $blockedIpsContent = sprintf("\40\x20\x69\146\40\50\44\150\164\x74\x70\x5f\143\146\x5f\x63\157\156\x6e\x65\143\164\151\156\x67\x5f\x69\160\40\x7e\40\x22\x5e\x28\45\163\51\x24\42\51\x20\173", implode("\174", $ipsToBlock)) . PHP_EOL; goto d1f86; Acbde: $blockedIpsContent .= "\40\x20\x7d"; goto Eaa0b; Cf153: if (!(false === is_null($blockedIps) && count($blockedIps))) { goto c1513; } goto B5c13; faa62: } }
