<?php
 namespace App\Site\Ssl; class CertificateParser { public function parse(Certificate $certificate) : ParsedCertificate { goto e40e7; b2f03: $subjectAlternativeNames = array_map(function ($item) { return explode("\72", trim($item), 2)[1]; }, array_filter(explode("\54", $rawData["\145\x78\x74\145\x6e\163\151\157\156\x73"]["\x73\165\x62\152\145\143\164\101\x6c\x74\116\141\155\145"]), function ($item) { return false !== strpos($item, "\72"); })); goto ec929; eca6b: $serialNumber = $rawData["\163\145\x72\151\141\x6c\116\165\155\142\145\162"] ?? null; goto Ef9fa; ec929: C7193: goto D6a51; Bfea7: throw new \Exception("\115\151\x73\x73\151\156\147\x20\145\170\160\x65\x63\x74\x65\x64\x20\153\145\171\40\x22\x73\x65\162\x69\141\x6c\116\x75\155\142\145\x72\x22\x20\x69\156\40\x63\x65\162\164\151\146\151\x63\141\x74\145"); goto D9484; Cd216: $validFromTo = new \DateTime("\100" . $rawData["\x76\141\154\151\x64\124\157\x5f\164\x69\155\145\137\164"]); goto eca6b; D9484: D7d51: goto d0f64; F5458: throw new \Exception("\115\x69\163\x73\x69\x6e\147\x20\x65\x78\x70\145\x63\164\145\144\x20\x6b\x65\171\40\x22\x73\165\142\x6a\x65\x63\164\x2e\143\x6e\42\x20\151\x6e\x20\x63\x65\x72\x74\x69\146\x69\x63\x61\164\145"); goto Afbde; D8d43: throw new \Exception("\x4d\151\163\x73\151\x6e\147\x20\x65\170\x70\x65\x63\x74\145\144\x20\153\x65\171\40\42\166\141\154\151\144\124\x6f\137\x74\151\x6d\x65\x5f\164\x22\x20\151\156\x20\143\145\162\164\151\146\151\x63\x61\164\145"); goto f7bfb; ad172: ea932: goto A5754; d0f64: if (!(false === isset($rawData["\x76\141\154\151\144\x46\162\x6f\155\137\164\x69\x6d\145\x5f\x74"]))) { goto D48bb; } goto d095a; bb085: if (!(false === is_array($rawData))) { goto ea932; } goto D326b; e469a: if (!(false === isset($rawData["\x73\x65\162\x69\141\x6c\x4e\165\155\x62\145\162"]))) { goto D7d51; } goto Bfea7; a582e: $issuer = $rawData["\x69\163\163\165\145\162"] ?? []; goto ed60e; d14b7: D48bb: goto f9c0c; D326b: throw new \Exception(sprintf("\x46\141\151\154\40\164\x6f\40\x70\x61\162\163\145\x20\143\145\x72\164\151\146\x69\143\141\164\x65\x20\167\151\x74\150\40\145\162\x72\157\x72\x3a\x20\x25\x73", openssl_error_string())); goto ad172; Ef9fa: $parsedCertificate = new ParsedCertificate($certificate, $subject, $issuer, $isSelfSigned, $validFromTime, $validFromTo, $serialNumber, $subjectAlternativeNames); goto dff7d; Afbde: ed954: goto e469a; b4ed1: $validFromTime = new \DateTime("\100" . $rawData["\166\x61\x6c\151\144\106\x72\157\x6d\x5f\164\151\x6d\145\x5f\x74"]); goto Cd216; f9c0c: if (!(false === isset($rawData["\x76\141\154\x69\x64\x54\x6f\x5f\x74\x69\155\x65\137\164"]))) { goto F98f3; } goto D8d43; ed60e: $isSelfSigned = $rawData["\x73\x75\x62\152\145\x63\x74"] === $rawData["\x69\163\x73\165\145\162"]; goto b4ed1; d095a: throw new \Exception("\115\x69\163\163\x69\156\x67\x20\145\x78\x70\145\x63\164\145\x64\x20\x6b\145\171\x20\42\x76\x61\154\x69\x64\106\x72\157\155\137\164\x69\155\145\x5f\x74\x22\40\151\x6e\40\x63\x65\x72\164\x69\146\151\143\141\x74\145"); goto d14b7; e40e7: $rawData = openssl_x509_parse($certificate->getCertificate()); goto bb085; cf5cf: if (!isset($rawData["\145\x78\164\145\x6e\163\151\157\156\163"]["\x73\x75\x62\152\x65\x63\x74\101\154\x74\116\x61\x6d\145"])) { goto C7193; } goto b2f03; D6a51: $subject = $rawData["\x73\x75\142\x6a\145\x63\164"] ?? []; goto a582e; A5754: if (!(false === isset($rawData["\163\165\142\152\145\143\x74"]["\x43\x4e"]))) { goto ed954; } goto F5458; dff7d: return $parsedCertificate; goto C6782; f7bfb: F98f3: goto C8f57; C8f57: $subjectAlternativeNames = []; goto cf5cf; C6782: } }
