<?php
 namespace App\Ufw; use App\Ufw\Firewall\AllowTcpRule; use App\Ufw\Command\AllowTcpRule as AllowTcpRuleCommand; use App\Ufw\Command\Enable as EnableCommand; use App\Ufw\Command\Disable as DisableCommand; use App\Ufw\Command\Reset as ResetCommand; use App\System\CommandExecutor; class Firewall { private CommandExecutor $commandExecutor; public function __construct() { $this->commandExecutor = new CommandExecutor(); } public function allow($ip, $portRange, $dryRun = false) : void { goto F2f41; Aa7f4: $allowTcpRuleCommand = new AllowTcpRuleCommand($allowTcpRule); goto d36db; bcac4: $allowTcpRule->setPortRange($portRange); goto Aa7f4; F2f41: $allowTcpRule = new AllowTcpRule(); goto Da86c; Da86c: $allowTcpRule->setIp($ip); goto bcac4; d36db: $allowTcpRuleCommand->setDryRun($dryRun); goto C38a2; C38a2: $this->commandExecutor->execute($allowTcpRuleCommand); goto d8234; d8234: } public function enable() : void { $enableCommand = new EnableCommand(); $this->commandExecutor->execute($enableCommand); } public function disable() : void { $disableCommand = new DisableCommand(); $this->commandExecutor->execute($disableCommand); } public function reset() : void { $resetCommand = new ResetCommand(); $this->commandExecutor->execute($resetCommand); } }
