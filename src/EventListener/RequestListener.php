<?php
 namespace App\EventListener; use Symfony\Component\HttpKernel\Event\RequestEvent; use Symfony\Component\EventDispatcher\EventSubscriberInterface; use Symfony\Component\HttpKernel\KernelEvents; use Symfony\Component\HttpFoundation\RedirectResponse; use Symfony\Bundle\FrameworkBundle\Routing\Router; use App\Entity\Manager\UserManager; class RequestListener implements EventSubscriberInterface { const ROUTE_ADMIN_USER_CREATION = "\x63\154\x70\137\141\x64\x6d\151\x6e\137\165\x73\145\162\137\x63\x72\145\141\x74\x69\157\156"; private Router $router; private UserManager $userManager; private array $whitelistedRoutes = ["\x63\x6c\160\x5f\x68\157\x6d\145", "\x63\x6c\x70\137\x6c\x6f\x67\x69\156\137\155\x66\x61", "\x63\x6c\160\137\154\x6f\147\151\156\137\x6d\x66\x61", "\137\x77\x64\x74"]; public function __construct(Router $router, UserManager $userManager) { $this->router = $router; $this->userManager = $userManager; } public function onKernelRequest(RequestEvent $event) : void { goto A79ad; b6d21: $route = $requestAttributes->get("\137\162\157\165\x74\145"); goto d5e5e; e8bda: d769e: goto D7d11; a922b: return; goto e8bda; D7d11: $request = $event->getRequest(); goto e64ab; B6d5d: $redirect = new RedirectResponse($redirectUrl); goto F394d; d5e5e: $numberOfUsers = $this->userManager->countAll(); goto e64e8; F49ac: e026e: goto fbe7d; A1185: if (!(false === in_array($route, $this->whitelistedRoutes) && false === is_null($mfaAuthenticated) && false === $mfaAuthenticated)) { goto e026e; } goto D5374; F508a: $redirect = new RedirectResponse($redirectUrl); goto b6ab5; C42b4: $redirectUrl = $this->router->generate(self::ROUTE_ADMIN_USER_CREATION); goto B6d5d; A79ad: if (!(false === $event->isMainRequest())) { goto d769e; } goto a922b; A2a16: $requestAttributes = $request->attributes; goto b6d21; b6ab5: $event->setResponse($redirect); goto F49ac; F4805: Bcff3: goto eb41d; fbe7d: goto Bcff3; goto be189; e64ab: $session = $request->getSession(); goto A2a16; Aa6d9: $mfaAuthenticated = $session->get("\155\x66\x61\101\x75\x74\150\x65\156\164\151\x63\x61\164\x65\x64"); goto A1185; D5374: $redirectUrl = $this->router->generate("\143\154\x70\x5f\x6c\157\x67\151\x6e\x5f\x6d\x66\141"); goto F508a; F394d: $event->setResponse($redirect); goto F4805; e64e8: if (0 == $numberOfUsers && self::ROUTE_ADMIN_USER_CREATION != $route && "\x63\154\x70\x5f\x61\160\x69" != substr($route, 0, 7)) { goto f9a5c; } goto Aa6d9; be189: f9a5c: goto C42b4; eb41d: } public static function getSubscribedEvents() : array { return [KernelEvents::REQUEST => [["\x6f\x6e\113\145\162\156\145\154\x52\x65\161\165\145\x73\x74", 4]]]; } }
